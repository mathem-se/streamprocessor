Field{name=GiftVouchers, description=, type=ROW<key STRING, value ROW<Id STRING, Code STRING, Text STRING, Comments STRING, Value DOUBLE, ValidFrom DATETIME, ValidUntil DATETIME, AlreadyUsed BOOLEAN>> NOT NULL, options={{}}}
Field{name=Credit, description=, type=ARRAY<ROW<key STRING, value DOUBLE> NOT NULL>, options={{}}}
Field{name=OriginalProducts, description=, type=ROW<key STRING, value ROW<Id STRING, Quantity DOUBLE, Name STRING, Price DOUBLE, IsWine BOOLEAN, ProductDiscountPrice DOUBLE>> NOT NULL, options={{}}}
Field{name=OriginalDeliveryDate, description=, type=DATETIME, options={{}}}
Field{name=LockPhoneNumber, description=, type=STRING, options={{}}}
Field{name=SubscriptionId, description=, type=STRING, options={{}}}
Field{name=UnavailableSubscriptionProducts, description=, type=ROW<key STRING, value ROW<ProductId STRING, Name STRING, Quantity INT64, ReasonCode STRING>> NOT NULL, options={{}}}
Field{name=MemberGroupFees, description=, type=ROW<PickingCost STRING, DeliveryFee ROW<UseDeliveryFee BOOLEAN, Under INT64, Between INT64, Over INT64, LimitUnder INT64, LimitOver INT64, DeliveryFeeLimits ARRAY<ROW<Cost DOUBLE, Limit DOUBLE> NOT NULL>>, InvoiceCost DOUBLE>, options={{}}}
Field{name=PartitionTimestamp, description=, type=DATETIME, options={{}}}
Field{name=NumberOfConfirmedOrderLines, description=, type=INT64, options={{}}}
Field{name=DeliveryTimeStatus, description=, type=ROW<Status STRING, Modified DATETIME, ExpiresAt DATETIME>, options={{}}}
Field{name=_ATTRIBUTES, description=, type=ARRAY<ROW<key STRING, value STRING> NOT NULL>, options={{}}}
Field{name=Benefits, description=, type=ARRAY<ROW<MemberId STRING, BenefitType STRING, Benefits ARRAY<ROW<FromOrderId STRING, NewOrderAmountRequired DOUBLE, OrderDeliveryDate STRING, Status ROW<Applicable BOOLEAN, Reason STRING>, ValidFrom STRING, ValidUntil STRING, Applied BOOLEAN, UsedOnOrder STRING> NOT NULL>> NOT NULL>, options={{}}}
Field{name=ProductRestrictions, description=, type=ARRAY<ROW<ProductId STRING, Description STRING, MaxQuantity INT64, Quantity INT64, Modified STRING, RestrictionId STRING, MaxTotalQuantity INT64, CurrentTotalQuantity INT64> NOT NULL>, options={{}}}
Field{name=_metadata, description=, type=ROW<uuid STRING, operation STRING, topic STRING, timestamp DATETIME, entity STRING, dynamodbPublished DATETIME, salesforcePublished DATETIME, dynamodbEventId STRING, event_id STRING, processing_timestamp DATETIME>, options={{}}}
Field{name=event_timestamp, description=, type=DATETIME, options={{}}}
Encoding positions:
{Products=8, Modified=6, _ATTRIBUTES=34, Address=17, OriginalDeliveryDate=26, Discounts=20, ProductRestrictions=36, LockPhoneNumber=27, Benefits=35, event_timestamp=38, Created=5, MemberId=3, SocialSecurityNo=12, NumberOfConfirmedOrderLines=32, Credit=24, SubscriptionId=28, DeliveryTimeStatus=33, StoreId=2, ChangingOrderId=10, TotalPaidAmount=13, UnavailableSubscriptionProducts=29, PartitionTimestamp=31, _metadata=37, CartStatus=14, Bonuses=22, OriginalCartId=9, RecurringOrder=18, Fees=21, GiftVouchers=23, DeliveryTime=16, Payment=15, MemberGroupFees=30, Revision=1, MemberType=4, OriginalProducts=25, Recipes=19, OrderMessage=11, Id=0, Expires=7}
Options:{{entity=Option{type=STRING NOT NULL, value=ecom_cart_service_carteventtopic}}}UUID: null
[direct-runner-worker] ERROR org.streamprocessor.core.transforms.SerializeMessageToRowFn - ecom_cart_service_carteventtopic: org.apache.beam.sdk.util.RowJson$UnsupportedRowJsonException: Expected JSON array for field 'Credit'. Instead got OBJECT
[direct-runner-worker] INFO org.streamprocessor.core.transforms.SerializeMessageToRowFn - [processElement] Before row dese
[direct-runner-worker] INFO org.streamprocessor.core.transforms.SerializeMessageToRowFn - [processElement] payload: {"Products":{},"Modified":null,"Address":null,"OriginalDeliveryDate":null,"Discounts":{},"ProductRestrictions":[],"Benefits":null,"event_timestamp":"2023-02-14T18:53:51.9867689Z","Created":null,"MemberId":null,"SocialSecurityNo":null,"NumberOfConfirmedOrderLines":0,"DeliveryTimeStatus":null,"Credit":{},"SubscriptionId":null,"StoreId":null,"ChangingOrderId":0,"TotalPaidAmount":0,"UnavailableSubscriptionProducts":{},"_metadata":{"processing_timestamp":"2023-02-15T13:29:06.710Z","dynamodbEventId":"6075449d-3d7b-4d54-8898-32f51a173068","topic":"ecom-cart-service-CartEventTopic","uuid":"b02d1a12-7387-55c7-b4d1-4677a887e6fb","operation":"MODIFY","entity":"ecom-cart-service-CartEventTopic","timestamp":"2023-02-14T18:53:52.336Z","dynamodbPublished":"2023-02-14T18:53:51.9867689Z"},"CartStatus":null,"Bonuses":{},"OriginalCartId":null,"RecurringOrder":null,"Fees":{},"GiftVouchers":{},"LeaveOutsideDoor":null,"DeliveryTime":null,"Payment":null,"MemberGroupFees":null,"Revision":0,"MemberType":null,"OriginalProducts":{},"Recipes":{},"OrderMessage":null,"Id":null,"Expires":null}
[direct-runner-worker] INFO org.streamprocessor.core.transforms.SerializeMessageToRowFn - [processElement] schema: Fields:
Field{name=Id, description=, type=STRING, options={{}}}
Field{name=Revision, description=, type=INT64, options={{}}}
Field{name=StoreId, description=, type=STRING, options={{}}}
Field{name=MemberId, description=, type=STRING, options={{}}}
Field{name=MemberType, description=, type=STRING, options={{}}}
Field{name=Created, description=, type=DATETIME, options={{}}}
Field{name=Modified, description=, type=DATETIME, options={{}}}
Field{name=Expires, description=, type=DATETIME, options={{}}}
Field{name=Products, description=, type=ROW<key STRING, value ROW<Id STRING, Quantity DOUBLE, Name STRING, Added DATETIME, Category ROW<Id STRING, Name STRING>, Price DOUBLE, VatRate DOUBLE, Url STRING, ImageUrl STRING, EanCode STRING, ExternalSupplierCode STRING, ExternalProductCode STRING, Department ROW<Id STRING, Name STRING>, Brand ROW<Id STRING, Name STRING>, RecycleFee DOUBLE, Attributes ARRAY<STRING NOT NULL>, Discount ROW<Id STRING, DiscountPrice ROW<Value DOUBLE, DiscountPriceType INT64>, Limits ARRAY<ROW<Group STRING, Property STRING, Operator STRING, Value STRING> NOT NULL>, Conditions ARRAY<ROW<Group STRING, Property STRING, Operator STRING, Value STRING> NOT NULL>, ValidFrom DATETIME, ValidUntil DATETIME, CanUseProductOfferDiscount BOOLEAN>, Delivery ROW<IsPickingCostIncluded BOOLEAN, IsDeliveryCostIncluded BOOLEAN, IsSubscriptionProduct BOOLEAN, CancelDaysBefore INT64, MinimumRequiredDeliveryDays INT64, AdvanceDeliveryMinimumOrder INT64, IsAdultProduct BOOLEAN, IsWine BOOLEAN, DeliverableWeekdays ARRAY<STRING NOT NULL>, DeliveryRestrictions ARRAY<STRING NOT NULL>>, Availability STRING, CategoryAncestry ARRAY<ROW<Id STRING, Name STRING> NOT NULL>, Subtitle STRING, ExternalUrl STRING, SoldBy STRING, ShowSoldBy BOOLEAN, PharmacyInformation ROW<ArticleNumber STRING, ActiveSubstance STRING, ItemType STRING, SalesLimit INT64, SalesRestrictionType STRING, VendingType STRING>, HasPharmacyDiff BOOLEAN, Disclaimer STRING, Supplier ROW<Id STRING, Name STRING>>> NOT NULL, options={{}}}
Field{name=OriginalCartId, description=, type=STRING, options={{}}}
Field{name=ChangingOrderId, description=, type=INT64, options={{}}}
Field{name=OrderMessage, description=, type=STRING, options={{}}}
Field{name=SocialSecurityNo, description=, type=STRING, options={{}}}
Field{name=TotalPaidAmount, description=, type=DOUBLE, options={{}}}
Field{name=CartStatus, description=, type=STRING, options={{}}}
Field{name=Payment, description=, type=ROW<PaymentType STRING, OrderReference STRING>, options={{}}}
Field{name=DeliveryTime, description=, type=ROW<Id STRING, TruckRouteId INT64, Added DATETIME, TimeId STRING, StartDate DATETIME, StopDate DATETIME, DeliveryCost DOUBLE, ExtraDeliveryCost DOUBLE, InHomeDelivery BOOLEAN, DeliveryTimeChangedByAdmin BOOLEAN, DeliveryRestrictions ARRAY<STRING NOT NULL>, ClosingDate DATETIME, ClosingTime LOGICAL_TYPE, StoreId STRING, DeliveryFeeLimits ARRAY<ROW<Cost DOUBLE, Limit DOUBLE> NOT NULL>>, options={{}}}
Field{name=Address, description=, type=ROW<Id STRING, LegacyAddressId STRING, AddressType STRING, MemberId STRING, CompanyName STRING, FirstName STRING, LastName STRING, PhoneMobile STRING, PhoneHome STRING, AlternativePhoneHome STRING, AlternativePhoneMobile STRING, AddressRow1 STRING, AddressRow2 STRING, DoorCode STRING, AddressInfo STRING, PostalCode STRING, City STRING, Latitude DOUBLE, Longitude DOUBLE, TruckRouteId INT64, InHomeAvailable BOOLEAN, CreationDate STRING, LastModifiedDate STRING, RemovedDate STRING>, options={{}}}
Field{name=RecurringOrder, description=, type=ROW<Status INT64, Interval INT64>, options={{}}}
Field{name=Recipes, description=, type=ROW<key STRING, value ROW<Id STRING, RecipeId STRING, ExternalRecipeId STRING, Name STRING, Added DATETIME, Url STRING, ImageUrl STRING, Portions INT64, RecipeProducts ARRAY<ROW<ProductId STRING, Quantity DOUBLE, Unit STRING> NOT NULL>>> NOT NULL, options={{}}}
Field{name=Discounts, description=, type=ROW<key STRING, value ROW<Id STRING, Code STRING, Text STRING, PercentageDeliveryFee DOUBLE, Percentage DOUBLE, Value DOUBLE, AmountLimit DOUBLE, ProductId STRING>> NOT NULL, options={{}}}
Field{name=Fees, description=, type=ROW<key STRING, value ROW<Id STRING, Amount DOUBLE, VatRate DOUBLE>> NOT NULL, options={{}}}
Field{name=Bonuses, description=, type=ROW<key STRING, value ROW<Id STRING, Code STRING, Amount DOUBLE>> NOT NULL, options={{}}}
Field{name=GiftVouchers, description=, type=ROW<key STRING, value ROW<Id STRING, Code STRING, Text STRING, Comments STRING, Value DOUBLE, ValidFrom DATETIME, ValidUntil DATETIME, AlreadyUsed BOOLEAN>> NOT NULL, options={{}}}
Field{name=Credit, description=, type=ARRAY<ROW<key STRING, value DOUBLE> NOT NULL>, options={{}}}
Field{name=OriginalProducts, description=, type=ROW<key STRING, value ROW<Id STRING, Quantity DOUBLE, Name STRING, Price DOUBLE, IsWine BOOLEAN, ProductDiscountPrice DOUBLE>> NOT NULL, options={{}}}
Field{name=OriginalDeliveryDate, description=, type=DATETIME, options={{}}}
Field{name=LockPhoneNumber, description=, type=STRING, options={{}}}
Field{name=SubscriptionId, description=, type=STRING, options={{}}}
Field{name=UnavailableSubscriptionProducts, description=, type=ROW<key STRING, value ROW<ProductId STRING, Name STRING, Quantity INT64, ReasonCode STRING>> NOT NULL, options={{}}}
Field{name=MemberGroupFees, description=, type=ROW<PickingCost STRING, DeliveryFee ROW<UseDeliveryFee BOOLEAN, Under INT64, Between INT64, Over INT64, LimitUnder INT64, LimitOver INT64, DeliveryFeeLimits ARRAY<ROW<Cost DOUBLE, Limit DOUBLE> NOT NULL>>, InvoiceCost DOUBLE>, options={{}}}
Field{name=PartitionTimestamp, description=, type=DATETIME, options={{}}}
Field{name=NumberOfConfirmedOrderLines, description=, type=INT64, options={{}}}
Field{name=DeliveryTimeStatus, description=, type=ROW<Status STRING, Modified DATETIME, ExpiresAt DATETIME>, options={{}}}
Field{name=_ATTRIBUTES, description=, type=ARRAY<ROW<key STRING, value STRING> NOT NULL>, options={{}}}
Field{name=Benefits, description=, type=ARRAY<ROW<MemberId STRING, BenefitType STRING, Benefits ARRAY<ROW<FromOrderId STRING, NewOrderAmountRequired DOUBLE, OrderDeliveryDate STRING, Status ROW<Applicable BOOLEAN, Reason STRING>, ValidFrom STRING, ValidUntil STRING, Applied BOOLEAN, UsedOnOrder STRING> NOT NULL>> NOT NULL>, options={{}}}
Field{name=ProductRestrictions, description=, type=ARRAY<ROW<ProductId STRING, Description STRING, MaxQuantity INT64, Quantity INT64, Modified STRING, RestrictionId STRING, MaxTotalQuantity INT64, CurrentTotalQuantity INT64> NOT NULL>, options={{}}}
Field{name=_metadata, description=, type=ROW<uuid STRING, operation STRING, topic STRING, timestamp DATETIME, entity STRING, dynamodbPublished DATETIME, salesforcePublished DATETIME, dynamodbEventId STRING, event_id STRING, processing_timestamp DATETIME>, options={{}}}
Field{name=event_timestamp, description=, type=DATETIME, options={{}}}
Encoding positions:
{Products=8, Modified=6, _ATTRIBUTES=34, Address=17, OriginalDeliveryDate=26, Discounts=20, ProductRestrictions=36, LockPhoneNumber=27, Benefits=35, event_timestamp=38, Created=5, MemberId=3, SocialSecurityNo=12, NumberOfConfirmedOrderLines=32, Credit=24, SubscriptionId=28, DeliveryTimeStatus=33, StoreId=2, ChangingOrderId=10, TotalPaidAmount=13, UnavailableSubscriptionProducts=29, PartitionTimestamp=31, _metadata=37, CartStatus=14, Bonuses=22, OriginalCartId=9, RecurringOrder=18, Fees=21, GiftVouchers=23, DeliveryTime=16, Payment=15, MemberGroupFees=30, Revision=1, MemberType=4, OriginalProducts=25, Recipes=19, OrderMessage=11, Id=0, Expires=7}
Options:{{entity=Option{type=STRING NOT NULL, value=ecom_cart_service_carteventtopic}}}UUID: null
[direct-runner-worker] ERROR org.streamprocessor.core.transforms.SerializeMessageToRowFn - ecom_cart_service_carteventtopic: org.apache.beam.sdk.util.RowJson$UnsupportedRowJsonException: Expected JSON array for field 'Credit'. Instead got OBJECT
[direct-runner-worker] INFO org.streamprocessor.core.transforms.SerializeMessageToRowFn - [processElement] Before row dese
[direct-runner-worker] INFO org.streamprocessor.core.transforms.SerializeMessageToRowFn - [processElement] payload: {"Products":{"Init":{"Category":null,"Discount":null,"Attributes":null,"Url":null,"Name":null,"Department":null,"HasPharmacyDiff":false,"SoldBy":null,"Supplier":null,"StockInformation":null,"Availability":null,"ExternalSupplierCode":null,"Added":null,"Quantity":0,"ImageUrl":null,"ExternalUrl":null,"Disclaimer":null,"VatRate":0,"RecycleFee":0,"Brand":null,"Subtitle":null,"Price":0,"CategoryAncestry":null,"PharmacyInformation":null,"ExternalProductCode":null,"Id":"0","Delivery":null,"EanCode":null,"ShowSoldBy":false}},"Modified":null,"Address":null,"OriginalDeliveryDate":null,"Discounts":{"Init":{"Percentage":0,"PercentageDeliveryFee":0,"Value":0,"Text":null,"ProductId":null,"Id":"0","Code":null,"AmountLimit":0}},"ProductRestrictions":[],"Benefits":null,"event_timestamp":"2023-02-14T18:54:41.612887Z","Created":"2023-02-14T18:54:41.3176212Z","MemberId":null,"SocialSecurityNo":null,"NumberOfConfirmedOrderLines":0,"DeliveryTimeStatus":{"Status":"None","Modified":"2023-02-14T18:54:41.3176527Z","ExpiresAt":null},"Credit":{"CONFIRMED_ORDER_CREDIT":0,"USED_CREDIT":0,"AVAILABLE_CREDIT":0},"SubscriptionId":null,"StoreId":"23","ChangingOrderId":0,"TotalPaidAmount":0,"UnavailableSubscriptionProducts":{"Init":{"Quantity":0,"ProductId":null,"ReasonCode":null,"Name":null}},"_metadata":{"processing_timestamp":"2023-02-15T13:29:06.711Z","dynamodbEventId":"2fd6b55a-da31-4a54-8538-f414fe0ca533","topic":"ecom-cart-service-CartEventTopic","uuid":"2fc68087-d3ac-5f09-b6fe-dce2089d4d5c","operation":"MODIFY","entity":"ecom-cart-service-CartEventTopic","timestamp":"2023-02-14T18:54:41.638Z","dynamodbPublished":"2023-02-14T18:54:41.612887Z"},"CartStatus":"OPEN","Bonuses":{"Init":{"Amount":0,"Id":"0","Code":null}},"OriginalCartId":null,"RecurringOrder":null,"Fees":{"Init":{"Amount":0,"Id":"0","VatRate":0}},"GiftVouchers":{"Init":{"Comments":null,"Value":0,"ValidFrom":"0001-01-01T00:00:00","Text":null,"AlreadyUsed":false,"Id":"0","Code":null,"ValidUntil":"0001-01-01T00:00:00"}},"LeaveOutsideDoor":null,"DeliveryTime":null,"Payment":null,"MemberGroupFees":null,"Revision":1,"MemberType":null,"OriginalProducts":{"Init":{"Price":0,"ProductDiscountPrice":null,"Quantity":0,"Id":"0","IsWine":false,"Name":null}},"Recipes":{"Init":{"RecipeProducts":[],"Added":null,"Portions":0,"ExternalRecipeId":null,"RecipeId":null,"ImageUrl":null,"Id":"0","Url":null,"Name":null}},"OrderMessage":null,"Id":"7067688e-e7ad-430f-a0a8-27d4bb75d469","Expires":"2023-02-21T18:54:41Z"}
[direct-runner-worker] INFO org.streamprocessor.core.transforms.SerializeMessageToRowFn - [processElement] schema: Fields:
Field{name=Id, description=, type=STRING, options={{}}}
Field{name=Revision, description=, type=INT64, options={{}}}
Field{name=StoreId, description=, type=STRING, options={{}}}
Field{name=MemberId, description=, type=STRING, options={{}}}
Field{name=MemberType, description=, type=STRING, options={{}}}
Field{name=Created, description=, type=DATETIME, options={{}}}
Field{name=Modified, description=, type=DATETIME, options={{}}}
Field{name=Expires, description=, type=DATETIME, options={{}}}
Field{name=Products, description=, type=ROW<key STRING, value ROW<Id STRING, Quantity DOUBLE, Name STRING, Added DATETIME, Category ROW<Id STRING, Name STRING>, Price DOUBLE, VatRate DOUBLE, Url STRING, ImageUrl STRING, EanCode STRING, ExternalSupplierCode STRING, ExternalProductCode STRING, Department ROW<Id STRING, Name STRING>, Brand ROW<Id STRING, Name STRING>, RecycleFee DOUBLE, Attributes ARRAY<STRING NOT NULL>, Discount ROW<Id STRING, DiscountPrice ROW<Value DOUBLE, DiscountPriceType INT64>, Limits ARRAY<ROW<Group STRING, Property STRING, Operator STRING, Value STRING> NOT NULL>, Conditions ARRAY<ROW<Group STRING, Property STRING, Operator STRING, Value STRING> NOT NULL>, ValidFrom DATETIME, ValidUntil DATETIME, CanUseProductOfferDiscount BOOLEAN>, Delivery ROW<IsPickingCostIncluded BOOLEAN, IsDeliveryCostIncluded BOOLEAN, IsSubscriptionProduct BOOLEAN, CancelDaysBefore INT64, MinimumRequiredDeliveryDays INT64, AdvanceDeliveryMinimumOrder INT64, IsAdultProduct BOOLEAN, IsWine BOOLEAN, DeliverableWeekdays ARRAY<STRING NOT NULL>, DeliveryRestrictions ARRAY<STRING NOT NULL>>, Availability STRING, CategoryAncestry ARRAY<ROW<Id STRING, Name STRING> NOT NULL>, Subtitle STRING, ExternalUrl STRING, SoldBy STRING, ShowSoldBy BOOLEAN, PharmacyInformation ROW<ArticleNumber STRING, ActiveSubstance STRING, ItemType STRING, SalesLimit INT64, SalesRestrictionType STRING, VendingType STRING>, HasPharmacyDiff BOOLEAN, Disclaimer STRING, Supplier ROW<Id STRING, Name STRING>>> NOT NULL, options={{}}}
Field{name=OriginalCartId, description=, type=STRING, options={{}}}
Field{name=ChangingOrderId, description=, type=INT64, options={{}}}
Field{name=OrderMessage, description=, type=STRING, options={{}}}
Field{name=SocialSecurityNo, description=, type=STRING, options={{}}}
Field{name=TotalPaidAmount, description=, type=DOUBLE, options={{}}}
Field{name=CartStatus, description=, type=STRING, options={{}}}
Field{name=Payment, description=, type=ROW<PaymentType STRING, OrderReference STRING>, options={{}}}
Field{name=DeliveryTime, description=, type=ROW<Id STRING, TruckRouteId INT64, Added DATETIME, TimeId STRING, StartDate DATETIME, StopDate DATETIME, DeliveryCost DOUBLE, ExtraDeliveryCost DOUBLE, InHomeDelivery BOOLEAN, DeliveryTimeChangedByAdmin BOOLEAN, DeliveryRestrictions ARRAY<STRING NOT NULL>, ClosingDate DATETIME, ClosingTime LOGICAL_TYPE, StoreId STRING, DeliveryFeeLimits ARRAY<ROW<Cost DOUBLE, Limit DOUBLE> NOT NULL>>, options={{}}}
Field{name=Address, description=, type=ROW<Id STRING, LegacyAddressId STRING, AddressType STRING, MemberId STRING, CompanyName STRING, FirstName STRING, LastName STRING, PhoneMobile STRING, PhoneHome STRING, AlternativePhoneHome STRING, AlternativePhoneMobile STRING, AddressRow1 STRING, AddressRow2 STRING, DoorCode STRING, AddressInfo STRING, PostalCode STRING, City STRING, Latitude DOUBLE, Longitude DOUBLE, TruckRouteId INT64, InHomeAvailable BOOLEAN, CreationDate STRING, LastModifiedDate STRING, RemovedDate STRING>, options={{}}}
Field{name=RecurringOrder, description=, type=ROW<Status INT64, Interval INT64>, options={{}}}
Field{name=Recipes, description=, type=ROW<key STRING, value ROW<Id STRING, RecipeId STRING, ExternalRecipeId STRING, Name STRING, Added DATETIME, Url STRING, ImageUrl STRING, Portions INT64, RecipeProducts ARRAY<ROW<ProductId STRING, Quantity DOUBLE, Unit STRING> NOT NULL>>> NOT NULL, options={{}}}
Field{name=Discounts, description=, type=ROW<key STRING, value ROW<Id STRING, Code STRING, Text STRING, PercentageDeliveryFee DOUBLE, Percentage DOUBLE, Value DOUBLE, AmountLimit DOUBLE, ProductId STRING>> NOT NULL, options={{}}}
Field{name=Fees, description=, type=ROW<key STRING, value ROW<Id STRING, Amount DOUBLE, VatRate DOUBLE>> NOT NULL, options={{}}}
Field{name=Bonuses, description=, type=ROW<key STRING, value ROW<Id STRING, Code STRING, Amount DOUBLE>> NOT NULL, options={{}}}
Field{name=GiftVouchers, description=, type=ROW<key STRING, value ROW<Id STRING, Code STRING, Text STRING, Comments STRING, Value DOUBLE, ValidFrom DATETIME, ValidUntil DATETIME, AlreadyUsed BOOLEAN>> NOT NULL, options={{}}}
Field{name=Credit, description=, type=ARRAY<ROW<key STRING, value DOUBLE> NOT NULL>, options={{}}}
Field{name=OriginalProducts, description=, type=ROW<key STRING, value ROW<Id STRING, Quantity DOUBLE, Name STRING, Price DOUBLE, IsWine BOOLEAN, ProductDiscountPrice DOUBLE>> NOT NULL, options={{}}}
Field{name=OriginalDeliveryDate, description=, type=DATETIME, options={{}}}
Field{name=LockPhoneNumber, description=, type=STRING, options={{}}}
Field{name=SubscriptionId, description=, type=STRING, options={{}}}
Field{name=UnavailableSubscriptionProducts, description=, type=ROW<key STRING, value ROW<ProductId STRING, Name STRING, Quantity INT64, ReasonCode STRING>> NOT NULL, options={{}}}
Field{name=MemberGroupFees, description=, type=ROW<PickingCost STRING, DeliveryFee ROW<UseDeliveryFee BOOLEAN, Under INT64, Between INT64, Over INT64, LimitUnder INT64, LimitOver INT64, DeliveryFeeLimits ARRAY<ROW<Cost DOUBLE, Limit DOUBLE> NOT NULL>>, InvoiceCost DOUBLE>, options={{}}}
Field{name=PartitionTimestamp, description=, type=DATETIME, options={{}}}
Field{name=NumberOfConfirmedOrderLines, description=, type=INT64, options={{}}}
Field{name=DeliveryTimeStatus, description=, type=ROW<Status STRING, Modified DATETIME, ExpiresAt DATETIME>, options={{}}}
Field{name=_ATTRIBUTES, description=, type=ARRAY<ROW<key STRING, value STRING> NOT NULL>, options={{}}}
Field{name=Benefits, description=, type=ARRAY<ROW<MemberId STRING, BenefitType STRING, Benefits ARRAY<ROW<FromOrderId STRING, NewOrderAmountRequired DOUBLE, OrderDeliveryDate STRING, Status ROW<Applicable BOOLEAN, Reason STRING>, ValidFrom STRING, ValidUntil STRING, Applied BOOLEAN, UsedOnOrder STRING> NOT NULL>> NOT NULL>, options={{}}}
Field{name=ProductRestrictions, description=, type=ARRAY<ROW<ProductId STRING, Description STRING, MaxQuantity INT64, Quantity INT64, Modified STRING, RestrictionId STRING, MaxTotalQuantity INT64, CurrentTotalQuantity INT64> NOT NULL>, options={{}}}
Field{name=_metadata, description=, type=ROW<uuid STRING, operation STRING, topic STRING, timestamp DATETIME, entity STRING, dynamodbPublished DATETIME, salesforcePublished DATETIME, dynamodbEventId STRING, event_id STRING, processing_timestamp DATETIME>, options={{}}}
Field{name=event_timestamp, description=, type=DATETIME, options={{}}}
Encoding positions:
{Products=8, Modified=6, _ATTRIBUTES=34, Address=17, OriginalDeliveryDate=26, Discounts=20, ProductRestrictions=36, LockPhoneNumber=27, Benefits=35, event_timestamp=38, Created=5, MemberId=3, SocialSecurityNo=12, NumberOfConfirmedOrderLines=32, Credit=24, SubscriptionId=28, DeliveryTimeStatus=33, StoreId=2, ChangingOrderId=10, TotalPaidAmount=13, UnavailableSubscriptionProducts=29, PartitionTimestamp=31, _metadata=37, CartStatus=14, Bonuses=22, OriginalCartId=9, RecurringOrder=18, Fees=21, GiftVouchers=23, DeliveryTime=16, Payment=15, MemberGroupFees=30, Revision=1, MemberType=4, OriginalProducts=25, Recipes=19, OrderMessage=11, Id=0, Expires=7}
Options:{{entity=Option{type=STRING NOT NULL, value=ecom_cart_service_carteventtopic}}}UUID: null
[direct-runner-worker] ERROR org.streamprocessor.core.transforms.SerializeMessageToRowFn - ecom_cart_service_carteventtopic: org.apache.beam.sdk.util.RowJson$UnsupportedRowJsonException: Expected JSON array for field 'Credit'. Instead got OBJECT
[direct-runner-worker] INFO org.streamprocessor.core.transforms.SerializeMessageToRowFn - [processElement] Before row dese
[direct-runner-worker] INFO org.streamprocessor.core.transforms.SerializeMessageToRowFn - [processElement] payload: {"Products":{"Init":{"Category":null,"Discount":null,"Attributes":null,"Url":null,"Name":null,"Department":null,"HasPharmacyDiff":false,"SoldBy":null,"Supplier":null,"StockInformation":null,"Availability":null,"ExternalSupplierCode":null,"Added":null,"Quantity":0,"ImageUrl":null,"ExternalUrl":null,"Disclaimer":null,"VatRate":0,"RecycleFee":0,"Brand":null,"Subtitle":null,"Price":0,"CategoryAncestry":null,"PharmacyInformation":null,"ExternalProductCode":null,"Id":"0","Delivery":null,"EanCode":null,"ShowSoldBy":false},"127144":{"Category":{"Id":"kottfars---not","Name":"Köttfärs - Nöt"},"Discount":null,"Attributes":null,"Url":"/varor/kottfars---not/notfars-12--800g-scan","Name":"Nötfärs 12% 800g Scan","Department":{"Id":"kott-o-chark","Name":"Kött & Chark"},"HasPharmacyDiff":false,"SoldBy":"mathem","Supplier":{"Id":"10607","Name":"HK Scan Kött"},"StockInformation":{"Active":true,"OutOfStock":false,"AvailableQuantity":null},"Availability":"Available","ExternalSupplierCode":null,"Added":"2023-02-08T10:19:10.230154Z","Quantity":1,"ImageUrl":"notfars-12--800g-scan-4.jpg","ExternalUrl":null,"Disclaimer":null,"VatRate":12,"RecycleFee":0,"Brand":{"Id":"scan","Name":"Scan"},"Subtitle":null,"Price":97.95,"CategoryAncestry":[{"Id":"kottfars---not","Name":"Köttfärs - Nöt"},{"Id":"kottfars","Name":"Köttfärs"},{"Id":"kott","Name":"Kött"},{"Id":"kott-o-chark","Name":"Kött & Chark"}],"PharmacyInformation":null,"ExternalProductCode":"207692002","Id":"127144","Delivery":{"AdvanceDeliveryMinimumOrder":0,"DeliverableWeekdays":[],"IsPickingCostIncluded":false,"CancelDaysBefore":0,"IsAdultProduct":false,"MinimumRequiredDeliveryDays":0,"IsSubscriptionProduct":false,"IsWine":false,"DeliveryRestrictions":[],"IsDeliveryCostIncluded":false},"EanCode":"7300207692002","ShowSoldBy":false}},"Modified":"2023-02-15T13:26:23.8625956Z","Address":{"CreationDate":"2022-02-03T14:19:03","LastModifiedDate":"2022-12-20T14:00:18.290004+00:00","AlternativePhoneMobile":null,"LegacyAddressId":"9725338","FirstName":"Andreas","PostalCode":"11734","Latitude":0,"City":"Stockholm","Longitude":0,"InHomeAvailable":false,"DoorCode":null,"AddressInfo":null,"PhoneMobile":"+46 73 912 16 32","MemberId":"2392590","CompanyName":null,"TruckRouteId":0,"AlternativePhoneHome":null,"RemovedDate":null,"PhoneHome":null,"AddressRow1":"Hornsbruksgatan 12","Id":"d4e60122-4002-435b-b592-c15354473774","LastName":"Fagerberg","AddressType":"M","AddressRow2":null},"OriginalDeliveryDate":null,"Discounts":{"Init":{"Percentage":0,"PercentageDeliveryFee":0,"Value":0,"Text":null,"ProductId":null,"Id":"0","Code":null,"AmountLimit":0}},"ProductRestrictions":[],"Benefits":null,"event_timestamp":"2023-02-15T13:26:24.3451871Z","Created":"2023-02-08T10:16:04.2961976Z","MemberId":"2392590","SocialSecurityNo":null,"NumberOfConfirmedOrderLines":0,"DeliveryTimeStatus":{"Status":"Removed","Modified":"2023-02-15T13:26:23.8626166Z","ExpiresAt":null},"Credit":{"CONFIRMED_ORDER_CREDIT":0,"USED_CREDIT":0,"AVAILABLE_CREDIT":0},"SubscriptionId":null,"StoreId":"20","ChangingOrderId":0,"TotalPaidAmount":0,"UnavailableSubscriptionProducts":{"Init":{"Quantity":0,"ProductId":null,"ReasonCode":null,"Name":null}},"_metadata":{"processing_timestamp":"2023-02-15T13:29:11.375Z","dynamodbEventId":"233da554-41d6-4493-867e-61a306bb5a1a","topic":"ecom-cart-service-CartEventTopic","uuid":"27bee21f-9716-5d41-99d5-be7948d6ee73","operation":"MODIFY","entity":"ecom-cart-service-CartEventTopic","timestamp":"2023-02-15T13:26:24.370Z","dynamodbPublished":"2023-02-15T13:26:24.3451871Z"},"CartStatus":"OPEN","Bonuses":{"Init":{"Amount":0,"Id":"0","Code":null}},"OriginalCartId":null,"RecurringOrder":null,"Fees":{"Init":{"Amount":0,"Id":"0","VatRate":0}},"GiftVouchers":{"Init":{"Comments":null,"Value":0,"ValidFrom":"0001-01-01T00:00:00Z","Text":null,"AlreadyUsed":false,"Id":"0","Code":null,"ValidUntil":"0001-01-01T00:00:00Z"}},"LeaveOutsideDoor":"None","DeliveryTime":null,"Payment":null,"MemberGroupFees":null,"Revision":227,"MemberType":"P","OriginalProducts":{"Init":{"Price":0,"ProductDiscountPrice":null,"Quantity":0,"Id":"0","IsWine":false,"Name":null}},"Recipes":{"Init":{"RecipeProducts":[],"Added":null,"Portions":0,"ExternalRecipeId":null,"RecipeId":null,"ImageUrl":null,"Id":"0","Url":null,"Name":null}},"OrderMessage":null,"Id":"1ec9a807-93cb-4c80-a691-996081c33df9","Expires":"2023-02-22T13:26:24Z"}
[direct-runner-worker] INFO org.streamprocessor.core.transforms.SerializeMessageToRowFn - [processElement] schema: Fields:
Field{name=Id, description=, type=STRING, options={{}}}
Field{name=Revision, description=, type=INT64, options={{}}}
Field{name=StoreId, description=, type=STRING, options={{}}}
Field{name=MemberId, description=, type=STRING, options={{}}}
Field{name=MemberType, description=, type=STRING, options={{}}}
Field{name=Created, description=, type=DATETIME, options={{}}}
Field{name=Modified, description=, type=DATETIME, options={{}}}
Field{name=Expires, description=, type=DATETIME, options={{}}}
Field{name=Products, description=, type=ROW<key STRING, value ROW<Id STRING, Quantity DOUBLE, Name STRING, Added DATETIME, Category ROW<Id STRING, Name STRING>, Price DOUBLE, VatRate DOUBLE, Url STRING, ImageUrl STRING, EanCode STRING, ExternalSupplierCode STRING, ExternalProductCode STRING, Department ROW<Id STRING, Name STRING>, Brand ROW<Id STRING, Name STRING>, RecycleFee DOUBLE, Attributes ARRAY<STRING NOT NULL>, Discount ROW<Id STRING, DiscountPrice ROW<Value DOUBLE, DiscountPriceType INT64>, Limits ARRAY<ROW<Group STRING, Property STRING, Operator STRING, Value STRING> NOT NULL>, Conditions ARRAY<ROW<Group STRING, Property STRING, Operator STRING, Value STRING> NOT NULL>, ValidFrom DATETIME, ValidUntil DATETIME, CanUseProductOfferDiscount BOOLEAN>, Delivery ROW<IsPickingCostIncluded BOOLEAN, IsDeliveryCostIncluded BOOLEAN, IsSubscriptionProduct BOOLEAN, CancelDaysBefore INT64, MinimumRequiredDeliveryDays INT64, AdvanceDeliveryMinimumOrder INT64, IsAdultProduct BOOLEAN, IsWine BOOLEAN, DeliverableWeekdays ARRAY<STRING NOT NULL>, DeliveryRestrictions ARRAY<STRING NOT NULL>>, Availability STRING, CategoryAncestry ARRAY<ROW<Id STRING, Name STRING> NOT NULL>, Subtitle STRING, ExternalUrl STRING, SoldBy STRING, ShowSoldBy BOOLEAN, PharmacyInformation ROW<ArticleNumber STRING, ActiveSubstance STRING, ItemType STRING, SalesLimit INT64, SalesRestrictionType STRING, VendingType STRING>, HasPharmacyDiff BOOLEAN, Disclaimer STRING, Supplier ROW<Id STRING, Name STRING>>> NOT NULL, options={{}}}
Field{name=OriginalCartId, description=, type=STRING, options={{}}}
Field{name=ChangingOrderId, description=, type=INT64, options={{}}}
Field{name=OrderMessage, description=, type=STRING, options={{}}}
Field{name=SocialSecurityNo, description=, type=STRING, options={{}}}
Field{name=TotalPaidAmount, description=, type=DOUBLE, options={{}}}
Field{name=CartStatus, description=, type=STRING, options={{}}}
Field{name=Payment, description=, type=ROW<PaymentType STRING, OrderReference STRING>, options={{}}}
Field{name=DeliveryTime, description=, type=ROW<Id STRING, TruckRouteId INT64, Added DATETIME, TimeId STRING, StartDate DATETIME, StopDate DATETIME, DeliveryCost DOUBLE, ExtraDeliveryCost DOUBLE, InHomeDelivery BOOLEAN, DeliveryTimeChangedByAdmin BOOLEAN, DeliveryRestrictions ARRAY<STRING NOT NULL>, ClosingDate DATETIME, ClosingTime LOGICAL_TYPE, StoreId STRING, DeliveryFeeLimits ARRAY<ROW<Cost DOUBLE, Limit DOUBLE> NOT NULL>>, options={{}}}
Field{name=Address, description=, type=ROW<Id STRING, LegacyAddressId STRING, AddressType STRING, MemberId STRING, CompanyName STRING, FirstName STRING, LastName STRING, PhoneMobile STRING, PhoneHome STRING, AlternativePhoneHome STRING, AlternativePhoneMobile STRING, AddressRow1 STRING, AddressRow2 STRING, DoorCode STRING, AddressInfo STRING, PostalCode STRING, City STRING, Latitude DOUBLE, Longitude DOUBLE, TruckRouteId INT64, InHomeAvailable BOOLEAN, CreationDate STRING, LastModifiedDate STRING, RemovedDate STRING>, options={{}}}
Field{name=RecurringOrder, description=, type=ROW<Status INT64, Interval INT64>, options={{}}}
Field{name=Recipes, description=, type=ROW<key STRING, value ROW<Id STRING, RecipeId STRING, ExternalRecipeId STRING, Name STRING, Added DATETIME, Url STRING, ImageUrl STRING, Portions INT64, RecipeProducts ARRAY<ROW<ProductId STRING, Quantity DOUBLE, Unit STRING> NOT NULL>>> NOT NULL, options={{}}}
Field{name=Discounts, description=, type=ROW<key STRING, value ROW<Id STRING, Code STRING, Text STRING, PercentageDeliveryFee DOUBLE, Percentage DOUBLE, Value DOUBLE, AmountLimit DOUBLE, ProductId STRING>> NOT NULL, options={{}}}
Field{name=Fees, description=, type=ROW<key STRING, value ROW<Id STRING, Amount DOUBLE, VatRate DOUBLE>> NOT NULL, options={{}}}
Field{name=Bonuses, description=, type=ROW<key STRING, value ROW<Id STRING, Code STRING, Amount DOUBLE>> NOT NULL, options={{}}}
Field{name=GiftVouchers, description=, type=ROW<key STRING, value ROW<Id STRING, Code STRING, Text STRING, Comments STRING, Value DOUBLE, ValidFrom DATETIME, ValidUntil DATETIME, AlreadyUsed BOOLEAN>> NOT NULL, options={{}}}
Field{name=Credit, description=, type=ARRAY<ROW<key STRING, value DOUBLE> NOT NULL>, options={{}}}
Field{name=OriginalProducts, description=, type=ROW<key STRING, value ROW<Id STRING, Quantity DOUBLE, Name STRING, Price DOUBLE, IsWine BOOLEAN, ProductDiscountPrice DOUBLE>> NOT NULL, options={{}}}
Field{name=OriginalDeliveryDate, description=, type=DATETIME, options={{}}}
Field{name=LockPhoneNumber, description=, type=STRING, options={{}}}
Field{name=SubscriptionId, description=, type=STRING, options={{}}}
Field{name=UnavailableSubscriptionProducts, description=, type=ROW<key STRING, value ROW<ProductId STRING, Name STRING, Quantity INT64, ReasonCode STRING>> NOT NULL, options={{}}}
Field{name=MemberGroupFees, description=, type=ROW<PickingCost STRING, DeliveryFee ROW<UseDeliveryFee BOOLEAN, Under INT64, Between INT64, Over INT64, LimitUnder INT64, LimitOver INT64, DeliveryFeeLimits ARRAY<ROW<Cost DOUBLE, Limit DOUBLE> NOT NULL>>, InvoiceCost DOUBLE>, options={{}}}
Field{name=PartitionTimestamp, description=, type=DATETIME, options={{}}}
Field{name=NumberOfConfirmedOrderLines, description=, type=INT64, options={{}}}
Field{name=DeliveryTimeStatus, description=, type=ROW<Status STRING, Modified DATETIME, ExpiresAt DATETIME>, options={{}}}
Field{name=_ATTRIBUTES, description=, type=ARRAY<ROW<key STRING, value STRING> NOT NULL>, options={{}}}
Field{name=Benefits, description=, type=ARRAY<ROW<MemberId STRING, BenefitType STRING, Benefits ARRAY<ROW<FromOrderId STRING, NewOrderAmountRequired DOUBLE, OrderDeliveryDate STRING, Status ROW<Applicable BOOLEAN, Reason STRING>, ValidFrom STRING, ValidUntil STRING, Applied BOOLEAN, UsedOnOrder STRING> NOT NULL>> NOT NULL>, options={{}}}
Field{name=ProductRestrictions, description=, type=ARRAY<ROW<ProductId STRING, Description STRING, MaxQuantity INT64, Quantity INT64, Modified STRING, RestrictionId STRING, MaxTotalQuantity INT64, CurrentTotalQuantity INT64> NOT NULL>, options={{}}}
Field{name=_metadata, description=, type=ROW<uuid STRING, operation STRING, topic STRING, timestamp DATETIME, entity STRING, dynamodbPublished DATETIME, salesforcePublished DATETIME, dynamodbEventId STRING, event_id STRING, processing_timestamp DATETIME>, options={{}}}
Field{name=event_timestamp, description=, type=DATETIME, options={{}}}
Encoding positions:
{Products=8, Modified=6, _ATTRIBUTES=34, Address=17, OriginalDeliveryDate=26, Discounts=20, ProductRestrictions=36, LockPhoneNumber=27, Benefits=35, event_timestamp=38, Created=5, MemberId=3, SocialSecurityNo=12, NumberOfConfirmedOrderLines=32, Credit=24, SubscriptionId=28, DeliveryTimeStatus=33, StoreId=2, ChangingOrderId=10, TotalPaidAmount=13, UnavailableSubscriptionProducts=29, PartitionTimestamp=31, _metadata=37, CartStatus=14, Bonuses=22, OriginalCartId=9, RecurringOrder=18, Fees=21, GiftVouchers=23, DeliveryTime=16, Payment=15, MemberGroupFees=30, Revision=1, MemberType=4, OriginalProducts=25, Recipes=19, OrderMessage=11, Id=0, Expires=7}
Options:{{entity=Option{type=STRING NOT NULL, value=ecom_cart_service_carteventtopic}}}UUID: null
[direct-runner-worker] ERROR org.streamprocessor.core.transforms.SerializeMessageToRowFn - ecom_cart_service_carteventtopic: org.apache.beam.sdk.util.RowJson$UnsupportedRowJsonException: Expected JSON array for field 'Credit'. Instead got OBJECT
[direct-runner-worker] INFO org.streamprocessor.core.transforms.SerializeMessageToRowFn - [processElement] Before row dese
[direct-runner-worker] INFO org.streamprocessor.core.transforms.SerializeMessageToRowFn - [processElement] payload: {"Products":{"183117":{"Category":{"Id":"tandkram","Name":"Tandkräm"},"Discount":null,"Attributes":null,"Url":"/varor/nya-artiklar/gum-183117","Name":"GUM SensiVital+ tandkräm, Tandkräm, 75 ml","Department":{"Id":"apotek-o-halsa","Name":"Apotek, Hygien & Hälsa"},"HasPharmacyDiff":true,"SoldBy":"kronan","Supplier":{"Id":"17895","Name":"Sunstar Sverige AB"},"StockInformation":{"Active":false,"OutOfStock":false,"AvailableQuantity":null},"Availability":"Available","ExternalSupplierCode":"kronan","Added":"2023-02-15T12:23:48.4546941Z","Quantity":1,"ImageUrl":"7630019902984.jpg","ExternalUrl":null,"Disclaimer":null,"VatRate":25,"RecycleFee":0,"Brand":{"Id":"gum","Name":"GUM"},"Subtitle":null,"Price":39.95,"CategoryAncestry":[{"Id":"tandkram","Name":"Tandkräm"},{"Id":"mun-och-tander","Name":"Mun och tänder"},{"Id":"apotek-o-halsa","Name":"Apotek, Hygien & Hälsa"}],"PharmacyInformation":{"SalesLimit":0,"ArticleNumber":"777601","VendingType":"CrossDock","ItemType":"TG","SalesRestrictionType":"None","ActiveSubstance":null},"ExternalProductCode":"019902984","Id":"183117","Delivery":{"AdvanceDeliveryMinimumOrder":0,"DeliverableWeekdays":[],"IsPickingCostIncluded":false,"CancelDaysBefore":0,"IsAdultProduct":false,"MinimumRequiredDeliveryDays":0,"IsSubscriptionProduct":false,"IsWine":false,"DeliveryRestrictions":[],"IsDeliveryCostIncluded":false},"EanCode":"7630019902984","ShowSoldBy":true},"Init":{"Category":null,"Discount":null,"Attributes":null,"Url":null,"Name":null,"Department":null,"HasPharmacyDiff":false,"SoldBy":null,"Supplier":null,"StockInformation":null,"Availability":null,"ExternalSupplierCode":null,"Added":null,"Quantity":0,"ImageUrl":null,"ExternalUrl":null,"Disclaimer":null,"VatRate":0,"RecycleFee":0,"Brand":null,"Subtitle":null,"Price":0,"CategoryAncestry":null,"PharmacyInformation":null,"ExternalProductCode":null,"Id":"0","Delivery":null,"EanCode":null,"ShowSoldBy":false},"14307":{"Category":{"Id":"chokladkaka-ljus","Name":"Chokladkaka Ljus"},"Discount":null,"Attributes":null,"Url":"/varor/chokladkaka-ljus/chokladkaka-mjolkchoklad-200g-marabou","Name":"Chokladkaka Mjölkchoklad 200g Marabou","Department":{"Id":"glass-godis-o-snacks","Name":"Glass, godis & snacks"},"HasPharmacyDiff":false,"SoldBy":"mathem","Supplier":{"Id":"7539","Name":"Mondelez Sverige AB"},"StockInformation":{"Active":true,"OutOfStock":false,"AvailableQuantity":null},"Availability":"Available","ExternalSupplierCode":null,"Added":"2023-02-15T12:23:49.6671988Z","Quantity":1,"ImageUrl":"07310511210403_2.jpg","ExternalUrl":null,"Disclaimer":null,"VatRate":12,"RecycleFee":0,"Brand":{"Id":"marabou","Name":"Marabou"},"Subtitle":null,"Price":28.95,"CategoryAncestry":[{"Id":"chokladkaka-ljus","Name":"Chokladkaka Ljus"},{"Id":"chokladkakor","Name":"Chokladkakor"},{"Id":"choklad","Name":"Choklad"},{"Id":"glass-godis-o-snacks","Name":"Glass, godis & snacks"}],"PharmacyInformation":null,"ExternalProductCode":"511210403","Id":"14307","Delivery":{"AdvanceDeliveryMinimumOrder":40,"DeliverableWeekdays":[],"IsPickingCostIncluded":false,"CancelDaysBefore":0,"IsAdultProduct":false,"MinimumRequiredDeliveryDays":3,"IsSubscriptionProduct":false,"IsWine":false,"DeliveryRestrictions":[],"IsDeliveryCostIncluded":false},"EanCode":"7310511210403","ShowSoldBy":false}},"Modified":"2023-02-15T12:24:13.9287761Z","Address":{"CreationDate":"2023-02-02T16:39:05","LastModifiedDate":"2023-02-14T19:49:30","AlternativePhoneMobile":"0702180316","LegacyAddressId":"10911052","FirstName":"Marcus","PostalCode":"14264","Latitude":59.2318,"City":"Trångsund","Longitude":18.1542,"InHomeAvailable":false,"DoorCode":"12345","AddressInfo":"test...","PhoneMobile":"0702180314","MemberId":"1600094","CompanyName":null,"TruckRouteId":0,"AlternativePhoneHome":"0702180317","RemovedDate":null,"PhoneHome":"0702180315","AddressRow1":"Lingonbackarna 22","Id":"ecb6113c-5010-4af6-9d22-f47313a568af","LastName":"Casserfelt","AddressType":"M","AddressRow2":null},"OriginalDeliveryDate":null,"Discounts":{"Init":{"Percentage":0,"PercentageDeliveryFee":0,"Value":0,"Text":null,"ProductId":null,"Id":"0","Code":null,"AmountLimit":0}},"ProductRestrictions":[],"Benefits":[{"BenefitType":"AdminFee","MemberId":"1600094","Id":"4ad05562-9843-4f9f-a3c8-9c9d5cda26b2","Benefits":[{"FromOrderId":"62017681","Status":{"Applicable":true,"Reason":null},"UsedOnOrder":"62017686","Amount":0,"OrderDeliveryDate":"2023-02-13T00:00:00+01:00","NewOrderAmountRequired":350,"ValidFrom":"2023-02-13T00:00:00+01:00","Id":"AdminFee-1","Applied":false,"UsedOnCart":null,"ValidUntil":"2023-02-18T23:59:59+01:00"}]}],"event_timestamp":"2023-02-15T12:24:14.2033918Z","Created":"2023-02-15T12:23:37.4153774Z","MemberId":"1600094","SocialSecurityNo":"197306200119","NumberOfConfirmedOrderLines":0,"DeliveryTimeStatus":{"Status":"Pending","Modified":"2023-02-15T12:24:11.2865512Z","ExpiresAt":null},"Credit":{"CONFIRMED_ORDER_CREDIT":0,"USED_CREDIT":0,"AVAILABLE_CREDIT":0},"SubscriptionId":null,"StoreId":"10","ChangingOrderId":0,"TotalPaidAmount":0,"UnavailableSubscriptionProducts":{"Init":{"Quantity":0,"ProductId":null,"ReasonCode":null,"Name":null}},"_metadata":{"processing_timestamp":"2023-02-15T13:29:11.376Z","dynamodbEventId":"cda62f5d-d5e6-4688-b32f-077aa0ade9b2","topic":"ecom-cart-service-CartEventTopic","uuid":"d59a70ac-2240-5cf5-a6cd-2ccaf36e47c0","operation":"MODIFY","entity":"ecom-cart-service-CartEventTopic","timestamp":"2023-02-15T12:24:14.215Z","dynamodbPublished":"2023-02-15T12:24:14.2033918Z"},"CartStatus":"OPEN","Bonuses":{"Init":{"Amount":0,"Id":"0","Code":null}},"OriginalCartId":null,"RecurringOrder":null,"Fees":{"Init":{"Amount":0,"Id":"0","VatRate":0}},"GiftVouchers":{"Init":{"Comments":null,"Value":0,"ValidFrom":"0001-01-01T00:00:00Z","Text":null,"AlreadyUsed":false,"Id":"0","Code":null,"ValidUntil":"0001-01-01T00:00:00Z"}},"LeaveOutsideDoor":null,"DeliveryTime":{"DeliveryFeeLimits":[],"Added":"2023-02-15T12:24:11.2865088Z","ClosingTime":"23:59:00","DeliveryCost":0,"DeliveryTimeChangedByAdmin":false,"StartDate":"2023-02-17T09:00:00+01:00","TruckRouteId":431,"Type":"Regular","StoreId":null,"StoreRegion":"8","ExtraDeliveryCost":0,"StopDate":"2023-02-17T13:00:00+01:00","TimeId":"55119","ClosingDate":"2023-02-16T00:00:00+01:00","Id":"55119","DeliveryRestrictions":[]},"Payment":null,"MemberGroupFees":null,"Revision":18,"MemberType":"P","OriginalProducts":{"Init":{"Price":0,"ProductDiscountPrice":null,"Quantity":0,"Id":"0","IsWine":false,"Name":null}},"Recipes":{"Init":{"RecipeProducts":[],"Added":null,"Portions":0,"ExternalRecipeId":null,"RecipeId":null,"ImageUrl":null,"Id":"0","Url":null,"Name":null}},"OrderMessage":null,"Id":"f0eef94f-9976-4873-aea3-7ffca0e41bc5","Expires":"2023-02-22T12:24:13Z"}
[direct-runner-worker] INFO org.streamprocessor.core.transforms.SerializeMessageToRowFn - [processElement] schema: Fields:
Field{name=Id, description=, type=STRING, options={{}}}
Field{name=Revision, description=, type=INT64, options={{}}}
Field{name=StoreId, description=, type=STRING, options={{}}}
Field{name=MemberId, description=, type=STRING, options={{}}}
Field{name=MemberType, description=, type=STRING, options={{}}}
Field{name=Created, description=, type=DATETIME, options={{}}}
Field{name=Modified, description=, type=DATETIME, options={{}}}
Field{name=Expires, description=, type=DATETIME, options={{}}}
Field{name=Products, description=, type=ROW<key STRING, value ROW<Id STRING, Quantity DOUBLE, Name STRING, Added DATETIME, Category ROW<Id STRING, Name STRING>, Price DOUBLE, VatRate DOUBLE, Url STRING, ImageUrl STRING, EanCode STRING, ExternalSupplierCode STRING, ExternalProductCode STRING, Department ROW<Id STRING, Name STRING>, Brand ROW<Id STRING, Name STRING>, RecycleFee DOUBLE, Attributes ARRAY<STRING NOT NULL>, Discount ROW<Id STRING, DiscountPrice ROW<Value DOUBLE, DiscountPriceType INT64>, Limits ARRAY<ROW<Group STRING, Property STRING, Operator STRING, Value STRING> NOT NULL>, Conditions ARRAY<ROW<Group STRING, Property STRING, Operator STRING, Value STRING> NOT NULL>, ValidFrom DATETIME, ValidUntil DATETIME, CanUseProductOfferDiscount BOOLEAN>, Delivery ROW<IsPickingCostIncluded BOOLEAN, IsDeliveryCostIncluded BOOLEAN, IsSubscriptionProduct BOOLEAN, CancelDaysBefore INT64, MinimumRequiredDeliveryDays INT64, AdvanceDeliveryMinimumOrder INT64, IsAdultProduct BOOLEAN, IsWine BOOLEAN, DeliverableWeekdays ARRAY<STRING NOT NULL>, DeliveryRestrictions ARRAY<STRING NOT NULL>>, Availability STRING, CategoryAncestry ARRAY<ROW<Id STRING, Name STRING> NOT NULL>, Subtitle STRING, ExternalUrl STRING, SoldBy STRING, ShowSoldBy BOOLEAN, PharmacyInformation ROW<ArticleNumber STRING, ActiveSubstance STRING, ItemType STRING, SalesLimit INT64, SalesRestrictionType STRING, VendingType STRING>, HasPharmacyDiff BOOLEAN, Disclaimer STRING, Supplier ROW<Id STRING, Name STRING>>> NOT NULL, options={{}}}
Field{name=OriginalCartId, description=, type=STRING, options={{}}}
Field{name=ChangingOrderId, description=, type=INT64, options={{}}}
Field{name=OrderMessage, description=, type=STRING, options={{}}}
Field{name=SocialSecurityNo, description=, type=STRING, options={{}}}
Field{name=TotalPaidAmount, description=, type=DOUBLE, options={{}}}
Field{name=CartStatus, description=, type=STRING, options={{}}}
Field{name=Payment, description=, type=ROW<PaymentType STRING, OrderReference STRING>, options={{}}}
Field{name=DeliveryTime, description=, type=ROW<Id STRING, TruckRouteId INT64, Added DATETIME, TimeId STRING, StartDate DATETIME, StopDate DATETIME, DeliveryCost DOUBLE, ExtraDeliveryCost DOUBLE, InHomeDelivery BOOLEAN, DeliveryTimeChangedByAdmin BOOLEAN, DeliveryRestrictions ARRAY<STRING NOT NULL>, ClosingDate DATETIME, ClosingTime LOGICAL_TYPE, StoreId STRING, DeliveryFeeLimits ARRAY<ROW<Cost DOUBLE, Limit DOUBLE> NOT NULL>>, options={{}}}
Field{name=Address, description=, type=ROW<Id STRING, LegacyAddressId STRING, AddressType STRING, MemberId STRING, CompanyName STRING, FirstName STRING, LastName STRING, PhoneMobile STRING, PhoneHome STRING, AlternativePhoneHome STRING, AlternativePhoneMobile STRING, AddressRow1 STRING, AddressRow2 STRING, DoorCode STRING, AddressInfo STRING, PostalCode STRING, City STRING, Latitude DOUBLE, Longitude DOUBLE, TruckRouteId INT64, InHomeAvailable BOOLEAN, CreationDate STRING, LastModifiedDate STRING, RemovedDate STRING>, options={{}}}
Field{name=RecurringOrder, description=, type=ROW<Status INT64, Interval INT64>, options={{}}}
Field{name=Recipes, description=, type=ROW<key STRING, value ROW<Id STRING, RecipeId STRING, ExternalRecipeId STRING, Name STRING, Added DATETIME, Url STRING, ImageUrl STRING, Portions INT64, RecipeProducts ARRAY<ROW<ProductId STRING, Quantity DOUBLE, Unit STRING> NOT NULL>>> NOT NULL, options={{}}}
Field{name=Discounts, description=, type=ROW<key STRING, value ROW<Id STRING, Code STRING, Text STRING, PercentageDeliveryFee DOUBLE, Percentage DOUBLE, Value DOUBLE, AmountLimit DOUBLE, ProductId STRING>> NOT NULL, options={{}}}
Field{name=Fees, description=, type=ROW<key STRING, value ROW<Id STRING, Amount DOUBLE, VatRate DOUBLE>> NOT NULL, options={{}}}
Field{name=Bonuses, description=, type=ROW<key STRING, value ROW<Id STRING, Code STRING, Amount DOUBLE>> NOT NULL, options={{}}}
Field{name=GiftVouchers, description=, type=ROW<key STRING, value ROW<Id STRING, Code STRING, Text STRING, Comments STRING, Value DOUBLE, ValidFrom DATETIME, ValidUntil DATETIME, AlreadyUsed BOOLEAN>> NOT NULL, options={{}}}
Field{name=Credit, description=, type=ARRAY<ROW<key STRING, value DOUBLE> NOT NULL>, options={{}}}
Field{name=OriginalProducts, description=, type=ROW<key STRING, value ROW<Id STRING, Quantity DOUBLE, Name STRING, Price DOUBLE, IsWine BOOLEAN, ProductDiscountPrice DOUBLE>> NOT NULL, options={{}}}
Field{name=OriginalDeliveryDate, description=, type=DATETIME, options={{}}}
Field{name=LockPhoneNumber, description=, type=STRING, options={{}}}
Field{name=SubscriptionId, description=, type=STRING, options={{}}}
Field{name=UnavailableSubscriptionProducts, description=, type=ROW<key STRING, value ROW<ProductId STRING, Name STRING, Quantity INT64, ReasonCode STRING>> NOT NULL, options={{}}}
Field{name=MemberGroupFees, description=, type=ROW<PickingCost STRING, DeliveryFee ROW<UseDeliveryFee BOOLEAN, Under INT64, Between INT64, Over INT64, LimitUnder INT64, LimitOver INT64, DeliveryFeeLimits ARRAY<ROW<Cost DOUBLE, Limit DOUBLE> NOT NULL>>, InvoiceCost DOUBLE>, options={{}}}
Field{name=PartitionTimestamp, description=, type=DATETIME, options={{}}}
Field{name=NumberOfConfirmedOrderLines, description=, type=INT64, options={{}}}
Field{name=DeliveryTimeStatus, description=, type=ROW<Status STRING, Modified DATETIME, ExpiresAt DATETIME>, options={{}}}
Field{name=_ATTRIBUTES, description=, type=ARRAY<ROW<key STRING, value STRING> NOT NULL>, options={{}}}
Field{name=Benefits, description=, type=ARRAY<ROW<MemberId STRING, BenefitType STRING, Benefits ARRAY<ROW<FromOrderId STRING, NewOrderAmountRequired DOUBLE, OrderDeliveryDate STRING, Status ROW<Applicable BOOLEAN, Reason STRING>, ValidFrom STRING, ValidUntil STRING, Applied BOOLEAN, UsedOnOrder STRING> NOT NULL>> NOT NULL>, options={{}}}
Field{name=ProductRestrictions, description=, type=ARRAY<ROW<ProductId STRING, Description STRING, MaxQuantity INT64, Quantity INT64, Modified STRING, RestrictionId STRING, MaxTotalQuantity INT64, CurrentTotalQuantity INT64> NOT NULL>, options={{}}}
Field{name=_metadata, description=, type=ROW<uuid STRING, operation STRING, topic STRING, timestamp DATETIME, entity STRING, dynamodbPublished DATETIME, salesforcePublished DATETIME, dynamodbEventId STRING, event_id STRING, processing_timestamp DATETIME>, options={{}}}
Field{name=event_timestamp, description=, type=DATETIME, options={{}}}
Encoding positions:
{Products=8, Modified=6, _ATTRIBUTES=34, Address=17, OriginalDeliveryDate=26, Discounts=20, ProductRestrictions=36, LockPhoneNumber=27, Benefits=35, event_timestamp=38, Created=5, MemberId=3, SocialSecurityNo=12, NumberOfConfirmedOrderLines=32, Credit=24, SubscriptionId=28, DeliveryTimeStatus=33, StoreId=2, ChangingOrderId=10, TotalPaidAmount=13, UnavailableSubscriptionProducts=29, PartitionTimestamp=31, _metadata=37, CartStatus=14, Bonuses=22, OriginalCartId=9, RecurringOrder=18, Fees=21, GiftVouchers=23, DeliveryTime=16, Payment=15, MemberGroupFees=30, Revision=1, MemberType=4, OriginalProducts=25, Recipes=19, OrderMessage=11, Id=0, Expires=7}
Options:{{entity=Option{type=STRING NOT NULL, value=ecom_cart_service_carteventtopic}}}UUID: null
[direct-runner-worker] ERROR org.streamprocessor.core.transforms.SerializeMessageToRowFn - ecom_cart_service_carteventtopic: org.apache.beam.sdk.util.RowJson$UnsupportedRowJsonException: Expected JSON array for field 'Credit'. Instead got OBJECT
[direct-runner-worker] INFO org.streamprocessor.core.transforms.SerializeMessageToRowFn - [processElement] Before row dese
[direct-runner-worker] INFO org.streamprocessor.core.transforms.SerializeMessageToRowFn - [processElement] payload: {"Products":{},"Modified":null,"Address":null,"OriginalDeliveryDate":null,"Discounts":{},"ProductRestrictions":[],"Benefits":null,"event_timestamp":"2023-02-15T12:59:42.6718112Z","Created":null,"MemberId":null,"SocialSecurityNo":null,"NumberOfConfirmedOrderLines":0,"DeliveryTimeStatus":null,"Credit":{},"SubscriptionId":null,"StoreId":null,"ChangingOrderId":0,"TotalPaidAmount":0,"UnavailableSubscriptionProducts":{},"_metadata":{"processing_timestamp":"2023-02-15T13:29:11.376Z","dynamodbEventId":"6df93a40-40b8-4918-b611-290fbf152953","topic":"ecom-cart-service-CartEventTopic","uuid":"3a8ce9fa-e03e-5ac6-a854-b59c394063f0","operation":"MODIFY","entity":"ecom-cart-service-CartEventTopic","timestamp":"2023-02-15T12:59:42.689Z","dynamodbPublished":"2023-02-15T12:59:42.6718112Z"},"CartStatus":null,"Bonuses":{},"OriginalCartId":null,"RecurringOrder":null,"Fees":{},"GiftVouchers":{},"LeaveOutsideDoor":null,"DeliveryTime":null,"Payment":null,"MemberGroupFees":null,"Revision":0,"MemberType":null,"OriginalProducts":{},"Recipes":{},"OrderMessage":null,"Id":null,"Expires":null}
[direct-runner-worker] INFO org.streamprocessor.core.transforms.SerializeMessageToRowFn - [processElement] schema: Fields:
Field{name=Id, description=, type=STRING, options={{}}}
Field{name=Revision, description=, type=INT64, options={{}}}
Field{name=StoreId, description=, type=STRING, options={{}}}
Field{name=MemberId, description=, type=STRING, options={{}}}
Field{name=MemberType, description=, type=STRING, options={{}}}
Field{name=Created, description=, type=DATETIME, options={{}}}
Field{name=Modified, description=, type=DATETIME, options={{}}}
Field{name=Expires, description=, type=DATETIME, options={{}}}
Field{name=Products, description=, type=ROW<key STRING, value ROW<Id STRING, Quantity DOUBLE, Name STRING, Added DATETIME, Category ROW<Id STRING, Name STRING>, Price DOUBLE, VatRate DOUBLE, Url STRING, ImageUrl STRING, EanCode STRING, ExternalSupplierCode STRING, ExternalProductCode STRING, Department ROW<Id STRING, Name STRING>, Brand ROW<Id STRING, Name STRING>, RecycleFee DOUBLE, Attributes ARRAY<STRING NOT NULL>, Discount ROW<Id STRING, DiscountPrice ROW<Value DOUBLE, DiscountPriceType INT64>, Limits ARRAY<ROW<Group STRING, Property STRING, Operator STRING, Value STRING> NOT NULL>, Conditions ARRAY<ROW<Group STRING, Property STRING, Operator STRING, Value STRING> NOT NULL>, ValidFrom DATETIME, ValidUntil DATETIME, CanUseProductOfferDiscount BOOLEAN>, Delivery ROW<IsPickingCostIncluded BOOLEAN, IsDeliveryCostIncluded BOOLEAN, IsSubscriptionProduct BOOLEAN, CancelDaysBefore INT64, MinimumRequiredDeliveryDays INT64, AdvanceDeliveryMinimumOrder INT64, IsAdultProduct BOOLEAN, IsWine BOOLEAN, DeliverableWeekdays ARRAY<STRING NOT NULL>, DeliveryRestrictions ARRAY<STRING NOT NULL>>, Availability STRING, CategoryAncestry ARRAY<ROW<Id STRING, Name STRING> NOT NULL>, Subtitle STRING, ExternalUrl STRING, SoldBy STRING, ShowSoldBy BOOLEAN, PharmacyInformation ROW<ArticleNumber STRING, ActiveSubstance STRING, ItemType STRING, SalesLimit INT64, SalesRestrictionType STRING, VendingType STRING>, HasPharmacyDiff BOOLEAN, Disclaimer STRING, Supplier ROW<Id STRING, Name STRING>>> NOT NULL, options={{}}}
Field{name=OriginalCartId, description=, type=STRING, options={{}}}
Field{name=ChangingOrderId, description=, type=INT64, options={{}}}
Field{name=OrderMessage, description=, type=STRING, options={{}}}
Field{name=SocialSecurityNo, description=, type=STRING, options={{}}}
Field{name=TotalPaidAmount, description=, type=DOUBLE, options={{}}}
Field{name=CartStatus, description=, type=STRING, options={{}}}
Field{name=Payment, description=, type=ROW<PaymentType STRING, OrderReference STRING>, options={{}}}
Field{name=DeliveryTime, description=, type=ROW<Id STRING, TruckRouteId INT64, Added DATETIME, TimeId STRING, StartDate DATETIME, StopDate DATETIME, DeliveryCost DOUBLE, ExtraDeliveryCost DOUBLE, InHomeDelivery BOOLEAN, DeliveryTimeChangedByAdmin BOOLEAN, DeliveryRestrictions ARRAY<STRING NOT NULL>, ClosingDate DATETIME, ClosingTime LOGICAL_TYPE, StoreId STRING, DeliveryFeeLimits ARRAY<ROW<Cost DOUBLE, Limit DOUBLE> NOT NULL>>, options={{}}}
Field{name=Address, description=, type=ROW<Id STRING, LegacyAddressId STRING, AddressType STRING, MemberId STRING, CompanyName STRING, FirstName STRING, LastName STRING, PhoneMobile STRING, PhoneHome STRING, AlternativePhoneHome STRING, AlternativePhoneMobile STRING, AddressRow1 STRING, AddressRow2 STRING, DoorCode STRING, AddressInfo STRING, PostalCode STRING, City STRING, Latitude DOUBLE, Longitude DOUBLE, TruckRouteId INT64, InHomeAvailable BOOLEAN, CreationDate STRING, LastModifiedDate STRING, RemovedDate STRING>, options={{}}}
Field{name=RecurringOrder, description=, type=ROW<Status INT64, Interval INT64>, options={{}}}
Field{name=Recipes, description=, type=ROW<key STRING, value ROW<Id STRING, RecipeId STRING, ExternalRecipeId STRING, Name STRING, Added DATETIME, Url STRING, ImageUrl STRING, Portions INT64, RecipeProducts ARRAY<ROW<ProductId STRING, Quantity DOUBLE, Unit STRING> NOT NULL>>> NOT NULL, options={{}}}
Field{name=Discounts, description=, type=ROW<key STRING, value ROW<Id STRING, Code STRING, Text STRING, PercentageDeliveryFee DOUBLE, Percentage DOUBLE, Value DOUBLE, AmountLimit DOUBLE, ProductId STRING>> NOT NULL, options={{}}}
Field{name=Fees, description=, type=ROW<key STRING, value ROW<Id STRING, Amount DOUBLE, VatRate DOUBLE>> NOT NULL, options={{}}}
Field{name=Bonuses, description=, type=ROW<key STRING, value ROW<Id STRING, Code STRING, Amount DOUBLE>> NOT NULL, options={{}}}
Field{name=GiftVouchers, description=, type=ROW<key STRING, value ROW<Id STRING, Code STRING, Text STRING, Comments STRING, Value DOUBLE, ValidFrom DATETIME, ValidUntil DATETIME, AlreadyUsed BOOLEAN>> NOT NULL, options={{}}}
Field{name=Credit, description=, type=ARRAY<ROW<key STRING, value DOUBLE> NOT NULL>, options={{}}}
Field{name=OriginalProducts, description=, type=ROW<key STRING, value ROW<Id STRING, Quantity DOUBLE, Name STRING, Price DOUBLE, IsWine BOOLEAN, ProductDiscountPrice DOUBLE>> NOT NULL, options={{}}}
Field{name=OriginalDeliveryDate, description=, type=DATETIME, options={{}}}
Field{name=LockPhoneNumber, description=, type=STRING, options={{}}}
Field{name=SubscriptionId, description=, type=STRING, options={{}}}
Field{name=UnavailableSubscriptionProducts, description=, type=ROW<key STRING, value ROW<ProductId STRING, Name STRING, Quantity INT64, ReasonCode STRING>> NOT NULL, options={{}}}
Field{name=MemberGroupFees, description=, type=ROW<PickingCost STRING, DeliveryFee ROW<UseDeliveryFee BOOLEAN, Under INT64, Between INT64, Over INT64, LimitUnder INT64, LimitOver INT64, DeliveryFeeLimits ARRAY<ROW<Cost DOUBLE, Limit DOUBLE> NOT NULL>>, InvoiceCost DOUBLE>, options={{}}}
Field{name=PartitionTimestamp, description=, type=DATETIME, options={{}}}
Field{name=NumberOfConfirmedOrderLines, description=, type=INT64, options={{}}}
Field{name=DeliveryTimeStatus, description=, type=ROW<Status STRING, Modified DATETIME, ExpiresAt DATETIME>, options={{}}}
Field{name=_ATTRIBUTES, description=, type=ARRAY<ROW<key STRING, value STRING> NOT NULL>, options={{}}}
Field{name=Benefits, description=, type=ARRAY<ROW<MemberId STRING, BenefitType STRING, Benefits ARRAY<ROW<FromOrderId STRING, NewOrderAmountRequired DOUBLE, OrderDeliveryDate STRING, Status ROW<Applicable BOOLEAN, Reason STRING>, ValidFrom STRING, ValidUntil STRING, Applied BOOLEAN, UsedOnOrder STRING> NOT NULL>> NOT NULL>, options={{}}}
Field{name=ProductRestrictions, description=, type=ARRAY<ROW<ProductId STRING, Description STRING, MaxQuantity INT64, Quantity INT64, Modified STRING, RestrictionId STRING, MaxTotalQuantity INT64, CurrentTotalQuantity INT64> NOT NULL>, options={{}}}
Field{name=_metadata, description=, type=ROW<uuid STRING, operation STRING, topic STRING, timestamp DATETIME, entity STRING, dynamodbPublished DATETIME, salesforcePublished DATETIME, dynamodbEventId STRING, event_id STRING, processing_timestamp DATETIME>, options={{}}}
Field{name=event_timestamp, description=, type=DATETIME, options={{}}}
Encoding positions:
{Products=8, Modified=6, _ATTRIBUTES=34, Address=17, OriginalDeliveryDate=26, Discounts=20, ProductRestrictions=36, LockPhoneNumber=27, Benefits=35, event_timestamp=38, Created=5, MemberId=3, SocialSecurityNo=12, NumberOfConfirmedOrderLines=32, Credit=24, SubscriptionId=28, DeliveryTimeStatus=33, StoreId=2, ChangingOrderId=10, TotalPaidAmount=13, UnavailableSubscriptionProducts=29, PartitionTimestamp=31, _metadata=37, CartStatus=14, Bonuses=22, OriginalCartId=9, RecurringOrder=18, Fees=21, GiftVouchers=23, DeliveryTime=16, Payment=15, MemberGroupFees=30, Revision=1, MemberType=4, OriginalProducts=25, Recipes=19, OrderMessage=11, Id=0, Expires=7}
Options:{{entity=Option{type=STRING NOT NULL, value=ecom_cart_service_carteventtopic}}}UUID: null
[direct-runner-worker] ERROR org.streamprocessor.core.transforms.SerializeMessageToRowFn - ecom_cart_service_carteventtopic: org.apache.beam.sdk.util.RowJson$UnsupportedRowJsonException: Expected JSON array for field 'Credit'. Instead got OBJECT
[direct-runner-worker] INFO org.streamprocessor.core.transforms.SerializeMessageToRowFn - [processElement] Before row dese
[direct-runner-worker] INFO org.streamprocessor.core.transforms.SerializeMessageToRowFn - [processElement] payload: {"Products":{"Init":{"Category":null,"Discount":null,"Attributes":null,"Url":null,"Name":null,"Department":null,"HasPharmacyDiff":false,"SoldBy":null,"Supplier":null,"StockInformation":null,"Availability":null,"ExternalSupplierCode":null,"Added":null,"Quantity":0,"ImageUrl":null,"ExternalUrl":null,"Disclaimer":null,"VatRate":0,"RecycleFee":0,"Brand":null,"Subtitle":null,"Price":0,"CategoryAncestry":null,"PharmacyInformation":null,"ExternalProductCode":null,"Id":"0","Delivery":null,"EanCode":null,"ShowSoldBy":false},"175504":{"Category":{"Id":"toalettpapper","Name":"Toalettpapper"},"Discount":{"MinComparisonPrice":64.07,"Limits":[{"Operator":"=","Group":"Product","Value":"1","Property":"Quantity"}],"DiscountPrice":{"DiscountPriceType":0,"Value":69},"ValidFrom":"2023-02-12T00:00:00+00:00","Id":"2134064","MinPrice":99.95,"Conditions":[{"Operator":"=","Group":"Order","Value":"23","Property":"StoreId"},{"Operator":"=","Group":"Product","Value":"1","Property":"ProductCount"}],"CanUseProductOfferDiscount":true,"ValidUntil":"2023-02-18T00:00:00+00:00"},"Attributes":null,"Url":"/varor/toalettpapper/toalettpapper-classic-18-p-lotus","Name":"Toalettpapper Classic 18-p Lotus","Department":{"Id":"hem-o-hygien","Name":"Hem & Hushåll"},"HasPharmacyDiff":false,"SoldBy":"mathem","Supplier":{"Id":"13792","Name":"Essity"},"StockInformation":{"Active":true,"OutOfStock":false,"AvailableQuantity":null},"Availability":"Available","ExternalSupplierCode":null,"Added":"2023-02-15T12:59:41.3975482Z","Quantity":33,"ImageUrl":"07322541488479_4.jpg","ExternalUrl":null,"Disclaimer":null,"VatRate":25,"RecycleFee":0,"Brand":{"Id":"lotus","Name":"LOTUS"},"Subtitle":null,"Price":89.95,"CategoryAncestry":[{"Id":"toalettpapper","Name":"Toalettpapper"},{"Id":"hushalls--o-toapapper","Name":"Hushålls- & Toapapper"},{"Id":"hem-o-hygien","Name":"Hem & Hushåll"}],"PharmacyInformation":null,"ExternalProductCode":"541488479","Id":"175504","Delivery":{"AdvanceDeliveryMinimumOrder":0,"DeliverableWeekdays":[],"IsPickingCostIncluded":false,"CancelDaysBefore":0,"IsAdultProduct":false,"MinimumRequiredDeliveryDays":0,"IsSubscriptionProduct":false,"IsWine":false,"DeliveryRestrictions":[],"IsDeliveryCostIncluded":false},"EanCode":"7322541488479","ShowSoldBy":false}},"Modified":"2023-02-15T12:59:44.3012186Z","Address":null,"OriginalDeliveryDate":null,"Discounts":{"Init":{"Percentage":0,"PercentageDeliveryFee":0,"Value":0,"Text":null,"ProductId":null,"Id":"0","Code":null,"AmountLimit":0}},"ProductRestrictions":[],"Benefits":null,"event_timestamp":"2023-02-15T12:59:44.6862069Z","Created":"2023-02-15T12:59:34.0479674Z","MemberId":null,"SocialSecurityNo":null,"NumberOfConfirmedOrderLines":0,"DeliveryTimeStatus":{"Status":"None","Modified":"2023-02-15T12:59:34.0479861Z","ExpiresAt":null},"Credit":{"CONFIRMED_ORDER_CREDIT":0,"USED_CREDIT":0,"AVAILABLE_CREDIT":0},"SubscriptionId":null,"StoreId":"23","ChangingOrderId":0,"TotalPaidAmount":0,"UnavailableSubscriptionProducts":{"Init":{"Quantity":0,"ProductId":null,"ReasonCode":null,"Name":null}},"_metadata":{"processing_timestamp":"2023-02-15T13:29:11.376Z","dynamodbEventId":"3872def9-2345-490e-8b93-4892ee60db36","topic":"ecom-cart-service-CartEventTopic","uuid":"ad944215-c007-5238-8776-1e73198743c8","operation":"MODIFY","entity":"ecom-cart-service-CartEventTopic","timestamp":"2023-02-15T12:59:44.699Z","dynamodbPublished":"2023-02-15T12:59:44.6862069Z"},"CartStatus":"OPEN","Bonuses":{"Init":{"Amount":0,"Id":"0","Code":null}},"OriginalCartId":null,"RecurringOrder":null,"Fees":{"Init":{"Amount":0,"Id":"0","VatRate":0}},"GiftVouchers":{"Init":{"Comments":null,"Value":0,"ValidFrom":"0001-01-01T00:00:00","Text":null,"AlreadyUsed":false,"Id":"0","Code":null,"ValidUntil":"0001-01-01T00:00:00"}},"LeaveOutsideDoor":null,"DeliveryTime":null,"Payment":null,"MemberGroupFees":null,"Revision":3,"MemberType":null,"OriginalProducts":{"Init":{"Price":0,"ProductDiscountPrice":null,"Quantity":0,"Id":"0","IsWine":false,"Name":null}},"Recipes":{"Init":{"RecipeProducts":[],"Added":null,"Portions":0,"ExternalRecipeId":null,"RecipeId":null,"ImageUrl":null,"Id":"0","Url":null,"Name":null}},"OrderMessage":null,"Id":"34664edd-b406-4a0e-ac0e-ab3f93ff1335","Expires":"2023-02-22T12:59:44Z"}
[direct-runner-worker] INFO org.streamprocessor.core.transforms.SerializeMessageToRowFn - [processElement] schema: Fields:
Field{name=Id, description=, type=STRING, options={{}}}
Field{name=Revision, description=, type=INT64, options={{}}}
Field{name=StoreId, description=, type=STRING, options={{}}}
Field{name=MemberId, description=, type=STRING, options={{}}}
Field{name=MemberType, description=, type=STRING, options={{}}}
Field{name=Created, description=, type=DATETIME, options={{}}}
Field{name=Modified, description=, type=DATETIME, options={{}}}
Field{name=Expires, description=, type=DATETIME, options={{}}}
Field{name=Products, description=, type=ROW<key STRING, value ROW<Id STRING, Quantity DOUBLE, Name STRING, Added DATETIME, Category ROW<Id STRING, Name STRING>, Price DOUBLE, VatRate DOUBLE, Url STRING, ImageUrl STRING, EanCode STRING, ExternalSupplierCode STRING, ExternalProductCode STRING, Department ROW<Id STRING, Name STRING>, Brand ROW<Id STRING, Name STRING>, RecycleFee DOUBLE, Attributes ARRAY<STRING NOT NULL>, Discount ROW<Id STRING, DiscountPrice ROW<Value DOUBLE, DiscountPriceType INT64>, Limits ARRAY<ROW<Group STRING, Property STRING, Operator STRING, Value STRING> NOT NULL>, Conditions ARRAY<ROW<Group STRING, Property STRING, Operator STRING, Value STRING> NOT NULL>, ValidFrom DATETIME, ValidUntil DATETIME, CanUseProductOfferDiscount BOOLEAN>, Delivery ROW<IsPickingCostIncluded BOOLEAN, IsDeliveryCostIncluded BOOLEAN, IsSubscriptionProduct BOOLEAN, CancelDaysBefore INT64, MinimumRequiredDeliveryDays INT64, AdvanceDeliveryMinimumOrder INT64, IsAdultProduct BOOLEAN, IsWine BOOLEAN, DeliverableWeekdays ARRAY<STRING NOT NULL>, DeliveryRestrictions ARRAY<STRING NOT NULL>>, Availability STRING, CategoryAncestry ARRAY<ROW<Id STRING, Name STRING> NOT NULL>, Subtitle STRING, ExternalUrl STRING, SoldBy STRING, ShowSoldBy BOOLEAN, PharmacyInformation ROW<ArticleNumber STRING, ActiveSubstance STRING, ItemType STRING, SalesLimit INT64, SalesRestrictionType STRING, VendingType STRING>, HasPharmacyDiff BOOLEAN, Disclaimer STRING, Supplier ROW<Id STRING, Name STRING>>> NOT NULL, options={{}}}
Field{name=OriginalCartId, description=, type=STRING, options={{}}}
Field{name=ChangingOrderId, description=, type=INT64, options={{}}}
Field{name=OrderMessage, description=, type=STRING, options={{}}}
Field{name=SocialSecurityNo, description=, type=STRING, options={{}}}
Field{name=TotalPaidAmount, description=, type=DOUBLE, options={{}}}
Field{name=CartStatus, description=, type=STRING, options={{}}}
Field{name=Payment, description=, type=ROW<PaymentType STRING, OrderReference STRING>, options={{}}}
Field{name=DeliveryTime, description=, type=ROW<Id STRING, TruckRouteId INT64, Added DATETIME, TimeId STRING, StartDate DATETIME, StopDate DATETIME, DeliveryCost DOUBLE, ExtraDeliveryCost DOUBLE, InHomeDelivery BOOLEAN, DeliveryTimeChangedByAdmin BOOLEAN, DeliveryRestrictions ARRAY<STRING NOT NULL>, ClosingDate DATETIME, ClosingTime LOGICAL_TYPE, StoreId STRING, DeliveryFeeLimits ARRAY<ROW<Cost DOUBLE, Limit DOUBLE> NOT NULL>>, options={{}}}
Field{name=Address, description=, type=ROW<Id STRING, LegacyAddressId STRING, AddressType STRING, MemberId STRING, CompanyName STRING, FirstName STRING, LastName STRING, PhoneMobile STRING, PhoneHome STRING, AlternativePhoneHome STRING, AlternativePhoneMobile STRING, AddressRow1 STRING, AddressRow2 STRING, DoorCode STRING, AddressInfo STRING, PostalCode STRING, City STRING, Latitude DOUBLE, Longitude DOUBLE, TruckRouteId INT64, InHomeAvailable BOOLEAN, CreationDate STRING, LastModifiedDate STRING, RemovedDate STRING>, options={{}}}
Field{name=RecurringOrder, description=, type=ROW<Status INT64, Interval INT64>, options={{}}}
Field{name=Recipes, description=, type=ROW<key STRING, value ROW<Id STRING, RecipeId STRING, ExternalRecipeId STRING, Name STRING, Added DATETIME, Url STRING, ImageUrl STRING, Portions INT64, RecipeProducts ARRAY<ROW<ProductId STRING, Quantity DOUBLE, Unit STRING> NOT NULL>>> NOT NULL, options={{}}}
Field{name=Discounts, description=, type=ROW<key STRING, value ROW<Id STRING, Code STRING, Text STRING, PercentageDeliveryFee DOUBLE, Percentage DOUBLE, Value DOUBLE, AmountLimit DOUBLE, ProductId STRING>> NOT NULL, options={{}}}
Field{name=Fees, description=, type=ROW<key STRING, value ROW<Id STRING, Amount DOUBLE, VatRate DOUBLE>> NOT NULL, options={{}}}
Field{name=Bonuses, description=, type=ROW<key STRING, value ROW<Id STRING, Code STRING, Amount DOUBLE>> NOT NULL, options={{}}}
Field{name=GiftVouchers, description=, type=ROW<key STRING, value ROW<Id STRING, Code STRING, Text STRING, Comments STRING, Value DOUBLE, ValidFrom DATETIME, ValidUntil DATETIME, AlreadyUsed BOOLEAN>> NOT NULL, options={{}}}
Field{name=Credit, description=, type=ARRAY<ROW<key STRING, value DOUBLE> NOT NULL>, options={{}}}
Field{name=OriginalProducts, description=, type=ROW<key STRING, value ROW<Id STRING, Quantity DOUBLE, Name STRING, Price DOUBLE, IsWine BOOLEAN, ProductDiscountPrice DOUBLE>> NOT NULL, options={{}}}
Field{name=OriginalDeliveryDate, description=, type=DATETIME, options={{}}}
Field{name=LockPhoneNumber, description=, type=STRING, options={{}}}
Field{name=SubscriptionId, description=, type=STRING, options={{}}}
Field{name=UnavailableSubscriptionProducts, description=, type=ROW<key STRING, value ROW<ProductId STRING, Name STRING, Quantity INT64, ReasonCode STRING>> NOT NULL, options={{}}}
Field{name=MemberGroupFees, description=, type=ROW<PickingCost STRING, DeliveryFee ROW<UseDeliveryFee BOOLEAN, Under INT64, Between INT64, Over INT64, LimitUnder INT64, LimitOver INT64, DeliveryFeeLimits ARRAY<ROW<Cost DOUBLE, Limit DOUBLE> NOT NULL>>, InvoiceCost DOUBLE>, options={{}}}
Field{name=PartitionTimestamp, description=, type=DATETIME, options={{}}}
Field{name=NumberOfConfirmedOrderLines, description=, type=INT64, options={{}}}
Field{name=DeliveryTimeStatus, description=, type=ROW<Status STRING, Modified DATETIME, ExpiresAt DATETIME>, options={{}}}
Field{name=_ATTRIBUTES, description=, type=ARRAY<ROW<key STRING, value STRING> NOT NULL>, options={{}}}
Field{name=Benefits, description=, type=ARRAY<ROW<MemberId STRING, BenefitType STRING, Benefits ARRAY<ROW<FromOrderId STRING, NewOrderAmountRequired DOUBLE, OrderDeliveryDate STRING, Status ROW<Applicable BOOLEAN, Reason STRING>, ValidFrom STRING, ValidUntil STRING, Applied BOOLEAN, UsedOnOrder STRING> NOT NULL>> NOT NULL>, options={{}}}
Field{name=ProductRestrictions, description=, type=ARRAY<ROW<ProductId STRING, Description STRING, MaxQuantity INT64, Quantity INT64, Modified STRING, RestrictionId STRING, MaxTotalQuantity INT64, CurrentTotalQuantity INT64> NOT NULL>, options={{}}}
Field{name=_metadata, description=, type=ROW<uuid STRING, operation STRING, topic STRING, timestamp DATETIME, entity STRING, dynamodbPublished DATETIME, salesforcePublished DATETIME, dynamodbEventId STRING, event_id STRING, processing_timestamp DATETIME>, options={{}}}
Field{name=event_timestamp, description=, type=DATETIME, options={{}}}
Encoding positions:
{Products=8, Modified=6, _ATTRIBUTES=34, Address=17, OriginalDeliveryDate=26, Discounts=20, ProductRestrictions=36, LockPhoneNumber=27, Benefits=35, event_timestamp=38, Created=5, MemberId=3, SocialSecurityNo=12, NumberOfConfirmedOrderLines=32, Credit=24, SubscriptionId=28, DeliveryTimeStatus=33, StoreId=2, ChangingOrderId=10, TotalPaidAmount=13, UnavailableSubscriptionProducts=29, PartitionTimestamp=31, _metadata=37, CartStatus=14, Bonuses=22, OriginalCartId=9, RecurringOrder=18, Fees=21, GiftVouchers=23, DeliveryTime=16, Payment=15, MemberGroupFees=30, Revision=1, MemberType=4, OriginalProducts=25, Recipes=19, OrderMessage=11, Id=0, Expires=7}
Options:{{entity=Option{type=STRING NOT NULL, value=ecom_cart_service_carteventtopic}}}UUID: null
[direct-runner-worker] ERROR org.streamprocessor.core.transforms.SerializeMessageToRowFn - ecom_cart_service_carteventtopic: org.apache.beam.sdk.util.RowJson$UnsupportedRowJsonException: Expected JSON array for field 'Credit'. Instead got OBJECT
[direct-runner-worker] INFO org.streamprocessor.core.transforms.SerializeMessageToRowFn - [processElement] Before row dese
[direct-runner-worker] INFO org.streamprocessor.core.transforms.SerializeMessageToRowFn - [processElement] payload: {"Products":{"Init":{"Category":null,"Discount":null,"Attributes":null,"Url":null,"Name":null,"Department":null,"HasPharmacyDiff":false,"SoldBy":null,"Supplier":null,"StockInformation":null,"Availability":null,"ExternalSupplierCode":null,"Added":null,"Quantity":0,"ImageUrl":null,"ExternalUrl":null,"Disclaimer":null,"VatRate":0,"RecycleFee":0,"Brand":null,"Subtitle":null,"Price":0,"CategoryAncestry":null,"PharmacyInformation":null,"ExternalProductCode":null,"Id":"0","Delivery":null,"EanCode":null,"ShowSoldBy":false}},"Modified":null,"Address":null,"OriginalDeliveryDate":null,"Discounts":{"Init":{"Percentage":0,"PercentageDeliveryFee":0,"Value":0,"Text":null,"ProductId":null,"Id":"0","Code":null,"AmountLimit":0}},"ProductRestrictions":[],"Benefits":null,"event_timestamp":"2023-02-15T12:59:45.2291097Z","Created":"2023-02-15T12:59:44.9879007Z","MemberId":null,"SocialSecurityNo":null,"NumberOfConfirmedOrderLines":0,"DeliveryTimeStatus":{"Status":"None","Modified":"2023-02-15T12:59:44.9879247Z","ExpiresAt":null},"Credit":{"CONFIRMED_ORDER_CREDIT":0,"USED_CREDIT":0,"AVAILABLE_CREDIT":0},"SubscriptionId":null,"StoreId":"23","ChangingOrderId":0,"TotalPaidAmount":0,"UnavailableSubscriptionProducts":{"Init":{"Quantity":0,"ProductId":null,"ReasonCode":null,"Name":null}},"_metadata":{"processing_timestamp":"2023-02-15T13:29:11.377Z","dynamodbEventId":"3e0a0508-fc9b-4306-b53e-3442fdc91ec9","topic":"ecom-cart-service-CartEventTopic","uuid":"bb692a10-27ae-5bdf-9680-7676fe2ff2ab","operation":"MODIFY","entity":"ecom-cart-service-CartEventTopic","timestamp":"2023-02-15T12:59:45.259Z","dynamodbPublished":"2023-02-15T12:59:45.2291097Z"},"CartStatus":"OPEN","Bonuses":{"Init":{"Amount":0,"Id":"0","Code":null}},"OriginalCartId":null,"RecurringOrder":null,"Fees":{"Init":{"Amount":0,"Id":"0","VatRate":0}},"GiftVouchers":{"Init":{"Comments":null,"Value":0,"ValidFrom":"0001-01-01T00:00:00","Text":null,"AlreadyUsed":false,"Id":"0","Code":null,"ValidUntil":"0001-01-01T00:00:00"}},"LeaveOutsideDoor":null,"DeliveryTime":null,"Payment":null,"MemberGroupFees":null,"Revision":1,"MemberType":null,"OriginalProducts":{"Init":{"Price":0,"ProductDiscountPrice":null,"Quantity":0,"Id":"0","IsWine":false,"Name":null}},"Recipes":{"Init":{"RecipeProducts":[],"Added":null,"Portions":0,"ExternalRecipeId":null,"RecipeId":null,"ImageUrl":null,"Id":"0","Url":null,"Name":null}},"OrderMessage":null,"Id":"7bb491c2-598c-4ffe-a983-909c9a49b41e","Expires":"2023-02-22T12:59:45Z"}
[direct-runner-worker] INFO org.streamprocessor.core.transforms.SerializeMessageToRowFn - [processElement] schema: Fields:
Field{name=Id, description=, type=STRING, options={{}}}
Field{name=Revision, description=, type=INT64, options={{}}}
Field{name=StoreId, description=, type=STRING, options={{}}}
Field{name=MemberId, description=, type=STRING, options={{}}}
Field{name=MemberType, description=, type=STRING, options={{}}}
Field{name=Created, description=, type=DATETIME, options={{}}}
Field{name=Modified, description=, type=DATETIME, options={{}}}
Field{name=Expires, description=, type=DATETIME, options={{}}}
Field{name=Products, description=, type=ROW<key STRING, value ROW<Id STRING, Quantity DOUBLE, Name STRING, Added DATETIME, Category ROW<Id STRING, Name STRING>, Price DOUBLE, VatRate DOUBLE, Url STRING, ImageUrl STRING, EanCode STRING, ExternalSupplierCode STRING, ExternalProductCode STRING, Department ROW<Id STRING, Name STRING>, Brand ROW<Id STRING, Name STRING>, RecycleFee DOUBLE, Attributes ARRAY<STRING NOT NULL>, Discount ROW<Id STRING, DiscountPrice ROW<Value DOUBLE, DiscountPriceType INT64>, Limits ARRAY<ROW<Group STRING, Property STRING, Operator STRING, Value STRING> NOT NULL>, Conditions ARRAY<ROW<Group STRING, Property STRING, Operator STRING, Value STRING> NOT NULL>, ValidFrom DATETIME, ValidUntil DATETIME, CanUseProductOfferDiscount BOOLEAN>, Delivery ROW<IsPickingCostIncluded BOOLEAN, IsDeliveryCostIncluded BOOLEAN, IsSubscriptionProduct BOOLEAN, CancelDaysBefore INT64, MinimumRequiredDeliveryDays INT64, AdvanceDeliveryMinimumOrder INT64, IsAdultProduct BOOLEAN, IsWine BOOLEAN, DeliverableWeekdays ARRAY<STRING NOT NULL>, DeliveryRestrictions ARRAY<STRING NOT NULL>>, Availability STRING, CategoryAncestry ARRAY<ROW<Id STRING, Name STRING> NOT NULL>, Subtitle STRING, ExternalUrl STRING, SoldBy STRING, ShowSoldBy BOOLEAN, PharmacyInformation ROW<ArticleNumber STRING, ActiveSubstance STRING, ItemType STRING, SalesLimit INT64, SalesRestrictionType STRING, VendingType STRING>, HasPharmacyDiff BOOLEAN, Disclaimer STRING, Supplier ROW<Id STRING, Name STRING>>> NOT NULL, options={{}}}
Field{name=OriginalCartId, description=, type=STRING, options={{}}}
Field{name=ChangingOrderId, description=, type=INT64, options={{}}}
Field{name=OrderMessage, description=, type=STRING, options={{}}}
Field{name=SocialSecurityNo, description=, type=STRING, options={{}}}
Field{name=TotalPaidAmount, description=, type=DOUBLE, options={{}}}
Field{name=CartStatus, description=, type=STRING, options={{}}}
Field{name=Payment, description=, type=ROW<PaymentType STRING, OrderReference STRING>, options={{}}}
Field{name=DeliveryTime, description=, type=ROW<Id STRING, TruckRouteId INT64, Added DATETIME, TimeId STRING, StartDate DATETIME, StopDate DATETIME, DeliveryCost DOUBLE, ExtraDeliveryCost DOUBLE, InHomeDelivery BOOLEAN, DeliveryTimeChangedByAdmin BOOLEAN, DeliveryRestrictions ARRAY<STRING NOT NULL>, ClosingDate DATETIME, ClosingTime LOGICAL_TYPE, StoreId STRING, DeliveryFeeLimits ARRAY<ROW<Cost DOUBLE, Limit DOUBLE> NOT NULL>>, options={{}}}
Field{name=Address, description=, type=ROW<Id STRING, LegacyAddressId STRING, AddressType STRING, MemberId STRING, CompanyName STRING, FirstName STRING, LastName STRING, PhoneMobile STRING, PhoneHome STRING, AlternativePhoneHome STRING, AlternativePhoneMobile STRING, AddressRow1 STRING, AddressRow2 STRING, DoorCode STRING, AddressInfo STRING, PostalCode STRING, City STRING, Latitude DOUBLE, Longitude DOUBLE, TruckRouteId INT64, InHomeAvailable BOOLEAN, CreationDate STRING, LastModifiedDate STRING, RemovedDate STRING>, options={{}}}
Field{name=RecurringOrder, description=, type=ROW<Status INT64, Interval INT64>, options={{}}}
Field{name=Recipes, description=, type=ROW<key STRING, value ROW<Id STRING, RecipeId STRING, ExternalRecipeId STRING, Name STRING, Added DATETIME, Url STRING, ImageUrl STRING, Portions INT64, RecipeProducts ARRAY<ROW<ProductId STRING, Quantity DOUBLE, Unit STRING> NOT NULL>>> NOT NULL, options={{}}}
Field{name=Discounts, description=, type=ROW<key STRING, value ROW<Id STRING, Code STRING, Text STRING, PercentageDeliveryFee DOUBLE, Percentage DOUBLE, Value DOUBLE, AmountLimit DOUBLE, ProductId STRING>> NOT NULL, options={{}}}
Field{name=Fees, description=, type=ROW<key STRING, value ROW<Id STRING, Amount DOUBLE, VatRate DOUBLE>> NOT NULL, options={{}}}
Field{name=Bonuses, description=, type=ROW<key STRING, value ROW<Id STRING, Code STRING, Amount DOUBLE>> NOT NULL, options={{}}}
Field{name=GiftVouchers, description=, type=ROW<key STRING, value ROW<Id STRING, Code STRING, Text STRING, Comments STRING, Value DOUBLE, ValidFrom DATETIME, ValidUntil DATETIME, AlreadyUsed BOOLEAN>> NOT NULL, options={{}}}
Field{name=Credit, description=, type=ARRAY<ROW<key STRING, value DOUBLE> NOT NULL>, options={{}}}
Field{name=OriginalProducts, description=, type=ROW<key STRING, value ROW<Id STRING, Quantity DOUBLE, Name STRING, Price DOUBLE, IsWine BOOLEAN, ProductDiscountPrice DOUBLE>> NOT NULL, options={{}}}
Field{name=OriginalDeliveryDate, description=, type=DATETIME, options={{}}}
Field{name=LockPhoneNumber, description=, type=STRING, options={{}}}
Field{name=SubscriptionId, description=, type=STRING, options={{}}}
Field{name=UnavailableSubscriptionProducts, description=, type=ROW<key STRING, value ROW<ProductId STRING, Name STRING, Quantity INT64, ReasonCode STRING>> NOT NULL, options={{}}}
Field{name=MemberGroupFees, description=, type=ROW<PickingCost STRING, DeliveryFee ROW<UseDeliveryFee BOOLEAN, Under INT64, Between INT64, Over INT64, LimitUnder INT64, LimitOver INT64, DeliveryFeeLimits ARRAY<ROW<Cost DOUBLE, Limit DOUBLE> NOT NULL>>, InvoiceCost DOUBLE>, options={{}}}
Field{name=PartitionTimestamp, description=, type=DATETIME, options={{}}}
Field{name=NumberOfConfirmedOrderLines, description=, type=INT64, options={{}}}
Field{name=DeliveryTimeStatus, description=, type=ROW<Status STRING, Modified DATETIME, ExpiresAt DATETIME>, options={{}}}
Field{name=_ATTRIBUTES, description=, type=ARRAY<ROW<key STRING, value STRING> NOT NULL>, options={{}}}
Field{name=Benefits, description=, type=ARRAY<ROW<MemberId STRING, BenefitType STRING, Benefits ARRAY<ROW<FromOrderId STRING, NewOrderAmountRequired DOUBLE, OrderDeliveryDate STRING, Status ROW<Applicable BOOLEAN, Reason STRING>, ValidFrom STRING, ValidUntil STRING, Applied BOOLEAN, UsedOnOrder STRING> NOT NULL>> NOT NULL>, options={{}}}
Field{name=ProductRestrictions, description=, type=ARRAY<ROW<ProductId STRING, Description STRING, MaxQuantity INT64, Quantity INT64, Modified STRING, RestrictionId STRING, MaxTotalQuantity INT64, CurrentTotalQuantity INT64> NOT NULL>, options={{}}}
Field{name=_metadata, description=, type=ROW<uuid STRING, operation STRING, topic STRING, timestamp DATETIME, entity STRING, dynamodbPublished DATETIME, salesforcePublished DATETIME, dynamodbEventId STRING, event_id STRING, processing_timestamp DATETIME>, options={{}}}
Field{name=event_timestamp, description=, type=DATETIME, options={{}}}
Encoding positions:
{Products=8, Modified=6, _ATTRIBUTES=34, Address=17, OriginalDeliveryDate=26, Discounts=20, ProductRestrictions=36, LockPhoneNumber=27, Benefits=35, event_timestamp=38, Created=5, MemberId=3, SocialSecurityNo=12, NumberOfConfirmedOrderLines=32, Credit=24, SubscriptionId=28, DeliveryTimeStatus=33, StoreId=2, ChangingOrderId=10, TotalPaidAmount=13, UnavailableSubscriptionProducts=29, PartitionTimestamp=31, _metadata=37, CartStatus=14, Bonuses=22, OriginalCartId=9, RecurringOrder=18, Fees=21, GiftVouchers=23, DeliveryTime=16, Payment=15, MemberGroupFees=30, Revision=1, MemberType=4, OriginalProducts=25, Recipes=19, OrderMessage=11, Id=0, Expires=7}
Options:{{entity=Option{type=STRING NOT NULL, value=ecom_cart_service_carteventtopic}}}UUID: null
[direct-runner-worker] ERROR org.streamprocessor.core.transforms.SerializeMessageToRowFn - ecom_cart_service_carteventtopic: org.apache.beam.sdk.util.RowJson$UnsupportedRowJsonException: Expected JSON array for field 'Credit'. Instead got OBJECT
[direct-runner-worker] INFO org.streamprocessor.core.transforms.SerializeMessageToRowFn - [processElement] Before row dese
[direct-runner-worker] INFO org.streamprocessor.core.transforms.SerializeMessageToRowFn - [processElement] payload: {"Products":{"Init":{"Category":null,"Discount":null,"Attributes":null,"Url":null,"Name":null,"Department":null,"HasPharmacyDiff":false,"SoldBy":null,"Supplier":null,"StockInformation":null,"Availability":null,"ExternalSupplierCode":null,"Added":null,"Quantity":0,"ImageUrl":null,"ExternalUrl":null,"Disclaimer":null,"VatRate":0,"RecycleFee":0,"Brand":null,"Subtitle":null,"Price":0,"CategoryAncestry":null,"PharmacyInformation":null,"ExternalProductCode":null,"Id":"0","Delivery":null,"EanCode":null,"ShowSoldBy":false},"175504":{"Category":{"Id":"toalettpapper","Name":"Toalettpapper"},"Discount":{"MinComparisonPrice":64.07,"Limits":[{"Operator":"=","Group":"Product","Value":"1","Property":"Quantity"}],"DiscountPrice":{"DiscountPriceType":0,"Value":69},"ValidFrom":"2023-02-12T00:00:00+00:00","Id":"2134064","MinPrice":99.95,"Conditions":[{"Operator":"=","Group":"Order","Value":"23","Property":"StoreId"},{"Operator":"=","Group":"Product","Value":"1","Property":"ProductCount"}],"CanUseProductOfferDiscount":true,"ValidUntil":"2023-02-18T00:00:00+00:00"},"Attributes":null,"Url":"/varor/toalettpapper/toalettpapper-classic-18-p-lotus","Name":"Toalettpapper Classic 18-p Lotus","Department":{"Id":"hem-o-hygien","Name":"Hem & Hushåll"},"HasPharmacyDiff":false,"SoldBy":"mathem","Supplier":{"Id":"13792","Name":"Essity"},"StockInformation":{"Active":true,"OutOfStock":false,"AvailableQuantity":null},"Availability":"Available","ExternalSupplierCode":null,"Added":"2023-02-15T13:00:00.4667814Z","Quantity":1,"ImageUrl":"07322541488479_4.jpg","ExternalUrl":null,"Disclaimer":null,"VatRate":25,"RecycleFee":0,"Brand":{"Id":"lotus","Name":"LOTUS"},"Subtitle":null,"Price":89.95,"CategoryAncestry":[{"Id":"toalettpapper","Name":"Toalettpapper"},{"Id":"hushalls--o-toapapper","Name":"Hushålls- & Toapapper"},{"Id":"hem-o-hygien","Name":"Hem & Hushåll"}],"PharmacyInformation":null,"ExternalProductCode":"541488479","Id":"175504","Delivery":{"AdvanceDeliveryMinimumOrder":0,"DeliverableWeekdays":[],"IsPickingCostIncluded":false,"CancelDaysBefore":0,"IsAdultProduct":false,"MinimumRequiredDeliveryDays":0,"IsSubscriptionProduct":false,"IsWine":false,"DeliveryRestrictions":[],"IsDeliveryCostIncluded":false},"EanCode":"7322541488479","ShowSoldBy":false}},"Modified":"2023-02-15T13:00:00.4668144Z","Address":null,"OriginalDeliveryDate":null,"Discounts":{"Init":{"Percentage":0,"PercentageDeliveryFee":0,"Value":0,"Text":null,"ProductId":null,"Id":"0","Code":null,"AmountLimit":0}},"ProductRestrictions":[],"Benefits":null,"event_timestamp":"2023-02-15T13:00:00.7457051Z","Created":"2023-02-15T12:59:53.0565776Z","MemberId":null,"SocialSecurityNo":null,"NumberOfConfirmedOrderLines":0,"DeliveryTimeStatus":{"Status":"None","Modified":"2023-02-15T12:59:53.0566287Z","ExpiresAt":null},"Credit":{"CONFIRMED_ORDER_CREDIT":0,"USED_CREDIT":0,"AVAILABLE_CREDIT":0},"SubscriptionId":null,"StoreId":"23","ChangingOrderId":0,"TotalPaidAmount":0,"UnavailableSubscriptionProducts":{"Init":{"Quantity":0,"ProductId":null,"ReasonCode":null,"Name":null}},"_metadata":{"processing_timestamp":"2023-02-15T13:29:11.377Z","dynamodbEventId":"13161909-03a9-4290-8af9-c971b8e7a4a3","topic":"ecom-cart-service-CartEventTopic","uuid":"20667a43-ca77-5d4c-88a2-262513e78275","operation":"MODIFY","entity":"ecom-cart-service-CartEventTopic","timestamp":"2023-02-15T13:00:00.798Z","dynamodbPublished":"2023-02-15T13:00:00.7457051Z"},"CartStatus":"OPEN","Bonuses":{"Init":{"Amount":0,"Id":"0","Code":null}},"OriginalCartId":null,"RecurringOrder":null,"Fees":{"Init":{"Amount":0,"Id":"0","VatRate":0}},"GiftVouchers":{"Init":{"Comments":null,"Value":0,"ValidFrom":"0001-01-01T00:00:00","Text":null,"AlreadyUsed":false,"Id":"0","Code":null,"ValidUntil":"0001-01-01T00:00:00"}},"LeaveOutsideDoor":null,"DeliveryTime":null,"Payment":null,"MemberGroupFees":null,"Revision":2,"MemberType":null,"OriginalProducts":{"Init":{"Price":0,"ProductDiscountPrice":null,"Quantity":0,"Id":"0","IsWine":false,"Name":null}},"Recipes":{"Init":{"RecipeProducts":[],"Added":null,"Portions":0,"ExternalRecipeId":null,"RecipeId":null,"ImageUrl":null,"Id":"0","Url":null,"Name":null}},"OrderMessage":null,"Id":"5798d4b8-a22e-4947-a8d1-a6cc42a8fe8a","Expires":"2023-02-22T13:00:00Z"}
[direct-runner-worker] INFO org.streamprocessor.core.transforms.SerializeMessageToRowFn - [processElement] schema: Fields:
Field{name=Id, description=, type=STRING, options={{}}}
Field{name=Revision, description=, type=INT64, options={{}}}
Field{name=StoreId, description=, type=STRING, options={{}}}
Field{name=MemberId, description=, type=STRING, options={{}}}
Field{name=MemberType, description=, type=STRING, options={{}}}
Field{name=Created, description=, type=DATETIME, options={{}}}
Field{name=Modified, description=, type=DATETIME, options={{}}}
Field{name=Expires, description=, type=DATETIME, options={{}}}
Field{name=Products, description=, type=ROW<key STRING, value ROW<Id STRING, Quantity DOUBLE, Name STRING, Added DATETIME, Category ROW<Id STRING, Name STRING>, Price DOUBLE, VatRate DOUBLE, Url STRING, ImageUrl STRING, EanCode STRING, ExternalSupplierCode STRING, ExternalProductCode STRING, Department ROW<Id STRING, Name STRING>, Brand ROW<Id STRING, Name STRING>, RecycleFee DOUBLE, Attributes ARRAY<STRING NOT NULL>, Discount ROW<Id STRING, DiscountPrice ROW<Value DOUBLE, DiscountPriceType INT64>, Limits ARRAY<ROW<Group STRING, Property STRING, Operator STRING, Value STRING> NOT NULL>, Conditions ARRAY<ROW<Group STRING, Property STRING, Operator STRING, Value STRING> NOT NULL>, ValidFrom DATETIME, ValidUntil DATETIME, CanUseProductOfferDiscount BOOLEAN>, Delivery ROW<IsPickingCostIncluded BOOLEAN, IsDeliveryCostIncluded BOOLEAN, IsSubscriptionProduct BOOLEAN, CancelDaysBefore INT64, MinimumRequiredDeliveryDays INT64, AdvanceDeliveryMinimumOrder INT64, IsAdultProduct BOOLEAN, IsWine BOOLEAN, DeliverableWeekdays ARRAY<STRING NOT NULL>, DeliveryRestrictions ARRAY<STRING NOT NULL>>, Availability STRING, CategoryAncestry ARRAY<ROW<Id STRING, Name STRING> NOT NULL>, Subtitle STRING, ExternalUrl STRING, SoldBy STRING, ShowSoldBy BOOLEAN, PharmacyInformation ROW<ArticleNumber STRING, ActiveSubstance STRING, ItemType STRING, SalesLimit INT64, SalesRestrictionType STRING, VendingType STRING>, HasPharmacyDiff BOOLEAN, Disclaimer STRING, Supplier ROW<Id STRING, Name STRING>>> NOT NULL, options={{}}}
Field{name=OriginalCartId, description=, type=STRING, options={{}}}
Field{name=ChangingOrderId, description=, type=INT64, options={{}}}
Field{name=OrderMessage, description=, type=STRING, options={{}}}
Field{name=SocialSecurityNo, description=, type=STRING, options={{}}}
Field{name=TotalPaidAmount, description=, type=DOUBLE, options={{}}}
Field{name=CartStatus, description=, type=STRING, options={{}}}
Field{name=Payment, description=, type=ROW<PaymentType STRING, OrderReference STRING>, options={{}}}
Field{name=DeliveryTime, description=, type=ROW<Id STRING, TruckRouteId INT64, Added DATETIME, TimeId STRING, StartDate DATETIME, StopDate DATETIME, DeliveryCost DOUBLE, ExtraDeliveryCost DOUBLE, InHomeDelivery BOOLEAN, DeliveryTimeChangedByAdmin BOOLEAN, DeliveryRestrictions ARRAY<STRING NOT NULL>, ClosingDate DATETIME, ClosingTime LOGICAL_TYPE, StoreId STRING, DeliveryFeeLimits ARRAY<ROW<Cost DOUBLE, Limit DOUBLE> NOT NULL>>, options={{}}}
Field{name=Address, description=, type=ROW<Id STRING, LegacyAddressId STRING, AddressType STRING, MemberId STRING, CompanyName STRING, FirstName STRING, LastName STRING, PhoneMobile STRING, PhoneHome STRING, AlternativePhoneHome STRING, AlternativePhoneMobile STRING, AddressRow1 STRING, AddressRow2 STRING, DoorCode STRING, AddressInfo STRING, PostalCode STRING, City STRING, Latitude DOUBLE, Longitude DOUBLE, TruckRouteId INT64, InHomeAvailable BOOLEAN, CreationDate STRING, LastModifiedDate STRING, RemovedDate STRING>, options={{}}}
Field{name=RecurringOrder, description=, type=ROW<Status INT64, Interval INT64>, options={{}}}
Field{name=Recipes, description=, type=ROW<key STRING, value ROW<Id STRING, RecipeId STRING, ExternalRecipeId STRING, Name STRING, Added DATETIME, Url STRING, ImageUrl STRING, Portions INT64, RecipeProducts ARRAY<ROW<ProductId STRING, Quantity DOUBLE, Unit STRING> NOT NULL>>> NOT NULL, options={{}}}
Field{name=Discounts, description=, type=ROW<key STRING, value ROW<Id STRING, Code STRING, Text STRING, PercentageDeliveryFee DOUBLE, Percentage DOUBLE, Value DOUBLE, AmountLimit DOUBLE, ProductId STRING>> NOT NULL, options={{}}}
Field{name=Fees, description=, type=ROW<key STRING, value ROW<Id STRING, Amount DOUBLE, VatRate DOUBLE>> NOT NULL, options={{}}}
Field{name=Bonuses, description=, type=ROW<key STRING, value ROW<Id STRING, Code STRING, Amount DOUBLE>> NOT NULL, options={{}}}
Field{name=GiftVouchers, description=, type=ROW<key STRING, value ROW<Id STRING, Code STRING, Text STRING, Comments STRING, Value DOUBLE, ValidFrom DATETIME, ValidUntil DATETIME, AlreadyUsed BOOLEAN>> NOT NULL, options={{}}}
Field{name=Credit, description=, type=ARRAY<ROW<key STRING, value DOUBLE> NOT NULL>, options={{}}}
Field{name=OriginalProducts, description=, type=ROW<key STRING, value ROW<Id STRING, Quantity DOUBLE, Name STRING, Price DOUBLE, IsWine BOOLEAN, ProductDiscountPrice DOUBLE>> NOT NULL, options={{}}}
Field{name=OriginalDeliveryDate, description=, type=DATETIME, options={{}}}
Field{name=LockPhoneNumber, description=, type=STRING, options={{}}}
Field{name=SubscriptionId, description=, type=STRING, options={{}}}
Field{name=UnavailableSubscriptionProducts, description=, type=ROW<key STRING, value ROW<ProductId STRING, Name STRING, Quantity INT64, ReasonCode STRING>> NOT NULL, options={{}}}
Field{name=MemberGroupFees, description=, type=ROW<PickingCost STRING, DeliveryFee ROW<UseDeliveryFee BOOLEAN, Under INT64, Between INT64, Over INT64, LimitUnder INT64, LimitOver INT64, DeliveryFeeLimits ARRAY<ROW<Cost DOUBLE, Limit DOUBLE> NOT NULL>>, InvoiceCost DOUBLE>, options={{}}}
Field{name=PartitionTimestamp, description=, type=DATETIME, options={{}}}
Field{name=NumberOfConfirmedOrderLines, description=, type=INT64, options={{}}}
Field{name=DeliveryTimeStatus, description=, type=ROW<Status STRING, Modified DATETIME, ExpiresAt DATETIME>, options={{}}}
Field{name=_ATTRIBUTES, description=, type=ARRAY<ROW<key STRING, value STRING> NOT NULL>, options={{}}}
Field{name=Benefits, description=, type=ARRAY<ROW<MemberId STRING, BenefitType STRING, Benefits ARRAY<ROW<FromOrderId STRING, NewOrderAmountRequired DOUBLE, OrderDeliveryDate STRING, Status ROW<Applicable BOOLEAN, Reason STRING>, ValidFrom STRING, ValidUntil STRING, Applied BOOLEAN, UsedOnOrder STRING> NOT NULL>> NOT NULL>, options={{}}}
Field{name=ProductRestrictions, description=, type=ARRAY<ROW<ProductId STRING, Description STRING, MaxQuantity INT64, Quantity INT64, Modified STRING, RestrictionId STRING, MaxTotalQuantity INT64, CurrentTotalQuantity INT64> NOT NULL>, options={{}}}
Field{name=_metadata, description=, type=ROW<uuid STRING, operation STRING, topic STRING, timestamp DATETIME, entity STRING, dynamodbPublished DATETIME, salesforcePublished DATETIME, dynamodbEventId STRING, event_id STRING, processing_timestamp DATETIME>, options={{}}}
Field{name=event_timestamp, description=, type=DATETIME, options={{}}}
Encoding positions:
{Products=8, Modified=6, _ATTRIBUTES=34, Address=17, OriginalDeliveryDate=26, Discounts=20, ProductRestrictions=36, LockPhoneNumber=27, Benefits=35, event_timestamp=38, Created=5, MemberId=3, SocialSecurityNo=12, NumberOfConfirmedOrderLines=32, Credit=24, SubscriptionId=28, DeliveryTimeStatus=33, StoreId=2, ChangingOrderId=10, TotalPaidAmount=13, UnavailableSubscriptionProducts=29, PartitionTimestamp=31, _metadata=37, CartStatus=14, Bonuses=22, OriginalCartId=9, RecurringOrder=18, Fees=21, GiftVouchers=23, DeliveryTime=16, Payment=15, MemberGroupFees=30, Revision=1, MemberType=4, OriginalProducts=25, Recipes=19, OrderMessage=11, Id=0, Expires=7}
Options:{{entity=Option{type=STRING NOT NULL, value=ecom_cart_service_carteventtopic}}}UUID: null
[direct-runner-worker] ERROR org.streamprocessor.core.transforms.SerializeMessageToRowFn - ecom_cart_service_carteventtopic: org.apache.beam.sdk.util.RowJson$UnsupportedRowJsonException: Expected JSON array for field 'Credit'. Instead got OBJECT
[direct-runner-worker] INFO org.streamprocessor.core.transforms.SerializeMessageToRowFn - [processElement] Before row dese
[direct-runner-worker] INFO org.streamprocessor.core.transforms.SerializeMessageToRowFn - [processElement] payload: {"Products":{"183117":{"Category":{"Id":"tandkram","Name":"Tandkräm"},"Discount":null,"Attributes":null,"Url":"/varor/nya-artiklar/gum-183117","Name":"GUM SensiVital+ tandkräm, Tandkräm, 75 ml","Department":{"Id":"apotek-o-halsa","Name":"Apotek, Hygien & Hälsa"},"HasPharmacyDiff":false,"SoldBy":"kronan","Supplier":{"Id":"17895","Name":"Sunstar Sverige AB"},"StockInformation":{"Active":false,"OutOfStock":false,"AvailableQuantity":null},"Availability":"Available","ExternalSupplierCode":"kronan","Added":"2023-02-15T12:23:48.4546941Z","Quantity":1,"ImageUrl":"7630019902984.jpg","ExternalUrl":null,"Disclaimer":null,"VatRate":25,"RecycleFee":0,"Brand":{"Id":"gum","Name":"GUM"},"Subtitle":null,"Price":39.95,"CategoryAncestry":[{"Id":"tandkram","Name":"Tandkräm"},{"Id":"mun-och-tander","Name":"Mun och tänder"},{"Id":"apotek-o-halsa","Name":"Apotek, Hygien & Hälsa"}],"PharmacyInformation":{"SalesLimit":0,"ArticleNumber":"777601","VendingType":"CrossDock","ItemType":"TG","SalesRestrictionType":"None","ActiveSubstance":null},"ExternalProductCode":"019902984","Id":"183117","Delivery":{"AdvanceDeliveryMinimumOrder":0,"DeliverableWeekdays":[],"IsPickingCostIncluded":false,"CancelDaysBefore":0,"IsAdultProduct":false,"MinimumRequiredDeliveryDays":0,"IsSubscriptionProduct":false,"IsWine":false,"DeliveryRestrictions":[],"IsDeliveryCostIncluded":false},"EanCode":"7630019902984","ShowSoldBy":true},"Init":{"Category":null,"Discount":null,"Attributes":null,"Url":null,"Name":null,"Department":null,"HasPharmacyDiff":false,"SoldBy":null,"Supplier":null,"StockInformation":null,"Availability":null,"ExternalSupplierCode":null,"Added":null,"Quantity":0,"ImageUrl":null,"ExternalUrl":null,"Disclaimer":null,"VatRate":0,"RecycleFee":0,"Brand":null,"Subtitle":null,"Price":0,"CategoryAncestry":null,"PharmacyInformation":null,"ExternalProductCode":null,"Id":"0","Delivery":null,"EanCode":null,"ShowSoldBy":false},"14307":{"Category":{"Id":"chokladkaka-ljus","Name":"Chokladkaka Ljus"},"Discount":null,"Attributes":null,"Url":"/varor/chokladkaka-ljus/chokladkaka-mjolkchoklad-200g-marabou","Name":"Chokladkaka Mjölkchoklad 200g Marabou","Department":{"Id":"glass-godis-o-snacks","Name":"Glass, godis & snacks"},"HasPharmacyDiff":false,"SoldBy":"mathem","Supplier":{"Id":"7539","Name":"Mondelez Sverige AB"},"StockInformation":{"Active":true,"OutOfStock":false,"AvailableQuantity":null},"Availability":"Available","ExternalSupplierCode":null,"Added":"2023-02-15T12:23:49.6671988Z","Quantity":1,"ImageUrl":"07310511210403_2.jpg","ExternalUrl":null,"Disclaimer":null,"VatRate":12,"RecycleFee":0,"Brand":{"Id":"marabou","Name":"Marabou"},"Subtitle":null,"Price":28.95,"CategoryAncestry":[{"Id":"chokladkaka-ljus","Name":"Chokladkaka Ljus"},{"Id":"chokladkakor","Name":"Chokladkakor"},{"Id":"choklad","Name":"Choklad"},{"Id":"glass-godis-o-snacks","Name":"Glass, godis & snacks"}],"PharmacyInformation":null,"ExternalProductCode":"511210403","Id":"14307","Delivery":{"AdvanceDeliveryMinimumOrder":40,"DeliverableWeekdays":[],"IsPickingCostIncluded":false,"CancelDaysBefore":0,"IsAdultProduct":false,"MinimumRequiredDeliveryDays":3,"IsSubscriptionProduct":false,"IsWine":false,"DeliveryRestrictions":[],"IsDeliveryCostIncluded":false},"EanCode":"7310511210403","ShowSoldBy":false}},"Modified":"2023-02-15T13:00:19.1701029Z","Address":{"CreationDate":"2023-02-02T16:39:05","LastModifiedDate":"2023-02-14T19:49:30","AlternativePhoneMobile":"0702180316","LegacyAddressId":"10911052","FirstName":"Marcus","PostalCode":"14264","Latitude":59.2318,"City":"Trångsund","Longitude":18.1542,"InHomeAvailable":false,"DoorCode":"12345","AddressInfo":"test...","PhoneMobile":"0702180314","MemberId":"1600094","CompanyName":null,"TruckRouteId":0,"AlternativePhoneHome":"0702180317","RemovedDate":null,"PhoneHome":"0702180315","AddressRow1":"Lingonbackarna 22","Id":"ecb6113c-5010-4af6-9d22-f47313a568af","LastName":"Casserfelt","AddressType":"M","AddressRow2":null},"OriginalDeliveryDate":null,"Discounts":{"Init":{"Percentage":0,"PercentageDeliveryFee":0,"Value":0,"Text":null,"ProductId":null,"Id":"0","Code":null,"AmountLimit":0}},"ProductRestrictions":[],"Benefits":[{"BenefitType":"AdminFee","MemberId":"1600094","Id":"4ad05562-9843-4f9f-a3c8-9c9d5cda26b2","Benefits":[{"FromOrderId":"62017681","Status":{"Applicable":true,"Reason":null},"UsedOnOrder":"62017686","Amount":0,"OrderDeliveryDate":"2023-02-13T00:00:00+01:00","NewOrderAmountRequired":350,"ValidFrom":"2023-02-13T00:00:00+01:00","Id":"AdminFee-1","Applied":false,"UsedOnCart":null,"ValidUntil":"2023-02-18T23:59:59+01:00"}]}],"event_timestamp":"2023-02-15T13:00:19.7729705Z","Created":"2023-02-15T12:23:37.4153774Z","MemberId":"1600094","SocialSecurityNo":"197306200119","NumberOfConfirmedOrderLines":0,"DeliveryTimeStatus":{"Status":"Expired","Modified":"2023-02-15T13:00:19.1701167Z","ExpiresAt":"2023-02-15T13:00:13+00:00"},"Credit":{"CONFIRMED_ORDER_CREDIT":0,"USED_CREDIT":0,"AVAILABLE_CREDIT":0},"SubscriptionId":null,"StoreId":"10","ChangingOrderId":0,"TotalPaidAmount":0,"UnavailableSubscriptionProducts":{"Init":{"Quantity":0,"ProductId":null,"ReasonCode":null,"Name":null}},"_metadata":{"processing_timestamp":"2023-02-15T13:29:11.377Z","dynamodbEventId":"628450a0-ac13-4dc9-9563-636df33c3c97","topic":"ecom-cart-service-CartEventTopic","uuid":"ea1804fe-5f1e-5c5c-963e-589886bdb54a","operation":"MODIFY","entity":"ecom-cart-service-CartEventTopic","timestamp":"2023-02-15T13:00:19.816Z","dynamodbPublished":"2023-02-15T13:00:19.7729705Z"},"CartStatus":"OPEN","Bonuses":{"Init":{"Amount":0,"Id":"0","Code":null}},"OriginalCartId":null,"RecurringOrder":null,"Fees":{"Init":{"Amount":0,"Id":"0","VatRate":0}},"GiftVouchers":{"Init":{"Comments":null,"Value":0,"ValidFrom":"0001-01-01T00:00:00Z","Text":null,"AlreadyUsed":false,"Id":"0","Code":null,"ValidUntil":"0001-01-01T00:00:00Z"}},"LeaveOutsideDoor":null,"DeliveryTime":null,"Payment":null,"MemberGroupFees":null,"Revision":28,"MemberType":"P","OriginalProducts":{"Init":{"Price":0,"ProductDiscountPrice":null,"Quantity":0,"Id":"0","IsWine":false,"Name":null}},"Recipes":{"Init":{"RecipeProducts":[],"Added":null,"Portions":0,"ExternalRecipeId":null,"RecipeId":null,"ImageUrl":null,"Id":"0","Url":null,"Name":null}},"OrderMessage":null,"Id":"f0eef94f-9976-4873-aea3-7ffca0e41bc5","Expires":"2023-03-17T13:00:19Z"}
[direct-runner-worker] INFO org.streamprocessor.core.transforms.SerializeMessageToRowFn - [processElement] schema: Fields:
Field{name=Id, description=, type=STRING, options={{}}}
Field{name=Revision, description=, type=INT64, options={{}}}
Field{name=StoreId, description=, type=STRING, options={{}}}
Field{name=MemberId, description=, type=STRING, options={{}}}
Field{name=MemberType, description=, type=STRING, options={{}}}
Field{name=Created, description=, type=DATETIME, options={{}}}
Field{name=Modified, description=, type=DATETIME, options={{}}}
Field{name=Expires, description=, type=DATETIME, options={{}}}
Field{name=Products, description=, type=ROW<key STRING, value ROW<Id STRING, Quantity DOUBLE, Name STRING, Added DATETIME, Category ROW<Id STRING, Name STRING>, Price DOUBLE, VatRate DOUBLE, Url STRING, ImageUrl STRING, EanCode STRING, ExternalSupplierCode STRING, ExternalProductCode STRING, Department ROW<Id STRING, Name STRING>, Brand ROW<Id STRING, Name STRING>, RecycleFee DOUBLE, Attributes ARRAY<STRING NOT NULL>, Discount ROW<Id STRING, DiscountPrice ROW<Value DOUBLE, DiscountPriceType INT64>, Limits ARRAY<ROW<Group STRING, Property STRING, Operator STRING, Value STRING> NOT NULL>, Conditions ARRAY<ROW<Group STRING, Property STRING, Operator STRING, Value STRING> NOT NULL>, ValidFrom DATETIME, ValidUntil DATETIME, CanUseProductOfferDiscount BOOLEAN>, Delivery ROW<IsPickingCostIncluded BOOLEAN, IsDeliveryCostIncluded BOOLEAN, IsSubscriptionProduct BOOLEAN, CancelDaysBefore INT64, MinimumRequiredDeliveryDays INT64, AdvanceDeliveryMinimumOrder INT64, IsAdultProduct BOOLEAN, IsWine BOOLEAN, DeliverableWeekdays ARRAY<STRING NOT NULL>, DeliveryRestrictions ARRAY<STRING NOT NULL>>, Availability STRING, CategoryAncestry ARRAY<ROW<Id STRING, Name STRING> NOT NULL>, Subtitle STRING, ExternalUrl STRING, SoldBy STRING, ShowSoldBy BOOLEAN, PharmacyInformation ROW<ArticleNumber STRING, ActiveSubstance STRING, ItemType STRING, SalesLimit INT64, SalesRestrictionType STRING, VendingType STRING>, HasPharmacyDiff BOOLEAN, Disclaimer STRING, Supplier ROW<Id STRING, Name STRING>>> NOT NULL, options={{}}}
Field{name=OriginalCartId, description=, type=STRING, options={{}}}
Field{name=ChangingOrderId, description=, type=INT64, options={{}}}
Field{name=OrderMessage, description=, type=STRING, options={{}}}
Field{name=SocialSecurityNo, description=, type=STRING, options={{}}}
Field{name=TotalPaidAmount, description=, type=DOUBLE, options={{}}}
Field{name=CartStatus, description=, type=STRING, options={{}}}
Field{name=Payment, description=, type=ROW<PaymentType STRING, OrderReference STRING>, options={{}}}
Field{name=DeliveryTime, description=, type=ROW<Id STRING, TruckRouteId INT64, Added DATETIME, TimeId STRING, StartDate DATETIME, StopDate DATETIME, DeliveryCost DOUBLE, ExtraDeliveryCost DOUBLE, InHomeDelivery BOOLEAN, DeliveryTimeChangedByAdmin BOOLEAN, DeliveryRestrictions ARRAY<STRING NOT NULL>, ClosingDate DATETIME, ClosingTime LOGICAL_TYPE, StoreId STRING, DeliveryFeeLimits ARRAY<ROW<Cost DOUBLE, Limit DOUBLE> NOT NULL>>, options={{}}}
Field{name=Address, description=, type=ROW<Id STRING, LegacyAddressId STRING, AddressType STRING, MemberId STRING, CompanyName STRING, FirstName STRING, LastName STRING, PhoneMobile STRING, PhoneHome STRING, AlternativePhoneHome STRING, AlternativePhoneMobile STRING, AddressRow1 STRING, AddressRow2 STRING, DoorCode STRING, AddressInfo STRING, PostalCode STRING, City STRING, Latitude DOUBLE, Longitude DOUBLE, TruckRouteId INT64, InHomeAvailable BOOLEAN, CreationDate STRING, LastModifiedDate STRING, RemovedDate STRING>, options={{}}}
Field{name=RecurringOrder, description=, type=ROW<Status INT64, Interval INT64>, options={{}}}
Field{name=Recipes, description=, type=ROW<key STRING, value ROW<Id STRING, RecipeId STRING, ExternalRecipeId STRING, Name STRING, Added DATETIME, Url STRING, ImageUrl STRING, Portions INT64, RecipeProducts ARRAY<ROW<ProductId STRING, Quantity DOUBLE, Unit STRING> NOT NULL>>> NOT NULL, options={{}}}
Field{name=Discounts, description=, type=ROW<key STRING, value ROW<Id STRING, Code STRING, Text STRING, PercentageDeliveryFee DOUBLE, Percentage DOUBLE, Value DOUBLE, AmountLimit DOUBLE, ProductId STRING>> NOT NULL, options={{}}}
Field{name=Fees, description=, type=ROW<key STRING, value ROW<Id STRING, Amount DOUBLE, VatRate DOUBLE>> NOT NULL, options={{}}}
Field{name=Bonuses, description=, type=ROW<key STRING, value ROW<Id STRING, Code STRING, Amount DOUBLE>> NOT NULL, options={{}}}
Field{name=GiftVouchers, description=, type=ROW<key STRING, value ROW<Id STRING, Code STRING, Text STRING, Comments STRING, Value DOUBLE, ValidFrom DATETIME, ValidUntil DATETIME, AlreadyUsed BOOLEAN>> NOT NULL, options={{}}}
Field{name=Credit, description=, type=ARRAY<ROW<key STRING, value DOUBLE> NOT NULL>, options={{}}}
Field{name=OriginalProducts, description=, type=ROW<key STRING, value ROW<Id STRING, Quantity DOUBLE, Name STRING, Price DOUBLE, IsWine BOOLEAN, ProductDiscountPrice DOUBLE>> NOT NULL, options={{}}}
Field{name=OriginalDeliveryDate, description=, type=DATETIME, options={{}}}
Field{name=LockPhoneNumber, description=, type=STRING, options={{}}}
Field{name=SubscriptionId, description=, type=STRING, options={{}}}
Field{name=UnavailableSubscriptionProducts, description=, type=ROW<key STRING, value ROW<ProductId STRING, Name STRING, Quantity INT64, ReasonCode STRING>> NOT NULL, options={{}}}
Field{name=MemberGroupFees, description=, type=ROW<PickingCost STRING, DeliveryFee ROW<UseDeliveryFee BOOLEAN, Under INT64, Between INT64, Over INT64, LimitUnder INT64, LimitOver INT64, DeliveryFeeLimits ARRAY<ROW<Cost DOUBLE, Limit DOUBLE> NOT NULL>>, InvoiceCost DOUBLE>, options={{}}}
Field{name=PartitionTimestamp, description=, type=DATETIME, options={{}}}
Field{name=NumberOfConfirmedOrderLines, description=, type=INT64, options={{}}}
Field{name=DeliveryTimeStatus, description=, type=ROW<Status STRING, Modified DATETIME, ExpiresAt DATETIME>, options={{}}}
Field{name=_ATTRIBUTES, description=, type=ARRAY<ROW<key STRING, value STRING> NOT NULL>, options={{}}}
Field{name=Benefits, description=, type=ARRAY<ROW<MemberId STRING, BenefitType STRING, Benefits ARRAY<ROW<FromOrderId STRING, NewOrderAmountRequired DOUBLE, OrderDeliveryDate STRING, Status ROW<Applicable BOOLEAN, Reason STRING>, ValidFrom STRING, ValidUntil STRING, Applied BOOLEAN, UsedOnOrder STRING> NOT NULL>> NOT NULL>, options={{}}}
Field{name=ProductRestrictions, description=, type=ARRAY<ROW<ProductId STRING, Description STRING, MaxQuantity INT64, Quantity INT64, Modified STRING, RestrictionId STRING, MaxTotalQuantity INT64, CurrentTotalQuantity INT64> NOT NULL>, options={{}}}
Field{name=_metadata, description=, type=ROW<uuid STRING, operation STRING, topic STRING, timestamp DATETIME, entity STRING, dynamodbPublished DATETIME, salesforcePublished DATETIME, dynamodbEventId STRING, event_id STRING, processing_timestamp DATETIME>, options={{}}}
Field{name=event_timestamp, description=, type=DATETIME, options={{}}}
Encoding positions:
{Products=8, Modified=6, _ATTRIBUTES=34, Address=17, OriginalDeliveryDate=26, Discounts=20, ProductRestrictions=36, LockPhoneNumber=27, Benefits=35, event_timestamp=38, Created=5, MemberId=3, SocialSecurityNo=12, NumberOfConfirmedOrderLines=32, Credit=24, SubscriptionId=28, DeliveryTimeStatus=33, StoreId=2, ChangingOrderId=10, TotalPaidAmount=13, UnavailableSubscriptionProducts=29, PartitionTimestamp=31, _metadata=37, CartStatus=14, Bonuses=22, OriginalCartId=9, RecurringOrder=18, Fees=21, GiftVouchers=23, DeliveryTime=16, Payment=15, MemberGroupFees=30, Revision=1, MemberType=4, OriginalProducts=25, Recipes=19, OrderMessage=11, Id=0, Expires=7}
Options:{{entity=Option{type=STRING NOT NULL, value=ecom_cart_service_carteventtopic}}}UUID: null
[direct-runner-worker] ERROR org.streamprocessor.core.transforms.SerializeMessageToRowFn - ecom_cart_service_carteventtopic: org.apache.beam.sdk.util.RowJson$UnsupportedRowJsonException: Expected JSON array for field 'Credit'. Instead got OBJECT
[direct-runner-worker] INFO org.streamprocessor.core.transforms.SerializeMessageToRowFn - [processElement] Before row dese
[direct-runner-worker] INFO org.streamprocessor.core.transforms.SerializeMessageToRowFn - [processElement] payload: {"Products":{"Init":{"Category":null,"Discount":null,"Attributes":null,"Url":null,"Name":null,"Department":null,"HasPharmacyDiff":false,"SoldBy":null,"Supplier":null,"StockInformation":null,"Availability":null,"ExternalSupplierCode":null,"Added":null,"Quantity":0,"ImageUrl":null,"ExternalUrl":null,"Disclaimer":null,"VatRate":0,"RecycleFee":0,"Brand":null,"Subtitle":null,"Price":0,"CategoryAncestry":null,"PharmacyInformation":null,"ExternalProductCode":null,"Id":"0","Delivery":null,"EanCode":null,"ShowSoldBy":false}},"Modified":"2023-02-15T12:46:14.5404523Z","Address":{"CreationDate":"2023-02-15T12:46:11.5763022+00:00","LastModifiedDate":null,"AlternativePhoneMobile":null,"LegacyAddressId":null,"FirstName":null,"PostalCode":"11459","Latitude":0,"City":null,"Longitude":0,"InHomeAvailable":false,"DoorCode":null,"AddressInfo":null,"PhoneMobile":"0701234567","MemberId":"1099901340","CompanyName":null,"TruckRouteId":0,"AlternativePhoneHome":null,"RemovedDate":null,"PhoneHome":null,"AddressRow1":null,"Id":"071f1d36-636d-4277-990f-8a6fa9d3f51c","LastName":null,"AddressType":null,"AddressRow2":null},"OriginalDeliveryDate":null,"Discounts":{"Init":{"Percentage":0,"PercentageDeliveryFee":0,"Value":0,"Text":null,"ProductId":null,"Id":"0","Code":null,"AmountLimit":0}},"ProductRestrictions":[],"Benefits":null,"event_timestamp":"2023-02-15T12:46:14.9107662Z","Created":"2023-02-15T12:46:13.3264442Z","MemberId":"1099901340","SocialSecurityNo":null,"NumberOfConfirmedOrderLines":0,"DeliveryTimeStatus":{"Status":"None","Modified":"2023-02-15T12:46:13.3264678Z","ExpiresAt":null},"Credit":{"CONFIRMED_ORDER_CREDIT":0,"USED_CREDIT":0,"AVAILABLE_CREDIT":0},"SubscriptionId":null,"StoreId":"23","ChangingOrderId":0,"TotalPaidAmount":0,"UnavailableSubscriptionProducts":{"Init":{"Quantity":0,"ProductId":null,"ReasonCode":null,"Name":null}},"_metadata":{"processing_timestamp":"2023-02-15T13:29:11.377Z","dynamodbEventId":"a0b3adc4-7872-4f3c-b1a6-a03852d4f714","topic":"ecom-cart-service-CartEventTopic","uuid":"3606c207-da01-5610-ad60-9e610c571e3f","operation":"MODIFY","entity":"ecom-cart-service-CartEventTopic","timestamp":"2023-02-15T12:46:14.918Z","dynamodbPublished":"2023-02-15T12:46:14.9107662Z"},"CartStatus":"OPEN","Bonuses":{"Init":{"Amount":0,"Id":"0","Code":null}},"OriginalCartId":null,"RecurringOrder":null,"Fees":{"Init":{"Amount":0,"Id":"0","VatRate":0}},"GiftVouchers":{"Init":{"Comments":null,"Value":0,"ValidFrom":"0001-01-01T00:00:00Z","Text":null,"AlreadyUsed":false,"Id":"0","Code":null,"ValidUntil":"0001-01-01T00:00:00Z"}},"LeaveOutsideDoor":null,"DeliveryTime":null,"Payment":null,"MemberGroupFees":null,"Revision":5,"MemberType":"P","OriginalProducts":{"Init":{"Price":0,"ProductDiscountPrice":null,"Quantity":0,"Id":"0","IsWine":false,"Name":null}},"Recipes":{"Init":{"RecipeProducts":[],"Added":null,"Portions":0,"ExternalRecipeId":null,"RecipeId":null,"ImageUrl":null,"Id":"0","Url":null,"Name":null}},"OrderMessage":null,"Id":"18f59e3e-b5c0-407a-91af-f13cb19c8bff","Expires":"2023-02-22T12:46:15Z"}
[direct-runner-worker] INFO org.streamprocessor.core.transforms.SerializeMessageToRowFn - [processElement] schema: Fields:
Field{name=Id, description=, type=STRING, options={{}}}
Field{name=Revision, description=, type=INT64, options={{}}}
Field{name=StoreId, description=, type=STRING, options={{}}}
Field{name=MemberId, description=, type=STRING, options={{}}}
Field{name=MemberType, description=, type=STRING, options={{}}}
Field{name=Created, description=, type=DATETIME, options={{}}}
Field{name=Modified, description=, type=DATETIME, options={{}}}
Field{name=Expires, description=, type=DATETIME, options={{}}}
Field{name=Products, description=, type=ROW<key STRING, value ROW<Id STRING, Quantity DOUBLE, Name STRING, Added DATETIME, Category ROW<Id STRING, Name STRING>, Price DOUBLE, VatRate DOUBLE, Url STRING, ImageUrl STRING, EanCode STRING, ExternalSupplierCode STRING, ExternalProductCode STRING, Department ROW<Id STRING, Name STRING>, Brand ROW<Id STRING, Name STRING>, RecycleFee DOUBLE, Attributes ARRAY<STRING NOT NULL>, Discount ROW<Id STRING, DiscountPrice ROW<Value DOUBLE, DiscountPriceType INT64>, Limits ARRAY<ROW<Group STRING, Property STRING, Operator STRING, Value STRING> NOT NULL>, Conditions ARRAY<ROW<Group STRING, Property STRING, Operator STRING, Value STRING> NOT NULL>, ValidFrom DATETIME, ValidUntil DATETIME, CanUseProductOfferDiscount BOOLEAN>, Delivery ROW<IsPickingCostIncluded BOOLEAN, IsDeliveryCostIncluded BOOLEAN, IsSubscriptionProduct BOOLEAN, CancelDaysBefore INT64, MinimumRequiredDeliveryDays INT64, AdvanceDeliveryMinimumOrder INT64, IsAdultProduct BOOLEAN, IsWine BOOLEAN, DeliverableWeekdays ARRAY<STRING NOT NULL>, DeliveryRestrictions ARRAY<STRING NOT NULL>>, Availability STRING, CategoryAncestry ARRAY<ROW<Id STRING, Name STRING> NOT NULL>, Subtitle STRING, ExternalUrl STRING, SoldBy STRING, ShowSoldBy BOOLEAN, PharmacyInformation ROW<ArticleNumber STRING, ActiveSubstance STRING, ItemType STRING, SalesLimit INT64, SalesRestrictionType STRING, VendingType STRING>, HasPharmacyDiff BOOLEAN, Disclaimer STRING, Supplier ROW<Id STRING, Name STRING>>> NOT NULL, options={{}}}
Field{name=OriginalCartId, description=, type=STRING, options={{}}}
Field{name=ChangingOrderId, description=, type=INT64, options={{}}}
Field{name=OrderMessage, description=, type=STRING, options={{}}}
Field{name=SocialSecurityNo, description=, type=STRING, options={{}}}
Field{name=TotalPaidAmount, description=, type=DOUBLE, options={{}}}
Field{name=CartStatus, description=, type=STRING, options={{}}}
Field{name=Payment, description=, type=ROW<PaymentType STRING, OrderReference STRING>, options={{}}}
Field{name=DeliveryTime, description=, type=ROW<Id STRING, TruckRouteId INT64, Added DATETIME, TimeId STRING, StartDate DATETIME, StopDate DATETIME, DeliveryCost DOUBLE, ExtraDeliveryCost DOUBLE, InHomeDelivery BOOLEAN, DeliveryTimeChangedByAdmin BOOLEAN, DeliveryRestrictions ARRAY<STRING NOT NULL>, ClosingDate DATETIME, ClosingTime LOGICAL_TYPE, StoreId STRING, DeliveryFeeLimits ARRAY<ROW<Cost DOUBLE, Limit DOUBLE> NOT NULL>>, options={{}}}
Field{name=Address, description=, type=ROW<Id STRING, LegacyAddressId STRING, AddressType STRING, MemberId STRING, CompanyName STRING, FirstName STRING, LastName STRING, PhoneMobile STRING, PhoneHome STRING, AlternativePhoneHome STRING, AlternativePhoneMobile STRING, AddressRow1 STRING, AddressRow2 STRING, DoorCode STRING, AddressInfo STRING, PostalCode STRING, City STRING, Latitude DOUBLE, Longitude DOUBLE, TruckRouteId INT64, InHomeAvailable BOOLEAN, CreationDate STRING, LastModifiedDate STRING, RemovedDate STRING>, options={{}}}
Field{name=RecurringOrder, description=, type=ROW<Status INT64, Interval INT64>, options={{}}}
Field{name=Recipes, description=, type=ROW<key STRING, value ROW<Id STRING, RecipeId STRING, ExternalRecipeId STRING, Name STRING, Added DATETIME, Url STRING, ImageUrl STRING, Portions INT64, RecipeProducts ARRAY<ROW<ProductId STRING, Quantity DOUBLE, Unit STRING> NOT NULL>>> NOT NULL, options={{}}}
Field{name=Discounts, description=, type=ROW<key STRING, value ROW<Id STRING, Code STRING, Text STRING, PercentageDeliveryFee DOUBLE, Percentage DOUBLE, Value DOUBLE, AmountLimit DOUBLE, ProductId STRING>> NOT NULL, options={{}}}
Field{name=Fees, description=, type=ROW<key STRING, value ROW<Id STRING, Amount DOUBLE, VatRate DOUBLE>> NOT NULL, options={{}}}
Field{name=Bonuses, description=, type=ROW<key STRING, value ROW<Id STRING, Code STRING, Amount DOUBLE>> NOT NULL, options={{}}}
Field{name=GiftVouchers, description=, type=ROW<key STRING, value ROW<Id STRING, Code STRING, Text STRING, Comments STRING, Value DOUBLE, ValidFrom DATETIME, ValidUntil DATETIME, AlreadyUsed BOOLEAN>> NOT NULL, options={{}}}
Field{name=Credit, description=, type=ARRAY<ROW<key STRING, value DOUBLE> NOT NULL>, options={{}}}
Field{name=OriginalProducts, description=, type=ROW<key STRING, value ROW<Id STRING, Quantity DOUBLE, Name STRING, Price DOUBLE, IsWine BOOLEAN, ProductDiscountPrice DOUBLE>> NOT NULL, options={{}}}
Field{name=OriginalDeliveryDate, description=, type=DATETIME, options={{}}}
Field{name=LockPhoneNumber, description=, type=STRING, options={{}}}
Field{name=SubscriptionId, description=, type=STRING, options={{}}}
Field{name=UnavailableSubscriptionProducts, description=, type=ROW<key STRING, value ROW<ProductId STRING, Name STRING, Quantity INT64, ReasonCode STRING>> NOT NULL, options={{}}}
Field{name=MemberGroupFees, description=, type=ROW<PickingCost STRING, DeliveryFee ROW<UseDeliveryFee BOOLEAN, Under INT64, Between INT64, Over INT64, LimitUnder INT64, LimitOver INT64, DeliveryFeeLimits ARRAY<ROW<Cost DOUBLE, Limit DOUBLE> NOT NULL>>, InvoiceCost DOUBLE>, options={{}}}
Field{name=PartitionTimestamp, description=, type=DATETIME, options={{}}}
Field{name=NumberOfConfirmedOrderLines, description=, type=INT64, options={{}}}
Field{name=DeliveryTimeStatus, description=, type=ROW<Status STRING, Modified DATETIME, ExpiresAt DATETIME>, options={{}}}
Field{name=_ATTRIBUTES, description=, type=ARRAY<ROW<key STRING, value STRING> NOT NULL>, options={{}}}
Field{name=Benefits, description=, type=ARRAY<ROW<MemberId STRING, BenefitType STRING, Benefits ARRAY<ROW<FromOrderId STRING, NewOrderAmountRequired DOUBLE, OrderDeliveryDate STRING, Status ROW<Applicable BOOLEAN, Reason STRING>, ValidFrom STRING, ValidUntil STRING, Applied BOOLEAN, UsedOnOrder STRING> NOT NULL>> NOT NULL>, options={{}}}
Field{name=ProductRestrictions, description=, type=ARRAY<ROW<ProductId STRING, Description STRING, MaxQuantity INT64, Quantity INT64, Modified STRING, RestrictionId STRING, MaxTotalQuantity INT64, CurrentTotalQuantity INT64> NOT NULL>, options={{}}}
Field{name=_metadata, description=, type=ROW<uuid STRING, operation STRING, topic STRING, timestamp DATETIME, entity STRING, dynamodbPublished DATETIME, salesforcePublished DATETIME, dynamodbEventId STRING, event_id STRING, processing_timestamp DATETIME>, options={{}}}
Field{name=event_timestamp, description=, type=DATETIME, options={{}}}
Encoding positions:
{Products=8, Modified=6, _ATTRIBUTES=34, Address=17, OriginalDeliveryDate=26, Discounts=20, ProductRestrictions=36, LockPhoneNumber=27, Benefits=35, event_timestamp=38, Created=5, MemberId=3, SocialSecurityNo=12, NumberOfConfirmedOrderLines=32, Credit=24, SubscriptionId=28, DeliveryTimeStatus=33, StoreId=2, ChangingOrderId=10, TotalPaidAmount=13, UnavailableSubscriptionProducts=29, PartitionTimestamp=31, _metadata=37, CartStatus=14, Bonuses=22, OriginalCartId=9, RecurringOrder=18, Fees=21, GiftVouchers=23, DeliveryTime=16, Payment=15, MemberGroupFees=30, Revision=1, MemberType=4, OriginalProducts=25, Recipes=19, OrderMessage=11, Id=0, Expires=7}
Options:{{entity=Option{type=STRING NOT NULL, value=ecom_cart_service_carteventtopic}}}UUID: null
[direct-runner-worker] ERROR org.streamprocessor.core.transforms.SerializeMessageToRowFn - ecom_cart_service_carteventtopic: org.apache.beam.sdk.util.RowJson$UnsupportedRowJsonException: Expected JSON array for field 'Credit'. Instead got OBJECT
[direct-runner-worker] INFO org.streamprocessor.core.transforms.SerializeMessageToRowFn - [processElement] Before row dese
[direct-runner-worker] INFO org.streamprocessor.core.transforms.SerializeMessageToRowFn - [processElement] payload: {"Products":{"Init":{"Category":null,"Discount":null,"Attributes":null,"Url":null,"Name":null,"Department":null,"HasPharmacyDiff":false,"SoldBy":null,"Supplier":null,"StockInformation":null,"Availability":null,"ExternalSupplierCode":null,"Added":null,"Quantity":0,"ImageUrl":null,"ExternalUrl":null,"Disclaimer":null,"VatRate":0,"RecycleFee":0,"Brand":null,"Subtitle":null,"Price":0,"CategoryAncestry":null,"PharmacyInformation":null,"ExternalProductCode":null,"Id":"0","Delivery":null,"EanCode":null,"ShowSoldBy":false}},"Modified":null,"Address":null,"OriginalDeliveryDate":null,"Discounts":{"Init":{"Percentage":0,"PercentageDeliveryFee":0,"Value":0,"Text":null,"ProductId":null,"Id":"0","Code":null,"AmountLimit":0}},"ProductRestrictions":[],"Benefits":null,"event_timestamp":"2023-02-15T12:46:16.1592003Z","Created":"2023-02-15T12:46:15.9495494Z","MemberId":null,"SocialSecurityNo":null,"NumberOfConfirmedOrderLines":0,"DeliveryTimeStatus":{"Status":"None","Modified":"2023-02-15T12:46:15.9495699Z","ExpiresAt":null},"Credit":{"CONFIRMED_ORDER_CREDIT":0,"USED_CREDIT":0,"AVAILABLE_CREDIT":0},"SubscriptionId":null,"StoreId":"23","ChangingOrderId":0,"TotalPaidAmount":0,"UnavailableSubscriptionProducts":{"Init":{"Quantity":0,"ProductId":null,"ReasonCode":null,"Name":null}},"_metadata":{"processing_timestamp":"2023-02-15T13:29:11.377Z","dynamodbEventId":"d47c2d41-3a6f-4f74-b6a0-13c5d1a9614f","topic":"ecom-cart-service-CartEventTopic","uuid":"a18e557e-4df2-540f-b4d1-09189baa5316","operation":"MODIFY","entity":"ecom-cart-service-CartEventTopic","timestamp":"2023-02-15T12:46:16.165Z","dynamodbPublished":"2023-02-15T12:46:16.1592003Z"},"CartStatus":"OPEN","Bonuses":{"Init":{"Amount":0,"Id":"0","Code":null}},"OriginalCartId":null,"RecurringOrder":null,"Fees":{"Init":{"Amount":0,"Id":"0","VatRate":0}},"GiftVouchers":{"Init":{"Comments":null,"Value":0,"ValidFrom":"0001-01-01T00:00:00","Text":null,"AlreadyUsed":false,"Id":"0","Code":null,"ValidUntil":"0001-01-01T00:00:00"}},"LeaveOutsideDoor":null,"DeliveryTime":null,"Payment":null,"MemberGroupFees":null,"Revision":1,"MemberType":null,"OriginalProducts":{"Init":{"Price":0,"ProductDiscountPrice":null,"Quantity":0,"Id":"0","IsWine":false,"Name":null}},"Recipes":{"Init":{"RecipeProducts":[],"Added":null,"Portions":0,"ExternalRecipeId":null,"RecipeId":null,"ImageUrl":null,"Id":"0","Url":null,"Name":null}},"OrderMessage":null,"Id":"13fcd8f3-cbd8-4160-beb9-40356e845e20","Expires":"2023-02-22T12:46:16Z"}
[direct-runner-worker] INFO org.streamprocessor.core.transforms.SerializeMessageToRowFn - [processElement] schema: Fields:
Field{name=Id, description=, type=STRING, options={{}}}
Field{name=Revision, description=, type=INT64, options={{}}}
Field{name=StoreId, description=, type=STRING, options={{}}}
Field{name=MemberId, description=, type=STRING, options={{}}}
Field{name=MemberType, description=, type=STRING, options={{}}}
Field{name=Created, description=, type=DATETIME, options={{}}}
Field{name=Modified, description=, type=DATETIME, options={{}}}
Field{name=Expires, description=, type=DATETIME, options={{}}}
Field{name=Products, description=, type=ROW<key STRING, value ROW<Id STRING, Quantity DOUBLE, Name STRING, Added DATETIME, Category ROW<Id STRING, Name STRING>, Price DOUBLE, VatRate DOUBLE, Url STRING, ImageUrl STRING, EanCode STRING, ExternalSupplierCode STRING, ExternalProductCode STRING, Department ROW<Id STRING, Name STRING>, Brand ROW<Id STRING, Name STRING>, RecycleFee DOUBLE, Attributes ARRAY<STRING NOT NULL>, Discount ROW<Id STRING, DiscountPrice ROW<Value DOUBLE, DiscountPriceType INT64>, Limits ARRAY<ROW<Group STRING, Property STRING, Operator STRING, Value STRING> NOT NULL>, Conditions ARRAY<ROW<Group STRING, Property STRING, Operator STRING, Value STRING> NOT NULL>, ValidFrom DATETIME, ValidUntil DATETIME, CanUseProductOfferDiscount BOOLEAN>, Delivery ROW<IsPickingCostIncluded BOOLEAN, IsDeliveryCostIncluded BOOLEAN, IsSubscriptionProduct BOOLEAN, CancelDaysBefore INT64, MinimumRequiredDeliveryDays INT64, AdvanceDeliveryMinimumOrder INT64, IsAdultProduct BOOLEAN, IsWine BOOLEAN, DeliverableWeekdays ARRAY<STRING NOT NULL>, DeliveryRestrictions ARRAY<STRING NOT NULL>>, Availability STRING, CategoryAncestry ARRAY<ROW<Id STRING, Name STRING> NOT NULL>, Subtitle STRING, ExternalUrl STRING, SoldBy STRING, ShowSoldBy BOOLEAN, PharmacyInformation ROW<ArticleNumber STRING, ActiveSubstance STRING, ItemType STRING, SalesLimit INT64, SalesRestrictionType STRING, VendingType STRING>, HasPharmacyDiff BOOLEAN, Disclaimer STRING, Supplier ROW<Id STRING, Name STRING>>> NOT NULL, options={{}}}
Field{name=OriginalCartId, description=, type=STRING, options={{}}}
Field{name=ChangingOrderId, description=, type=INT64, options={{}}}
Field{name=OrderMessage, description=, type=STRING, options={{}}}
Field{name=SocialSecurityNo, description=, type=STRING, options={{}}}
Field{name=TotalPaidAmount, description=, type=DOUBLE, options={{}}}
Field{name=CartStatus, description=, type=STRING, options={{}}}
Field{name=Payment, description=, type=ROW<PaymentType STRING, OrderReference STRING>, options={{}}}
Field{name=DeliveryTime, description=, type=ROW<Id STRING, TruckRouteId INT64, Added DATETIME, TimeId STRING, StartDate DATETIME, StopDate DATETIME, DeliveryCost DOUBLE, ExtraDeliveryCost DOUBLE, InHomeDelivery BOOLEAN, DeliveryTimeChangedByAdmin BOOLEAN, DeliveryRestrictions ARRAY<STRING NOT NULL>, ClosingDate DATETIME, ClosingTime LOGICAL_TYPE, StoreId STRING, DeliveryFeeLimits ARRAY<ROW<Cost DOUBLE, Limit DOUBLE> NOT NULL>>, options={{}}}
Field{name=Address, description=, type=ROW<Id STRING, LegacyAddressId STRING, AddressType STRING, MemberId STRING, CompanyName STRING, FirstName STRING, LastName STRING, PhoneMobile STRING, PhoneHome STRING, AlternativePhoneHome STRING, AlternativePhoneMobile STRING, AddressRow1 STRING, AddressRow2 STRING, DoorCode STRING, AddressInfo STRING, PostalCode STRING, City STRING, Latitude DOUBLE, Longitude DOUBLE, TruckRouteId INT64, InHomeAvailable BOOLEAN, CreationDate STRING, LastModifiedDate STRING, RemovedDate STRING>, options={{}}}
Field{name=RecurringOrder, description=, type=ROW<Status INT64, Interval INT64>, options={{}}}
Field{name=Recipes, description=, type=ROW<key STRING, value ROW<Id STRING, RecipeId STRING, ExternalRecipeId STRING, Name STRING, Added DATETIME, Url STRING, ImageUrl STRING, Portions INT64, RecipeProducts ARRAY<ROW<ProductId STRING, Quantity DOUBLE, Unit STRING> NOT NULL>>> NOT NULL, options={{}}}
Field{name=Discounts, description=, type=ROW<key STRING, value ROW<Id STRING, Code STRING, Text STRING, PercentageDeliveryFee DOUBLE, Percentage DOUBLE, Value DOUBLE, AmountLimit DOUBLE, ProductId STRING>> NOT NULL, options={{}}}
Field{name=Fees, description=, type=ROW<key STRING, value ROW<Id STRING, Amount DOUBLE, VatRate DOUBLE>> NOT NULL, options={{}}}
Field{name=Bonuses, description=, type=ROW<key STRING, value ROW<Id STRING, Code STRING, Amount DOUBLE>> NOT NULL, options={{}}}
Field{name=GiftVouchers, description=, type=ROW<key STRING, value ROW<Id STRING, Code STRING, Text STRING, Comments STRING, Value DOUBLE, ValidFrom DATETIME, ValidUntil DATETIME, AlreadyUsed BOOLEAN>> NOT NULL, options={{}}}
Field{name=Credit, description=, type=ARRAY<ROW<key STRING, value DOUBLE> NOT NULL>, options={{}}}
Field{name=OriginalProducts, description=, type=ROW<key STRING, value ROW<Id STRING, Quantity DOUBLE, Name STRING, Price DOUBLE, IsWine BOOLEAN, ProductDiscountPrice DOUBLE>> NOT NULL, options={{}}}
Field{name=OriginalDeliveryDate, description=, type=DATETIME, options={{}}}
Field{name=LockPhoneNumber, description=, type=STRING, options={{}}}
Field{name=SubscriptionId, description=, type=STRING, options={{}}}
Field{name=UnavailableSubscriptionProducts, description=, type=ROW<key STRING, value ROW<ProductId STRING, Name STRING, Quantity INT64, ReasonCode STRING>> NOT NULL, options={{}}}
Field{name=MemberGroupFees, description=, type=ROW<PickingCost STRING, DeliveryFee ROW<UseDeliveryFee BOOLEAN, Under INT64, Between INT64, Over INT64, LimitUnder INT64, LimitOver INT64, DeliveryFeeLimits ARRAY<ROW<Cost DOUBLE, Limit DOUBLE> NOT NULL>>, InvoiceCost DOUBLE>, options={{}}}
Field{name=PartitionTimestamp, description=, type=DATETIME, options={{}}}
Field{name=NumberOfConfirmedOrderLines, description=, type=INT64, options={{}}}
Field{name=DeliveryTimeStatus, description=, type=ROW<Status STRING, Modified DATETIME, ExpiresAt DATETIME>, options={{}}}
Field{name=_ATTRIBUTES, description=, type=ARRAY<ROW<key STRING, value STRING> NOT NULL>, options={{}}}
Field{name=Benefits, description=, type=ARRAY<ROW<MemberId STRING, BenefitType STRING, Benefits ARRAY<ROW<FromOrderId STRING, NewOrderAmountRequired DOUBLE, OrderDeliveryDate STRING, Status ROW<Applicable BOOLEAN, Reason STRING>, ValidFrom STRING, ValidUntil STRING, Applied BOOLEAN, UsedOnOrder STRING> NOT NULL>> NOT NULL>, options={{}}}
Field{name=ProductRestrictions, description=, type=ARRAY<ROW<ProductId STRING, Description STRING, MaxQuantity INT64, Quantity INT64, Modified STRING, RestrictionId STRING, MaxTotalQuantity INT64, CurrentTotalQuantity INT64> NOT NULL>, options={{}}}
Field{name=_metadata, description=, type=ROW<uuid STRING, operation STRING, topic STRING, timestamp DATETIME, entity STRING, dynamodbPublished DATETIME, salesforcePublished DATETIME, dynamodbEventId STRING, event_id STRING, processing_timestamp DATETIME>, options={{}}}
Field{name=event_timestamp, description=, type=DATETIME, options={{}}}
Encoding positions:
{Products=8, Modified=6, _ATTRIBUTES=34, Address=17, OriginalDeliveryDate=26, Discounts=20, ProductRestrictions=36, LockPhoneNumber=27, Benefits=35, event_timestamp=38, Created=5, MemberId=3, SocialSecurityNo=12, NumberOfConfirmedOrderLines=32, Credit=24, SubscriptionId=28, DeliveryTimeStatus=33, StoreId=2, ChangingOrderId=10, TotalPaidAmount=13, UnavailableSubscriptionProducts=29, PartitionTimestamp=31, _metadata=37, CartStatus=14, Bonuses=22, OriginalCartId=9, RecurringOrder=18, Fees=21, GiftVouchers=23, DeliveryTime=16, Payment=15, MemberGroupFees=30, Revision=1, MemberType=4, OriginalProducts=25, Recipes=19, OrderMessage=11, Id=0, Expires=7}
Options:{{entity=Option{type=STRING NOT NULL, value=ecom_cart_service_carteventtopic}}}UUID: null
[direct-runner-worker] ERROR org.streamprocessor.core.transforms.SerializeMessageToRowFn - ecom_cart_service_carteventtopic: org.apache.beam.sdk.util.RowJson$UnsupportedRowJsonException: Expected JSON array for field 'Credit'. Instead got OBJECT
[direct-runner-worker] INFO org.streamprocessor.core.transforms.SerializeMessageToRowFn - [processElement] Before row dese
[direct-runner-worker] INFO org.streamprocessor.core.transforms.SerializeMessageToRowFn - [processElement] payload: {"Products":{"Init":{"Category":null,"Discount":null,"Attributes":null,"Url":null,"Name":null,"Department":null,"HasPharmacyDiff":false,"SoldBy":null,"Supplier":null,"StockInformation":null,"Availability":null,"ExternalSupplierCode":null,"Added":null,"Quantity":0,"ImageUrl":null,"ExternalUrl":null,"Disclaimer":null,"VatRate":0,"RecycleFee":0,"Brand":null,"Subtitle":null,"Price":0,"CategoryAncestry":null,"PharmacyInformation":null,"ExternalProductCode":null,"Id":"0","Delivery":null,"EanCode":null,"ShowSoldBy":false},"127144":{"Category":{"Id":"kottfars---not","Name":"Köttfärs - Nöt"},"Discount":null,"Attributes":null,"Url":"/varor/kottfars---not/notfars-12--800g-scan","Name":"Nötfärs 12% 800g Scan","Department":{"Id":"kott-o-chark","Name":"Kött & Chark"},"HasPharmacyDiff":false,"SoldBy":"mathem","Supplier":{"Id":"10607","Name":"HK Scan Kött"},"StockInformation":{"Active":true,"OutOfStock":false,"AvailableQuantity":null},"Availability":"Available","ExternalSupplierCode":null,"Added":"2023-02-08T10:19:10.230154Z","Quantity":1,"ImageUrl":"notfars-12--800g-scan-4.jpg","ExternalUrl":null,"Disclaimer":null,"VatRate":12,"RecycleFee":0,"Brand":{"Id":"scan","Name":"Scan"},"Subtitle":null,"Price":97.95,"CategoryAncestry":[{"Id":"kottfars---not","Name":"Köttfärs - Nöt"},{"Id":"kottfars","Name":"Köttfärs"},{"Id":"kott","Name":"Kött"},{"Id":"kott-o-chark","Name":"Kött & Chark"}],"PharmacyInformation":null,"ExternalProductCode":"207692002","Id":"127144","Delivery":{"AdvanceDeliveryMinimumOrder":0,"DeliverableWeekdays":[],"IsPickingCostIncluded":false,"CancelDaysBefore":0,"IsAdultProduct":false,"MinimumRequiredDeliveryDays":0,"IsSubscriptionProduct":false,"IsWine":false,"DeliveryRestrictions":[],"IsDeliveryCostIncluded":false},"EanCode":"7300207692002","ShowSoldBy":false}},"Modified":"2023-02-15T13:24:52.2618353Z","Address":{"CreationDate":"2022-02-03T14:19:03","LastModifiedDate":"2022-12-20T14:00:18.290004+00:00","AlternativePhoneMobile":null,"LegacyAddressId":"9725338","FirstName":"Andreas","PostalCode":"11734","Latitude":0,"City":"Stockholm","Longitude":0,"InHomeAvailable":false,"DoorCode":null,"AddressInfo":null,"PhoneMobile":"+46 73 912 16 32","MemberId":"2392590","CompanyName":null,"TruckRouteId":0,"AlternativePhoneHome":null,"RemovedDate":null,"PhoneHome":null,"AddressRow1":"Hornsbruksgatan 12","Id":"d4e60122-4002-435b-b592-c15354473774","LastName":"Fagerberg","AddressType":"M","AddressRow2":null},"OriginalDeliveryDate":null,"Discounts":{"Init":{"Percentage":0,"PercentageDeliveryFee":0,"Value":0,"Text":null,"ProductId":null,"Id":"0","Code":null,"AmountLimit":0}},"ProductRestrictions":[],"Benefits":null,"event_timestamp":"2023-02-15T13:24:52.4906944Z","Created":"2023-02-08T10:16:04.2961976Z","MemberId":"2392590","SocialSecurityNo":null,"NumberOfConfirmedOrderLines":0,"DeliveryTimeStatus":{"Status":"Pending","Modified":"2023-02-15T13:24:52.1349809Z","ExpiresAt":null},"Credit":{"CONFIRMED_ORDER_CREDIT":0,"USED_CREDIT":0,"AVAILABLE_CREDIT":0},"SubscriptionId":null,"StoreId":"20","ChangingOrderId":0,"TotalPaidAmount":0,"UnavailableSubscriptionProducts":{"Init":{"Quantity":0,"ProductId":null,"ReasonCode":null,"Name":null}},"_metadata":{"processing_timestamp":"2023-02-15T13:29:11.391Z","dynamodbEventId":"dc559b87-1433-40eb-8a26-439ceb5519cd","topic":"ecom-cart-service-CartEventTopic","uuid":"8363d325-bd76-56e5-a272-8f4362129dd0","operation":"MODIFY","entity":"ecom-cart-service-CartEventTopic","timestamp":"2023-02-15T13:24:52.499Z","dynamodbPublished":"2023-02-15T13:24:52.4906944Z"},"CartStatus":"OPEN","Bonuses":{"Init":{"Amount":0,"Id":"0","Code":null}},"OriginalCartId":null,"RecurringOrder":null,"Fees":{"Init":{"Amount":0,"Id":"0","VatRate":0}},"GiftVouchers":{"Init":{"Comments":null,"Value":0,"ValidFrom":"0001-01-01T00:00:00Z","Text":null,"AlreadyUsed":false,"Id":"0","Code":null,"ValidUntil":"0001-01-01T00:00:00Z"}},"LeaveOutsideDoor":"None","DeliveryTime":{"DeliveryFeeLimits":[],"Added":"2023-02-15T13:24:52.134968Z","ClosingTime":"15:15:00","DeliveryCost":19,"DeliveryTimeChangedByAdmin":false,"StartDate":"2023-02-15T16:00:00+01:00","TruckRouteId":4730,"Type":"ExpressPlanned","StoreId":null,"StoreRegion":"26","ExtraDeliveryCost":0,"StopDate":"2023-02-15T17:00:00+01:00","TimeId":"61869","ClosingDate":"2023-02-15T00:00:00+01:00","Id":"61869","DeliveryRestrictions":[]},"Payment":null,"MemberGroupFees":null,"Revision":225,"MemberType":"P","OriginalProducts":{"Init":{"Price":0,"ProductDiscountPrice":null,"Quantity":0,"Id":"0","IsWine":false,"Name":null}},"Recipes":{"Init":{"RecipeProducts":[],"Added":null,"Portions":0,"ExternalRecipeId":null,"RecipeId":null,"ImageUrl":null,"Id":"0","Url":null,"Name":null}},"OrderMessage":null,"Id":"1ec9a807-93cb-4c80-a691-996081c33df9","Expires":"2023-02-22T13:24:52Z"}
[direct-runner-worker] INFO org.streamprocessor.core.transforms.SerializeMessageToRowFn - [processElement] schema: Fields:
Field{name=Id, description=, type=STRING, options={{}}}
Field{name=Revision, description=, type=INT64, options={{}}}
Field{name=StoreId, description=, type=STRING, options={{}}}
Field{name=MemberId, description=, type=STRING, options={{}}}
Field{name=MemberType, description=, type=STRING, options={{}}}
Field{name=Created, description=, type=DATETIME, options={{}}}
Field{name=Modified, description=, type=DATETIME, options={{}}}
Field{name=Expires, description=, type=DATETIME, options={{}}}
Field{name=Products, description=, type=ROW<key STRING, value ROW<Id STRING, Quantity DOUBLE, Name STRING, Added DATETIME, Category ROW<Id STRING, Name STRING>, Price DOUBLE, VatRate DOUBLE, Url STRING, ImageUrl STRING, EanCode STRING, ExternalSupplierCode STRING, ExternalProductCode STRING, Department ROW<Id STRING, Name STRING>, Brand ROW<Id STRING, Name STRING>, RecycleFee DOUBLE, Attributes ARRAY<STRING NOT NULL>, Discount ROW<Id STRING, DiscountPrice ROW<Value DOUBLE, DiscountPriceType INT64>, Limits ARRAY<ROW<Group STRING, Property STRING, Operator STRING, Value STRING> NOT NULL>, Conditions ARRAY<ROW<Group STRING, Property STRING, Operator STRING, Value STRING> NOT NULL>, ValidFrom DATETIME, ValidUntil DATETIME, CanUseProductOfferDiscount BOOLEAN>, Delivery ROW<IsPickingCostIncluded BOOLEAN, IsDeliveryCostIncluded BOOLEAN, IsSubscriptionProduct BOOLEAN, CancelDaysBefore INT64, MinimumRequiredDeliveryDays INT64, AdvanceDeliveryMinimumOrder INT64, IsAdultProduct BOOLEAN, IsWine BOOLEAN, DeliverableWeekdays ARRAY<STRING NOT NULL>, DeliveryRestrictions ARRAY<STRING NOT NULL>>, Availability STRING, CategoryAncestry ARRAY<ROW<Id STRING, Name STRING> NOT NULL>, Subtitle STRING, ExternalUrl STRING, SoldBy STRING, ShowSoldBy BOOLEAN, PharmacyInformation ROW<ArticleNumber STRING, ActiveSubstance STRING, ItemType STRING, SalesLimit INT64, SalesRestrictionType STRING, VendingType STRING>, HasPharmacyDiff BOOLEAN, Disclaimer STRING, Supplier ROW<Id STRING, Name STRING>>> NOT NULL, options={{}}}
Field{name=OriginalCartId, description=, type=STRING, options={{}}}
Field{name=ChangingOrderId, description=, type=INT64, options={{}}}
Field{name=OrderMessage, description=, type=STRING, options={{}}}
Field{name=SocialSecurityNo, description=, type=STRING, options={{}}}
Field{name=TotalPaidAmount, description=, type=DOUBLE, options={{}}}
Field{name=CartStatus, description=, type=STRING, options={{}}}
Field{name=Payment, description=, type=ROW<PaymentType STRING, OrderReference STRING>, options={{}}}
Field{name=DeliveryTime, description=, type=ROW<Id STRING, TruckRouteId INT64, Added DATETIME, TimeId STRING, StartDate DATETIME, StopDate DATETIME, DeliveryCost DOUBLE, ExtraDeliveryCost DOUBLE, InHomeDelivery BOOLEAN, DeliveryTimeChangedByAdmin BOOLEAN, DeliveryRestrictions ARRAY<STRING NOT NULL>, ClosingDate DATETIME, ClosingTime LOGICAL_TYPE, StoreId STRING, DeliveryFeeLimits ARRAY<ROW<Cost DOUBLE, Limit DOUBLE> NOT NULL>>, options={{}}}
Field{name=Address, description=, type=ROW<Id STRING, LegacyAddressId STRING, AddressType STRING, MemberId STRING, CompanyName STRING, FirstName STRING, LastName STRING, PhoneMobile STRING, PhoneHome STRING, AlternativePhoneHome STRING, AlternativePhoneMobile STRING, AddressRow1 STRING, AddressRow2 STRING, DoorCode STRING, AddressInfo STRING, PostalCode STRING, City STRING, Latitude DOUBLE, Longitude DOUBLE, TruckRouteId INT64, InHomeAvailable BOOLEAN, CreationDate STRING, LastModifiedDate STRING, RemovedDate STRING>, options={{}}}
Field{name=RecurringOrder, description=, type=ROW<Status INT64, Interval INT64>, options={{}}}
Field{name=Recipes, description=, type=ROW<key STRING, value ROW<Id STRING, RecipeId STRING, ExternalRecipeId STRING, Name STRING, Added DATETIME, Url STRING, ImageUrl STRING, Portions INT64, RecipeProducts ARRAY<ROW<ProductId STRING, Quantity DOUBLE, Unit STRING> NOT NULL>>> NOT NULL, options={{}}}
Field{name=Discounts, description=, type=ROW<key STRING, value ROW<Id STRING, Code STRING, Text STRING, PercentageDeliveryFee DOUBLE, Percentage DOUBLE, Value DOUBLE, AmountLimit DOUBLE, ProductId STRING>> NOT NULL, options={{}}}
Field{name=Fees, description=, type=ROW<key STRING, value ROW<Id STRING, Amount DOUBLE, VatRate DOUBLE>> NOT NULL, options={{}}}
Field{name=Bonuses, description=, type=ROW<key STRING, value ROW<Id STRING, Code STRING, Amount DOUBLE>> NOT NULL, options={{}}}
Field{name=GiftVouchers, description=, type=ROW<key STRING, value ROW<Id STRING, Code STRING, Text STRING, Comments STRING, Value DOUBLE, ValidFrom DATETIME, ValidUntil DATETIME, AlreadyUsed BOOLEAN>> NOT NULL, options={{}}}
Field{name=Credit, description=, type=ARRAY<ROW<key STRING, value DOUBLE> NOT NULL>, options={{}}}
Field{name=OriginalProducts, description=, type=ROW<key STRING, value ROW<Id STRING, Quantity DOUBLE, Name STRING, Price DOUBLE, IsWine BOOLEAN, ProductDiscountPrice DOUBLE>> NOT NULL, options={{}}}
Field{name=OriginalDeliveryDate, description=, type=DATETIME, options={{}}}
Field{name=LockPhoneNumber, description=, type=STRING, options={{}}}
Field{name=SubscriptionId, description=, type=STRING, options={{}}}
Field{name=UnavailableSubscriptionProducts, description=, type=ROW<key STRING, value ROW<ProductId STRING, Name STRING, Quantity INT64, ReasonCode STRING>> NOT NULL, options={{}}}
Field{name=MemberGroupFees, description=, type=ROW<PickingCost STRING, DeliveryFee ROW<UseDeliveryFee BOOLEAN, Under INT64, Between INT64, Over INT64, LimitUnder INT64, LimitOver INT64, DeliveryFeeLimits ARRAY<ROW<Cost DOUBLE, Limit DOUBLE> NOT NULL>>, InvoiceCost DOUBLE>, options={{}}}
Field{name=PartitionTimestamp, description=, type=DATETIME, options={{}}}
Field{name=NumberOfConfirmedOrderLines, description=, type=INT64, options={{}}}
Field{name=DeliveryTimeStatus, description=, type=ROW<Status STRING, Modified DATETIME, ExpiresAt DATETIME>, options={{}}}
Field{name=_ATTRIBUTES, description=, type=ARRAY<ROW<key STRING, value STRING> NOT NULL>, options={{}}}
Field{name=Benefits, description=, type=ARRAY<ROW<MemberId STRING, BenefitType STRING, Benefits ARRAY<ROW<FromOrderId STRING, NewOrderAmountRequired DOUBLE, OrderDeliveryDate STRING, Status ROW<Applicable BOOLEAN, Reason STRING>, ValidFrom STRING, ValidUntil STRING, Applied BOOLEAN, UsedOnOrder STRING> NOT NULL>> NOT NULL>, options={{}}}
Field{name=ProductRestrictions, description=, type=ARRAY<ROW<ProductId STRING, Description STRING, MaxQuantity INT64, Quantity INT64, Modified STRING, RestrictionId STRING, MaxTotalQuantity INT64, CurrentTotalQuantity INT64> NOT NULL>, options={{}}}
Field{name=_metadata, description=, type=ROW<uuid STRING, operation STRING, topic STRING, timestamp DATETIME, entity STRING, dynamodbPublished DATETIME, salesforcePublished DATETIME, dynamodbEventId STRING, event_id STRING, processing_timestamp DATETIME>, options={{}}}
Field{name=event_timestamp, description=, type=DATETIME, options={{}}}
Encoding positions:
{Products=8, Modified=6, _ATTRIBUTES=34, Address=17, OriginalDeliveryDate=26, Discounts=20, ProductRestrictions=36, LockPhoneNumber=27, Benefits=35, event_timestamp=38, Created=5, MemberId=3, SocialSecurityNo=12, NumberOfConfirmedOrderLines=32, Credit=24, SubscriptionId=28, DeliveryTimeStatus=33, StoreId=2, ChangingOrderId=10, TotalPaidAmount=13, UnavailableSubscriptionProducts=29, PartitionTimestamp=31, _metadata=37, CartStatus=14, Bonuses=22, OriginalCartId=9, RecurringOrder=18, Fees=21, GiftVouchers=23, DeliveryTime=16, Payment=15, MemberGroupFees=30, Revision=1, MemberType=4, OriginalProducts=25, Recipes=19, OrderMessage=11, Id=0, Expires=7}
Options:{{entity=Option{type=STRING NOT NULL, value=ecom_cart_service_carteventtopic}}}UUID: null
[direct-runner-worker] ERROR org.streamprocessor.core.transforms.SerializeMessageToRowFn - ecom_cart_service_carteventtopic: org.apache.beam.sdk.util.RowJson$UnsupportedRowJsonException: Expected JSON array for field 'Credit'. Instead got OBJECT
[direct-runner-worker] INFO org.streamprocessor.core.transforms.SerializeMessageToRowFn - [processElement] Before row dese
[direct-runner-worker] INFO org.streamprocessor.core.transforms.SerializeMessageToRowFn - [processElement] payload: {"Products":{"Init":{"Category":null,"Discount":null,"Attributes":null,"Url":null,"Name":null,"Department":null,"HasPharmacyDiff":false,"SoldBy":null,"Supplier":null,"StockInformation":null,"Availability":null,"ExternalSupplierCode":null,"Added":null,"Quantity":0,"ImageUrl":null,"ExternalUrl":null,"Disclaimer":null,"VatRate":0,"RecycleFee":0,"Brand":null,"Subtitle":null,"Price":0,"CategoryAncestry":null,"PharmacyInformation":null,"ExternalProductCode":null,"Id":"0","Delivery":null,"EanCode":null,"ShowSoldBy":false},"159640":{"Category":{"Id":"bryggkaffe","Name":"Brygg- och kokkaffe"},"Discount":{"MinComparisonPrice":null,"Limits":[{"Operator":"=","Group":"Product","Value":"2","Property":"Quantity"}],"DiscountPrice":{"DiscountPriceType":0,"Value":44.5},"ValidFrom":"2023-02-12T00:00:00+00:00","Id":"2133641","MinPrice":null,"Conditions":[{"Operator":"=","Group":"Order","Value":"10","Property":"StoreId"},{"Operator":"=","Group":"Product","Value":"2","Property":"ProductCount"}],"CanUseProductOfferDiscount":true,"ValidUntil":"2023-02-18T00:00:00+00:00"},"Attributes":null,"Url":"/varor/bryggkaffe/kaffe-mellanrost-450g-lofbergs","Name":"Kaffe Mellanrost 450g Löfbergs","Department":{"Id":"dryck","Name":"Dryck"},"HasPharmacyDiff":false,"SoldBy":"mathem","Supplier":{"Id":"7443","Name":"Löfbergs Lila AB"},"StockInformation":{"Active":true,"OutOfStock":false,"AvailableQuantity":null},"Availability":"Available","ExternalSupplierCode":null,"Added":"2023-02-15T10:47:25.2648749Z","Quantity":5,"ImageUrl":"07310050001142_c1l1.jpeg.jpg","ExternalUrl":null,"Disclaimer":null,"VatRate":12,"RecycleFee":0,"Brand":{"Id":"lofbergs","Name":"Löfbergs"},"Subtitle":null,"Price":51.95,"CategoryAncestry":[{"Id":"bryggkaffe","Name":"Brygg- och kokkaffe"},{"Id":"kaffe","Name":"Kaffe"},{"Id":"dryck","Name":"Dryck"}],"PharmacyInformation":null,"ExternalProductCode":"050001142","Id":"159640","Delivery":{"AdvanceDeliveryMinimumOrder":0,"DeliverableWeekdays":[],"IsPickingCostIncluded":false,"CancelDaysBefore":0,"IsAdultProduct":false,"MinimumRequiredDeliveryDays":0,"IsSubscriptionProduct":false,"IsWine":false,"DeliveryRestrictions":[],"IsDeliveryCostIncluded":false},"EanCode":"7310050001142","ShowSoldBy":false}},"Modified":"2023-02-15T13:26:43.4559844Z","Address":{"CreationDate":"2023-02-03T10:40:57","LastModifiedDate":"2023-02-14T10:14:53","AlternativePhoneMobile":null,"LegacyAddressId":"10911060","FirstName":"Marc","PostalCode":"11227","Latitude":59.3318,"City":"Stockholm","Longitude":18.0485,"InHomeAvailable":false,"DoorCode":"1235","AddressInfo":null,"PhoneMobile":"0701234567","MemberId":"2509983","CompanyName":null,"TruckRouteId":0,"AlternativePhoneHome":null,"RemovedDate":null,"PhoneHome":null,"AddressRow1":"Kungsgatan 80","Id":"27d863ee-22fa-42d0-abd3-0644c6807ad3","LastName":"Giron","AddressType":"M","AddressRow2":null},"OriginalDeliveryDate":null,"Discounts":{"Init":{"Percentage":0,"PercentageDeliveryFee":0,"Value":0,"Text":null,"ProductId":null,"Id":"0","Code":null,"AmountLimit":0}},"ProductRestrictions":[],"Benefits":[{"BenefitType":"AdminFee","MemberId":"2509983","Id":"60b766d2-0876-4a05-bdd5-a9871f990fdd","Benefits":[{"FromOrderId":"62017626","Status":{"Applicable":true,"Reason":null},"UsedOnOrder":null,"Amount":0,"OrderDeliveryDate":"2023-02-12T00:00:00+01:00","NewOrderAmountRequired":350,"ValidFrom":"2023-02-12T00:00:00+01:00","Id":"AdminFee-1","Applied":false,"UsedOnCart":null,"ValidUntil":"2023-02-17T23:59:59+01:00"}]}],"event_timestamp":"2023-02-15T13:26:43.6321854Z","Created":"2023-02-15T10:47:08.6675625Z","MemberId":"2509983","SocialSecurityNo":null,"NumberOfConfirmedOrderLines":0,"DeliveryTimeStatus":{"Status":"Expired","Modified":"2023-02-15T13:26:43.4560002Z","ExpiresAt":null},"Credit":{"CONFIRMED_ORDER_CREDIT":0,"USED_CREDIT":0,"AVAILABLE_CREDIT":0},"SubscriptionId":null,"StoreId":"10","ChangingOrderId":0,"TotalPaidAmount":0,"UnavailableSubscriptionProducts":{"Init":{"Quantity":0,"ProductId":null,"ReasonCode":null,"Name":null}},"_metadata":{"processing_timestamp":"2023-02-15T13:29:11.392Z","dynamodbEventId":"406d6aec-3dc4-40b4-a370-48afe37d7902","topic":"ecom-cart-service-CartEventTopic","uuid":"cbf8264c-68f6-5736-a392-7a2ab7252ccf","operation":"MODIFY","entity":"ecom-cart-service-CartEventTopic","timestamp":"2023-02-15T13:26:43.653Z","dynamodbPublished":"2023-02-15T13:26:43.6321854Z"},"CartStatus":"OPEN","Bonuses":{"Init":{"Amount":0,"Id":"0","Code":null}},"OriginalCartId":null,"RecurringOrder":null,"Fees":{"Init":{"Amount":0,"Id":"0","VatRate":0}},"GiftVouchers":{"Init":{"Comments":null,"Value":0,"ValidFrom":"0001-01-01T00:00:00Z","Text":null,"AlreadyUsed":false,"Id":"0","Code":null,"ValidUntil":"0001-01-01T00:00:00Z"}},"LeaveOutsideDoor":null,"DeliveryTime":null,"Payment":{"OrderReference":"df3e0605-da18-4460-a0aa-49bfd7528f33","PaymentType":"KlarnaCheckout"},"MemberGroupFees":null,"Revision":191,"MemberType":"P","OriginalProducts":{"Init":{"Price":0,"ProductDiscountPrice":null,"Quantity":0,"Id":"0","IsWine":false,"Name":null}},"Recipes":{"Init":{"RecipeProducts":[],"Added":null,"Portions":0,"ExternalRecipeId":null,"RecipeId":null,"ImageUrl":null,"Id":"0","Url":null,"Name":null}},"OrderMessage":null,"Id":"4c949d86-3907-4d29-a07c-c01c16325ce1","Expires":"2023-03-17T13:26:43Z"}
[direct-runner-worker] INFO org.streamprocessor.core.transforms.SerializeMessageToRowFn - [processElement] schema: Fields:
Field{name=Id, description=, type=STRING, options={{}}}
Field{name=Revision, description=, type=INT64, options={{}}}
Field{name=StoreId, description=, type=STRING, options={{}}}
Field{name=MemberId, description=, type=STRING, options={{}}}
Field{name=MemberType, description=, type=STRING, options={{}}}
Field{name=Created, description=, type=DATETIME, options={{}}}
Field{name=Modified, description=, type=DATETIME, options={{}}}
Field{name=Expires, description=, type=DATETIME, options={{}}}
Field{name=Products, description=, type=ROW<key STRING, value ROW<Id STRING, Quantity DOUBLE, Name STRING, Added DATETIME, Category ROW<Id STRING, Name STRING>, Price DOUBLE, VatRate DOUBLE, Url STRING, ImageUrl STRING, EanCode STRING, ExternalSupplierCode STRING, ExternalProductCode STRING, Department ROW<Id STRING, Name STRING>, Brand ROW<Id STRING, Name STRING>, RecycleFee DOUBLE, Attributes ARRAY<STRING NOT NULL>, Discount ROW<Id STRING, DiscountPrice ROW<Value DOUBLE, DiscountPriceType INT64>, Limits ARRAY<ROW<Group STRING, Property STRING, Operator STRING, Value STRING> NOT NULL>, Conditions ARRAY<ROW<Group STRING, Property STRING, Operator STRING, Value STRING> NOT NULL>, ValidFrom DATETIME, ValidUntil DATETIME, CanUseProductOfferDiscount BOOLEAN>, Delivery ROW<IsPickingCostIncluded BOOLEAN, IsDeliveryCostIncluded BOOLEAN, IsSubscriptionProduct BOOLEAN, CancelDaysBefore INT64, MinimumRequiredDeliveryDays INT64, AdvanceDeliveryMinimumOrder INT64, IsAdultProduct BOOLEAN, IsWine BOOLEAN, DeliverableWeekdays ARRAY<STRING NOT NULL>, DeliveryRestrictions ARRAY<STRING NOT NULL>>, Availability STRING, CategoryAncestry ARRAY<ROW<Id STRING, Name STRING> NOT NULL>, Subtitle STRING, ExternalUrl STRING, SoldBy STRING, ShowSoldBy BOOLEAN, PharmacyInformation ROW<ArticleNumber STRING, ActiveSubstance STRING, ItemType STRING, SalesLimit INT64, SalesRestrictionType STRING, VendingType STRING>, HasPharmacyDiff BOOLEAN, Disclaimer STRING, Supplier ROW<Id STRING, Name STRING>>> NOT NULL, options={{}}}
Field{name=OriginalCartId, description=, type=STRING, options={{}}}
Field{name=ChangingOrderId, description=, type=INT64, options={{}}}
Field{name=OrderMessage, description=, type=STRING, options={{}}}
Field{name=SocialSecurityNo, description=, type=STRING, options={{}}}
Field{name=TotalPaidAmount, description=, type=DOUBLE, options={{}}}
Field{name=CartStatus, description=, type=STRING, options={{}}}
Field{name=Payment, description=, type=ROW<PaymentType STRING, OrderReference STRING>, options={{}}}
Field{name=DeliveryTime, description=, type=ROW<Id STRING, TruckRouteId INT64, Added DATETIME, TimeId STRING, StartDate DATETIME, StopDate DATETIME, DeliveryCost DOUBLE, ExtraDeliveryCost DOUBLE, InHomeDelivery BOOLEAN, DeliveryTimeChangedByAdmin BOOLEAN, DeliveryRestrictions ARRAY<STRING NOT NULL>, ClosingDate DATETIME, ClosingTime LOGICAL_TYPE, StoreId STRING, DeliveryFeeLimits ARRAY<ROW<Cost DOUBLE, Limit DOUBLE> NOT NULL>>, options={{}}}
Field{name=Address, description=, type=ROW<Id STRING, LegacyAddressId STRING, AddressType STRING, MemberId STRING, CompanyName STRING, FirstName STRING, LastName STRING, PhoneMobile STRING, PhoneHome STRING, AlternativePhoneHome STRING, AlternativePhoneMobile STRING, AddressRow1 STRING, AddressRow2 STRING, DoorCode STRING, AddressInfo STRING, PostalCode STRING, City STRING, Latitude DOUBLE, Longitude DOUBLE, TruckRouteId INT64, InHomeAvailable BOOLEAN, CreationDate STRING, LastModifiedDate STRING, RemovedDate STRING>, options={{}}}
Field{name=RecurringOrder, description=, type=ROW<Status INT64, Interval INT64>, options={{}}}
Field{name=Recipes, description=, type=ROW<key STRING, value ROW<Id STRING, RecipeId STRING, ExternalRecipeId STRING, Name STRING, Added DATETIME, Url STRING, ImageUrl STRING, Portions INT64, RecipeProducts ARRAY<ROW<ProductId STRING, Quantity DOUBLE, Unit STRING> NOT NULL>>> NOT NULL, options={{}}}
Field{name=Discounts, description=, type=ROW<key STRING, value ROW<Id STRING, Code STRING, Text STRING, PercentageDeliveryFee DOUBLE, Percentage DOUBLE, Value DOUBLE, AmountLimit DOUBLE, ProductId STRING>> NOT NULL, options={{}}}
Field{name=Fees, description=, type=ROW<key STRING, value ROW<Id STRING, Amount DOUBLE, VatRate DOUBLE>> NOT NULL, options={{}}}
Field{name=Bonuses, description=, type=ROW<key STRING, value ROW<Id STRING, Code STRING, Amount DOUBLE>> NOT NULL, options={{}}}
Field{name=GiftVouchers, description=, type=ROW<key STRING, value ROW<Id STRING, Code STRING, Text STRING, Comments STRING, Value DOUBLE, ValidFrom DATETIME, ValidUntil DATETIME, AlreadyUsed BOOLEAN>> NOT NULL, options={{}}}
Field{name=Credit, description=, type=ARRAY<ROW<key STRING, value DOUBLE> NOT NULL>, options={{}}}
Field{name=OriginalProducts, description=, type=ROW<key STRING, value ROW<Id STRING, Quantity DOUBLE, Name STRING, Price DOUBLE, IsWine BOOLEAN, ProductDiscountPrice DOUBLE>> NOT NULL, options={{}}}
Field{name=OriginalDeliveryDate, description=, type=DATETIME, options={{}}}
Field{name=LockPhoneNumber, description=, type=STRING, options={{}}}
Field{name=SubscriptionId, description=, type=STRING, options={{}}}
Field{name=UnavailableSubscriptionProducts, description=, type=ROW<key STRING, value ROW<ProductId STRING, Name STRING, Quantity INT64, ReasonCode STRING>> NOT NULL, options={{}}}
Field{name=MemberGroupFees, description=, type=ROW<PickingCost STRING, DeliveryFee ROW<UseDeliveryFee BOOLEAN, Under INT64, Between INT64, Over INT64, LimitUnder INT64, LimitOver INT64, DeliveryFeeLimits ARRAY<ROW<Cost DOUBLE, Limit DOUBLE> NOT NULL>>, InvoiceCost DOUBLE>, options={{}}}
Field{name=PartitionTimestamp, description=, type=DATETIME, options={{}}}
Field{name=NumberOfConfirmedOrderLines, description=, type=INT64, options={{}}}
Field{name=DeliveryTimeStatus, description=, type=ROW<Status STRING, Modified DATETIME, ExpiresAt DATETIME>, options={{}}}
Field{name=_ATTRIBUTES, description=, type=ARRAY<ROW<key STRING, value STRING> NOT NULL>, options={{}}}
Field{name=Benefits, description=, type=ARRAY<ROW<MemberId STRING, BenefitType STRING, Benefits ARRAY<ROW<FromOrderId STRING, NewOrderAmountRequired DOUBLE, OrderDeliveryDate STRING, Status ROW<Applicable BOOLEAN, Reason STRING>, ValidFrom STRING, ValidUntil STRING, Applied BOOLEAN, UsedOnOrder STRING> NOT NULL>> NOT NULL>, options={{}}}
Field{name=ProductRestrictions, description=, type=ARRAY<ROW<ProductId STRING, Description STRING, MaxQuantity INT64, Quantity INT64, Modified STRING, RestrictionId STRING, MaxTotalQuantity INT64, CurrentTotalQuantity INT64> NOT NULL>, options={{}}}
Field{name=_metadata, description=, type=ROW<uuid STRING, operation STRING, topic STRING, timestamp DATETIME, entity STRING, dynamodbPublished DATETIME, salesforcePublished DATETIME, dynamodbEventId STRING, event_id STRING, processing_timestamp DATETIME>, options={{}}}
Field{name=event_timestamp, description=, type=DATETIME, options={{}}}
Encoding positions:
{Products=8, Modified=6, _ATTRIBUTES=34, Address=17, OriginalDeliveryDate=26, Discounts=20, ProductRestrictions=36, LockPhoneNumber=27, Benefits=35, event_timestamp=38, Created=5, MemberId=3, SocialSecurityNo=12, NumberOfConfirmedOrderLines=32, Credit=24, SubscriptionId=28, DeliveryTimeStatus=33, StoreId=2, ChangingOrderId=10, TotalPaidAmount=13, UnavailableSubscriptionProducts=29, PartitionTimestamp=31, _metadata=37, CartStatus=14, Bonuses=22, OriginalCartId=9, RecurringOrder=18, Fees=21, GiftVouchers=23, DeliveryTime=16, Payment=15, MemberGroupFees=30, Revision=1, MemberType=4, OriginalProducts=25, Recipes=19, OrderMessage=11, Id=0, Expires=7}
Options:{{entity=Option{type=STRING NOT NULL, value=ecom_cart_service_carteventtopic}}}UUID: null
[direct-runner-worker] ERROR org.streamprocessor.core.transforms.SerializeMessageToRowFn - ecom_cart_service_carteventtopic: org.apache.beam.sdk.util.RowJson$UnsupportedRowJsonException: Expected JSON array for field 'Credit'. Instead got OBJECT
[direct-runner-worker] INFO org.streamprocessor.core.transforms.SerializeMessageToRowFn - [processElement] Before row dese
[direct-runner-worker] INFO org.streamprocessor.core.transforms.SerializeMessageToRowFn - [processElement] payload: {"Products":{"Init":{"Category":null,"Discount":null,"Attributes":null,"Url":null,"Name":null,"Department":null,"HasPharmacyDiff":false,"SoldBy":null,"Supplier":null,"StockInformation":null,"Availability":null,"ExternalSupplierCode":null,"Added":null,"Quantity":0,"ImageUrl":null,"ExternalUrl":null,"Disclaimer":null,"VatRate":0,"RecycleFee":0,"Brand":null,"Subtitle":null,"Price":0,"CategoryAncestry":null,"PharmacyInformation":null,"ExternalProductCode":null,"Id":"0","Delivery":null,"EanCode":null,"ShowSoldBy":false},"159640":{"Category":{"Id":"bryggkaffe","Name":"Brygg- och kokkaffe"},"Discount":{"MinComparisonPrice":null,"Limits":[{"Operator":"=","Group":"Product","Value":"2","Property":"Quantity"}],"DiscountPrice":{"DiscountPriceType":0,"Value":44.5},"ValidFrom":"2023-02-12T00:00:00+00:00","Id":"2133641","MinPrice":null,"Conditions":[{"Operator":"=","Group":"Order","Value":"10","Property":"StoreId"},{"Operator":"=","Group":"Product","Value":"2","Property":"ProductCount"}],"CanUseProductOfferDiscount":true,"ValidUntil":"2023-02-18T00:00:00+00:00"},"Attributes":null,"Url":"/varor/bryggkaffe/kaffe-mellanrost-450g-lofbergs","Name":"Kaffe Mellanrost 450g Löfbergs","Department":{"Id":"dryck","Name":"Dryck"},"HasPharmacyDiff":false,"SoldBy":"mathem","Supplier":{"Id":"7443","Name":"Löfbergs Lila AB"},"StockInformation":{"Active":true,"OutOfStock":false,"AvailableQuantity":null},"Availability":"Available","ExternalSupplierCode":null,"Added":"2023-02-15T10:47:25.2648749Z","Quantity":5,"ImageUrl":"07310050001142_c1l1.jpeg.jpg","ExternalUrl":null,"Disclaimer":null,"VatRate":12,"RecycleFee":0,"Brand":{"Id":"lofbergs","Name":"Löfbergs"},"Subtitle":null,"Price":51.95,"CategoryAncestry":[{"Id":"bryggkaffe","Name":"Brygg- och kokkaffe"},{"Id":"kaffe","Name":"Kaffe"},{"Id":"dryck","Name":"Dryck"}],"PharmacyInformation":null,"ExternalProductCode":"050001142","Id":"159640","Delivery":{"AdvanceDeliveryMinimumOrder":0,"DeliverableWeekdays":[],"IsPickingCostIncluded":false,"CancelDaysBefore":0,"IsAdultProduct":false,"MinimumRequiredDeliveryDays":0,"IsSubscriptionProduct":false,"IsWine":false,"DeliveryRestrictions":[],"IsDeliveryCostIncluded":false},"EanCode":"7310050001142","ShowSoldBy":false}},"Modified":"2023-02-15T13:26:43.5929503Z","Address":{"CreationDate":"2023-02-03T10:40:57","LastModifiedDate":"2023-02-14T10:14:53","AlternativePhoneMobile":null,"LegacyAddressId":"10911060","FirstName":"Marc","PostalCode":"11227","Latitude":59.3318,"City":"Stockholm","Longitude":18.0485,"InHomeAvailable":false,"DoorCode":"1235","AddressInfo":null,"PhoneMobile":"0701234567","MemberId":"2509983","CompanyName":null,"TruckRouteId":0,"AlternativePhoneHome":null,"RemovedDate":null,"PhoneHome":null,"AddressRow1":"Kungsgatan 80","Id":"27d863ee-22fa-42d0-abd3-0644c6807ad3","LastName":"Giron","AddressType":"M","AddressRow2":null},"OriginalDeliveryDate":null,"Discounts":{"Init":{"Percentage":0,"PercentageDeliveryFee":0,"Value":0,"Text":null,"ProductId":null,"Id":"0","Code":null,"AmountLimit":0}},"ProductRestrictions":[],"Benefits":[{"BenefitType":"AdminFee","MemberId":"2509983","Id":"60b766d2-0876-4a05-bdd5-a9871f990fdd","Benefits":[{"FromOrderId":"62017626","Status":{"Applicable":true,"Reason":null},"UsedOnOrder":null,"Amount":0,"OrderDeliveryDate":"2023-02-12T00:00:00+01:00","NewOrderAmountRequired":350,"ValidFrom":"2023-02-12T00:00:00+01:00","Id":"AdminFee-1","Applied":false,"UsedOnCart":null,"ValidUntil":"2023-02-17T23:59:59+01:00"}]}],"event_timestamp":"2023-02-15T13:26:43.8950857Z","Created":"2023-02-15T10:47:08.6675625Z","MemberId":"2509983","SocialSecurityNo":null,"NumberOfConfirmedOrderLines":0,"DeliveryTimeStatus":{"Status":"Expired","Modified":"2023-02-15T13:26:43.5929598Z","ExpiresAt":"2023-02-15T13:26:42+00:00"},"Credit":{"CONFIRMED_ORDER_CREDIT":0,"USED_CREDIT":0,"AVAILABLE_CREDIT":0},"SubscriptionId":null,"StoreId":"10","ChangingOrderId":0,"TotalPaidAmount":0,"UnavailableSubscriptionProducts":{"Init":{"Quantity":0,"ProductId":null,"ReasonCode":null,"Name":null}},"_metadata":{"processing_timestamp":"2023-02-15T13:29:11.392Z","dynamodbEventId":"8acf75ca-fb34-48fb-b8f0-8118d11daa3e","topic":"ecom-cart-service-CartEventTopic","uuid":"9a2750f0-9504-514a-b6b1-0c964ad7b7d2","operation":"MODIFY","entity":"ecom-cart-service-CartEventTopic","timestamp":"2023-02-15T13:26:43.931Z","dynamodbPublished":"2023-02-15T13:26:43.8950857Z"},"CartStatus":"OPEN","Bonuses":{"Init":{"Amount":0,"Id":"0","Code":null}},"OriginalCartId":null,"RecurringOrder":null,"Fees":{"Init":{"Amount":0,"Id":"0","VatRate":0}},"GiftVouchers":{"Init":{"Comments":null,"Value":0,"ValidFrom":"0001-01-01T00:00:00Z","Text":null,"AlreadyUsed":false,"Id":"0","Code":null,"ValidUntil":"0001-01-01T00:00:00Z"}},"LeaveOutsideDoor":null,"DeliveryTime":null,"Payment":{"OrderReference":"df3e0605-da18-4460-a0aa-49bfd7528f33","PaymentType":"KlarnaCheckout"},"MemberGroupFees":null,"Revision":192,"MemberType":"P","OriginalProducts":{"Init":{"Price":0,"ProductDiscountPrice":null,"Quantity":0,"Id":"0","IsWine":false,"Name":null}},"Recipes":{"Init":{"RecipeProducts":[],"Added":null,"Portions":0,"ExternalRecipeId":null,"RecipeId":null,"ImageUrl":null,"Id":"0","Url":null,"Name":null}},"OrderMessage":null,"Id":"4c949d86-3907-4d29-a07c-c01c16325ce1","Expires":"2023-03-17T13:26:44Z"}
[direct-runner-worker] INFO org.streamprocessor.core.transforms.SerializeMessageToRowFn - [processElement] schema: Fields:
Field{name=Id, description=, type=STRING, options={{}}}
Field{name=Revision, description=, type=INT64, options={{}}}
Field{name=StoreId, description=, type=STRING, options={{}}}
Field{name=MemberId, description=, type=STRING, options={{}}}
Field{name=MemberType, description=, type=STRING, options={{}}}
Field{name=Created, description=, type=DATETIME, options={{}}}
Field{name=Modified, description=, type=DATETIME, options={{}}}
Field{name=Expires, description=, type=DATETIME, options={{}}}
Field{name=Products, description=, type=ROW<key STRING, value ROW<Id STRING, Quantity DOUBLE, Name STRING, Added DATETIME, Category ROW<Id STRING, Name STRING>, Price DOUBLE, VatRate DOUBLE, Url STRING, ImageUrl STRING, EanCode STRING, ExternalSupplierCode STRING, ExternalProductCode STRING, Department ROW<Id STRING, Name STRING>, Brand ROW<Id STRING, Name STRING>, RecycleFee DOUBLE, Attributes ARRAY<STRING NOT NULL>, Discount ROW<Id STRING, DiscountPrice ROW<Value DOUBLE, DiscountPriceType INT64>, Limits ARRAY<ROW<Group STRING, Property STRING, Operator STRING, Value STRING> NOT NULL>, Conditions ARRAY<ROW<Group STRING, Property STRING, Operator STRING, Value STRING> NOT NULL>, ValidFrom DATETIME, ValidUntil DATETIME, CanUseProductOfferDiscount BOOLEAN>, Delivery ROW<IsPickingCostIncluded BOOLEAN, IsDeliveryCostIncluded BOOLEAN, IsSubscriptionProduct BOOLEAN, CancelDaysBefore INT64, MinimumRequiredDeliveryDays INT64, AdvanceDeliveryMinimumOrder INT64, IsAdultProduct BOOLEAN, IsWine BOOLEAN, DeliverableWeekdays ARRAY<STRING NOT NULL>, DeliveryRestrictions ARRAY<STRING NOT NULL>>, Availability STRING, CategoryAncestry ARRAY<ROW<Id STRING, Name STRING> NOT NULL>, Subtitle STRING, ExternalUrl STRING, SoldBy STRING, ShowSoldBy BOOLEAN, PharmacyInformation ROW<ArticleNumber STRING, ActiveSubstance STRING, ItemType STRING, SalesLimit INT64, SalesRestrictionType STRING, VendingType STRING>, HasPharmacyDiff BOOLEAN, Disclaimer STRING, Supplier ROW<Id STRING, Name STRING>>> NOT NULL, options={{}}}
Field{name=OriginalCartId, description=, type=STRING, options={{}}}
Field{name=ChangingOrderId, description=, type=INT64, options={{}}}
Field{name=OrderMessage, description=, type=STRING, options={{}}}
Field{name=SocialSecurityNo, description=, type=STRING, options={{}}}
Field{name=TotalPaidAmount, description=, type=DOUBLE, options={{}}}
Field{name=CartStatus, description=, type=STRING, options={{}}}
Field{name=Payment, description=, type=ROW<PaymentType STRING, OrderReference STRING>, options={{}}}
Field{name=DeliveryTime, description=, type=ROW<Id STRING, TruckRouteId INT64, Added DATETIME, TimeId STRING, StartDate DATETIME, StopDate DATETIME, DeliveryCost DOUBLE, ExtraDeliveryCost DOUBLE, InHomeDelivery BOOLEAN, DeliveryTimeChangedByAdmin BOOLEAN, DeliveryRestrictions ARRAY<STRING NOT NULL>, ClosingDate DATETIME, ClosingTime LOGICAL_TYPE, StoreId STRING, DeliveryFeeLimits ARRAY<ROW<Cost DOUBLE, Limit DOUBLE> NOT NULL>>, options={{}}}
Field{name=Address, description=, type=ROW<Id STRING, LegacyAddressId STRING, AddressType STRING, MemberId STRING, CompanyName STRING, FirstName STRING, LastName STRING, PhoneMobile STRING, PhoneHome STRING, AlternativePhoneHome STRING, AlternativePhoneMobile STRING, AddressRow1 STRING, AddressRow2 STRING, DoorCode STRING, AddressInfo STRING, PostalCode STRING, City STRING, Latitude DOUBLE, Longitude DOUBLE, TruckRouteId INT64, InHomeAvailable BOOLEAN, CreationDate STRING, LastModifiedDate STRING, RemovedDate STRING>, options={{}}}
Field{name=RecurringOrder, description=, type=ROW<Status INT64, Interval INT64>, options={{}}}
Field{name=Recipes, description=, type=ROW<key STRING, value ROW<Id STRING, RecipeId STRING, ExternalRecipeId STRING, Name STRING, Added DATETIME, Url STRING, ImageUrl STRING, Portions INT64, RecipeProducts ARRAY<ROW<ProductId STRING, Quantity DOUBLE, Unit STRING> NOT NULL>>> NOT NULL, options={{}}}
Field{name=Discounts, description=, type=ROW<key STRING, value ROW<Id STRING, Code STRING, Text STRING, PercentageDeliveryFee DOUBLE, Percentage DOUBLE, Value DOUBLE, AmountLimit DOUBLE, ProductId STRING>> NOT NULL, options={{}}}
Field{name=Fees, description=, type=ROW<key STRING, value ROW<Id STRING, Amount DOUBLE, VatRate DOUBLE>> NOT NULL, options={{}}}
Field{name=Bonuses, description=, type=ROW<key STRING, value ROW<Id STRING, Code STRING, Amount DOUBLE>> NOT NULL, options={{}}}
Field{name=GiftVouchers, description=, type=ROW<key STRING, value ROW<Id STRING, Code STRING, Text STRING, Comments STRING, Value DOUBLE, ValidFrom DATETIME, ValidUntil DATETIME, AlreadyUsed BOOLEAN>> NOT NULL, options={{}}}
Field{name=Credit, description=, type=ARRAY<ROW<key STRING, value DOUBLE> NOT NULL>, options={{}}}
Field{name=OriginalProducts, description=, type=ROW<key STRING, value ROW<Id STRING, Quantity DOUBLE, Name STRING, Price DOUBLE, IsWine BOOLEAN, ProductDiscountPrice DOUBLE>> NOT NULL, options={{}}}
Field{name=OriginalDeliveryDate, description=, type=DATETIME, options={{}}}
Field{name=LockPhoneNumber, description=, type=STRING, options={{}}}
Field{name=SubscriptionId, description=, type=STRING, options={{}}}
Field{name=UnavailableSubscriptionProducts, description=, type=ROW<key STRING, value ROW<ProductId STRING, Name STRING, Quantity INT64, ReasonCode STRING>> NOT NULL, options={{}}}
Field{name=MemberGroupFees, description=, type=ROW<PickingCost STRING, DeliveryFee ROW<UseDeliveryFee BOOLEAN, Under INT64, Between INT64, Over INT64, LimitUnder INT64, LimitOver INT64, DeliveryFeeLimits ARRAY<ROW<Cost DOUBLE, Limit DOUBLE> NOT NULL>>, InvoiceCost DOUBLE>, options={{}}}
Field{name=PartitionTimestamp, description=, type=DATETIME, options={{}}}
Field{name=NumberOfConfirmedOrderLines, description=, type=INT64, options={{}}}
Field{name=DeliveryTimeStatus, description=, type=ROW<Status STRING, Modified DATETIME, ExpiresAt DATETIME>, options={{}}}
Field{name=_ATTRIBUTES, description=, type=ARRAY<ROW<key STRING, value STRING> NOT NULL>, options={{}}}
Field{name=Benefits, description=, type=ARRAY<ROW<MemberId STRING, BenefitType STRING, Benefits ARRAY<ROW<FromOrderId STRING, NewOrderAmountRequired DOUBLE, OrderDeliveryDate STRING, Status ROW<Applicable BOOLEAN, Reason STRING>, ValidFrom STRING, ValidUntil STRING, Applied BOOLEAN, UsedOnOrder STRING> NOT NULL>> NOT NULL>, options={{}}}
Field{name=ProductRestrictions, description=, type=ARRAY<ROW<ProductId STRING, Description STRING, MaxQuantity INT64, Quantity INT64, Modified STRING, RestrictionId STRING, MaxTotalQuantity INT64, CurrentTotalQuantity INT64> NOT NULL>, options={{}}}
Field{name=_metadata, description=, type=ROW<uuid STRING, operation STRING, topic STRING, timestamp DATETIME, entity STRING, dynamodbPublished DATETIME, salesforcePublished DATETIME, dynamodbEventId STRING, event_id STRING, processing_timestamp DATETIME>, options={{}}}
Field{name=event_timestamp, description=, type=DATETIME, options={{}}}
Encoding positions:
{Products=8, Modified=6, _ATTRIBUTES=34, Address=17, OriginalDeliveryDate=26, Discounts=20, ProductRestrictions=36, LockPhoneNumber=27, Benefits=35, event_timestamp=38, Created=5, MemberId=3, SocialSecurityNo=12, NumberOfConfirmedOrderLines=32, Credit=24, SubscriptionId=28, DeliveryTimeStatus=33, StoreId=2, ChangingOrderId=10, TotalPaidAmount=13, UnavailableSubscriptionProducts=29, PartitionTimestamp=31, _metadata=37, CartStatus=14, Bonuses=22, OriginalCartId=9, RecurringOrder=18, Fees=21, GiftVouchers=23, DeliveryTime=16, Payment=15, MemberGroupFees=30, Revision=1, MemberType=4, OriginalProducts=25, Recipes=19, OrderMessage=11, Id=0, Expires=7}
Options:{{entity=Option{type=STRING NOT NULL, value=ecom_cart_service_carteventtopic}}}UUID: null
[direct-runner-worker] ERROR org.streamprocessor.core.transforms.SerializeMessageToRowFn - ecom_cart_service_carteventtopic: org.apache.beam.sdk.util.RowJson$UnsupportedRowJsonException: Expected JSON array for field 'Credit'. Instead got OBJECT
^C%                                                                                                                                                                                                                                                                          
➜  dynamodb git:(DATA-2758-map-typed-repeatable-record) ✗ 